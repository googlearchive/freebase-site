
/*
 * Copyright 2010, Google Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above
 * copyright notice, this list of conditions and the following disclaimer
 * in the documentation and/or other materials provided with the
 * distribution.
 *     * Neither the name of Google Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Additional Licenses for Third Party components can be found here:
 * http://wiki.freebase.com/wiki/Freebase_Site_License
 *
 */
/*
 
 jQuery Tools @VERSION / Expose - Dim the lights

 NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.

 http://flowplayer.org/tools/toolbox/expose.html

 Since: Mar 2010
 Date: @DATE 
 
 jQuery Tools @VERSION Overlay - Overlay base. Extend it.

 NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.

 http://flowplayer.org/tools/overlay/

 Since: March 2008
 Date: @DATE 
*/
(function(a){function g(){if(a.browser.msie){var k=a(document).height(),m=a(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,k-m<20?m:k]}return[a(document).width(),a(document).height()]}function d(k){if(k)return k.call(a.mask)}a.tools=a.tools||{version:"@VERSION"};var c;c=a.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:true,closeOnEsc:true,zIndex:9998,opacity:0.8,startOpacity:0,color:"#fff",onLoad:null,
onClose:null}};var e,b,f,i,l;a.mask={load:function(k,m){if(f)return this;if(typeof k=="string")k={color:k};k=k||i;i=k=a.extend(a.extend({},c.conf),k);e=a("#"+k.maskId);if(!e.length){e=a("<div/>").attr("id",k.maskId);a("body").append(e)}var q=g();e.css({position:"absolute",top:0,left:0,width:q[0],height:q[1],display:"none",opacity:k.startOpacity,zIndex:k.zIndex});k.color&&e.css("backgroundColor",k.color);if(d(k.onBeforeLoad)===false)return this;k.closeOnEsc&&a(document).bind("keydown.mask",function(p){p.keyCode==
27&&a.mask.close(p)});k.closeOnClick&&e.bind("click.mask",function(p){a.mask.close(p)});a(window).bind("resize.mask",function(){a.mask.fit()});if(m&&m.length){l=m.eq(0).css("zIndex");a.each(m,function(){var p=a(this);/relative|absolute|fixed/i.test(p.css("position"))||p.css("position","relative")});b=m.css({zIndex:Math.max(k.zIndex+1,l=="auto"?0:l)})}e.css({display:"block"}).fadeTo(k.loadSpeed,k.opacity,function(){a.mask.fit();d(k.onLoad)});f=true;return this},close:function(){if(f){if(d(i.onBeforeClose)===
false)return this;e.fadeOut(i.closeSpeed,function(){d(i.onClose);b&&b.css({zIndex:l})});a(document).unbind("keydown.mask");e.unbind("click.mask");a(window).unbind("resize.mask");f=false}return this},fit:function(){if(f){var k=g();e.css({width:k[0],height:k[1]})}},getMask:function(){return e},isLoaded:function(){return f},getConf:function(){return i},getExposed:function(){return b}};a.fn.mask=function(k){a.mask.load(k);return this};a.fn.expose=function(k){a.mask.load(k,this);return this}})(jQuery);
(function(a){function g(e,b){var f=this,i=e.add(f),l=a(window),k,m,q,p=a.tools.expose&&(b.mask||b.expose),s=Math.random().toString().slice(10);if(p){if(typeof p=="string")p={color:p};p.closeOnClick=p.closeOnEsc=false}var t=b.target||e.attr("rel");m=t?a(t):e;if(!m.length)throw"Could not find Overlay: "+t;e&&e.index(m)==-1&&e.click(function(o){f.load(o);return o.preventDefault()});a.extend(f,{load:function(o){if(f.isOpened())return f;var u=c[b.effect];if(!u)throw'Overlay: cannot find effect : "'+b.effect+
'"';b.oneInstance&&a.each(d,function(){this.close(o)});o=o||a.Event();o.type="onBeforeLoad";i.trigger(o);if(o.isDefaultPrevented())return f;q=true;p&&a(m).expose(p);var v=b.top,x=b.left,z=m.outerWidth({margin:true}),y=m.outerHeight({margin:true});if(typeof v=="string")v=v=="center"?Math.max((l.height()-y)/2,0):parseInt(v,10)/100*l.height();if(x=="center")x=Math.max((l.width()-z)/2,0);u[0].call(f,{top:v,left:x},function(){if(q){o.type="onLoad";i.trigger(o)}});p&&b.closeOnClick&&a.mask.getMask().one("click",
f.close);b.closeOnClick&&a(document).bind("click."+s,function(h){a(h.target).parents(m).length||f.close(h)});b.closeOnEsc&&a(document).bind("keydown."+s,function(h){h.keyCode==27&&f.close(h)});return f},close:function(o){if(!f.isOpened())return f;o=o||a.Event();o.type="onBeforeClose";i.trigger(o);if(!o.isDefaultPrevented()){q=false;c[b.effect][1].call(f,function(){o.type="onClose";i.trigger(o)});a(document).unbind("click."+s).unbind("keydown."+s);p&&a.mask.close();return f}},getOverlay:function(){return m},
getTrigger:function(){return e},getClosers:function(){return k},isOpened:function(){return q},getConf:function(){return b}});a.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(o,u){a.isFunction(b[u])&&a(f).bind(u,b[u]);f[u]=function(v){a(f).bind(u,v);return f}});k=m.find(b.close||".close");if(!k.length&&!b.close){k=a('<a class="close"></a>');m.prepend(k)}k.click(function(o){f.close(o)});b.load&&f.load()}a.tools=a.tools||{version:"@VERSION"};a.tools.overlay={addEffect:function(e,
b,f){c[e]=[b,f]},conf:{close:null,closeOnClick:true,closeOnEsc:true,closeSpeed:"fast",effect:"default",fixed:!a.browser.msie||a.browser.version>6,left:"center",load:false,mask:null,oneInstance:true,speed:"normal",target:null,top:"10%"}};var d=[],c={};a.tools.overlay.addEffect("default",function(e,b){var f=this.getConf(),i=a(window);if(!f.fixed){e.top+=i.scrollTop();e.left+=i.scrollLeft()}e.position=f.fixed?"fixed":"absolute";this.getOverlay().css(e).fadeIn(f.speed,b)},function(e){this.getOverlay().fadeOut(this.getConf().closeSpeed,
e)});a.fn.overlay=function(e){var b=this.data("overlay");if(b)return b;if(a.isFunction(e))e={onBeforeLoad:e};e=a.extend(true,{},a.tools.overlay.conf,e);this.each(function(){b=new g(a(this),e);d.push(b);a(this).data("overlay",b)});return e.api?b:this}})(jQuery);
(function(a,g,d){g.infinitescroll=function(b,f,i){this.element=g(i);this._create(b,f)};g.infinitescroll.defaults={loading:{finished:d,finishedMsg:"<em>Congratulations, you've reached the end of the internet.</em>",img:"http://www.infinite-scroll.com/loading.gif",msg:null,msgText:"<em>Loading the next set of posts...</em>",selector:null,speed:"fast",start:d},state:{isDuringAjax:false,isInvalidPage:false,isDestroyed:false,isDone:false,isPaused:false,currPage:1},callback:d,debug:false,behavior:d,binder:g(a),
nextSelector:"div.navigation a:first",navSelector:"div.navigation",contentSelector:null,extraScrollPx:150,itemSelector:"div.post",animate:false,pathParse:d,dataType:"html",appendCallback:true,bufferPx:40,errorCallback:function(){},infid:0,pixelsFromNavToBottom:d,path:d};g.infinitescroll.prototype={_binding:function(b){var f=this,i=f.options;if(i.behavior&&this["_binding_"+i.behavior]!==d)this["_binding_"+i.behavior].call(this);else{if(b!=="bind"&&b!=="unbind"){this._debug("Binding value  "+b+" not valid");
return false}b=="unbind"?this.options.binder.unbind("smartscroll.infscr."+f.options.infid):this.options.binder[b]("smartscroll.infscr."+f.options.infid,function(){f.scroll()});this._debug("Binding",b)}},_create:function(b,f){if(!this._validate(b))return false;var i=this.options=g.extend(true,{},g.infinitescroll.defaults,b),l=g(i.nextSelector).attr("href");i.contentSelector=i.contentSelector||this.element;i.loading.selector=i.loading.selector||i.contentSelector;if(l){i.path=this._determinepath(l);
i.loading.msg=g('<div id="infscr-loading"><img alt="Loading..." src="'+i.loading.img+'" /><div>'+i.loading.msgText+"</div></div>");(new Image).src=i.loading.img;i.pixelsFromNavToBottom=g(document).height()-g(i.navSelector).offset().top;i.loading.start=i.loading.start||function(){g(i.navSelector).hide();i.loading.msg.appendTo(i.loading.selector).show(i.loading.speed,function(){beginAjax(i)})};i.loading.finished=i.loading.finished||function(){i.loading.msg.fadeOut("normal")};i.callback=function(k,m){i.behavior&&
k["_callback_"+i.behavior]!==d&&k["_callback_"+i.behavior].call(g(i.contentSelector)[0],m);f&&f.call(g(i.contentSelector)[0],m)};this._setup()}else this._debug("Navigation selector not found")},_debug:function(){if(this.options.debug)return a.console&&console.log.call(console,arguments)},_determinepath:function(b){var f=this.options;if(f.behavior&&this["_determinepath_"+f.behavior]!==d)this["_determinepath_"+f.behavior].call(this,b);else{if(f.pathParse){this._debug("pathParse manual");if(typeof f.pathParse===
"function")return f.pathParse();return f.pathParse}else if(b.match(/^(.*?)\b2\b(.*?$)/))b=b.match(/^(.*?)\b2\b(.*?$)/).slice(1);else if(b.match(/^(.*?)2(.*?$)/)){if(b.match(/^(.*?page=)2(\/.*|$)/))return b=b.match(/^(.*?page=)2(\/.*|$)/).slice(1);b=b.match(/^(.*?)2(.*?$)/).slice(1)}else if(b.match(/^(.*?page=)1(\/.*|$)/))return b=b.match(/^(.*?page=)1(\/.*|$)/).slice(1);else{this._debug("Sorry, we couldn't parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com.");
f.state.isInvalidPage=true}this._debug("determinePath",b);return b}},_error:function(b){var f=this.options;if(f.behavior&&this["_error_"+f.behavior]!==d)this["_error_"+f.behavior].call(this,b);else{if(b!=="destroy"&&b!=="end")b="unknown";this._debug("Error",b);b=="end"&&this._showdonemsg();f.state.isDone=true;f.state.currPage=1;f.state.isPaused=false;this._binding("unbind")}},_loadcallback:function(b,f){var i=this.options,l=this.options.callback,k=i.state.isDone?"done":!i.appendCallback?"no-append":
"append";if(i.behavior&&this["_loadcallback_"+i.behavior]!==d)this["_loadcallback_"+i.behavior].call(this,b,f);else{switch(k){case "done":this._showdonemsg();return false;case "no-append":if(i.dataType=="html"){f="<div>"+f+"</div>";f=g(f).find(i.itemSelector)}break;case "append":var m=b.children();if(m.length==0)return this._error("end");for(k=document.createDocumentFragment();b[0].firstChild;)k.appendChild(b[0].firstChild);this._debug("contentSelector",g(i.contentSelector)[0]);g(i.contentSelector)[0].appendChild(k);
f=m.get();break}i.loading.finished.call(g(i.contentSelector)[0],i);if(i.animate){k=g(a).scrollTop()+g("#infscr-loading").height()+i.extraScrollPx+"px";g("html,body").animate({scrollTop:k},800,function(){i.state.isDuringAjax=false})}if(!i.animate)i.state.isDuringAjax=false;l(this,f)}},_nearbottom:function(){var b=this.options,f=0+g(document).height()-b.binder.scrollTop()-g(a).height();if(b.behavior&&this["_nearbottom_"+b.behavior]!==d)this["_nearbottom_"+b.behavior].call(this);else{this._debug("math:",
f,b.pixelsFromNavToBottom);return f-b.bufferPx<b.pixelsFromNavToBottom}},_pausing:function(b){var f=this.options;if(f.behavior&&this["_pausing_"+f.behavior]!==d)this["_pausing_"+f.behavior].call(this,b);else{b!=="pause"&&b!=="resume"&&b!==null&&this._debug("Invalid argument. Toggling pause value instead");switch(b&&(b=="pause"||b=="resume")?b:"toggle"){case "pause":f.state.isPaused=true;break;case "resume":f.state.isPaused=false;break;case "toggle":f.state.isPaused=!f.state.isPaused;break}this._debug("Paused",
f.state.isPaused);return false}},_setup:function(){var b=this.options;if(b.behavior&&this["_setup_"+b.behavior]!==d)this["_setup_"+b.behavior].call(this);else{this._binding("bind");return false}},_showdonemsg:function(){var b=this.options;if(b.behavior&&this["_showdonemsg_"+b.behavior]!==d)this["_showdonemsg_"+b.behavior].call(this);else{b.loading.msg.find("img").hide().parent().find("div").html(b.loading.finishedMsg).animate({opacity:1},2E3,function(){g(this).parent().fadeOut("normal")});b.errorCallback.call(g(b.contentSelector)[0],
"done")}},_validate:function(b){for(var f in b){if(f.indexOf&&f.indexOf("Selector")>-1&&g(b[f]).length===0){this._debug("Your "+f+" found no elements.");return false}return true}},bind:function(){this._binding("bind")},destroy:function(){this.options.state.isDestroyed=true;return this._error("destroy")},pause:function(){this._pausing("pause")},resume:function(){this._pausing("resume")},retrieve:function(b){var f=this,i=f.options,l=this._determinepath(l),k,m,q,p;b=b||null;beginAjax=function(s){s.state.currPage++;
f._debug("heading into ajax",l);k=g(s.contentSelector).is("table")?g("<tbody/>"):g("<div/>");m=l.join(s.state.currPage);q=s.dataType=="html"||s.dataType=="json"?s.dataType:"html+callback";if(s.appendCallback&&s.dataType=="html")q+="+callback";switch(q){case "html+callback":f._debug("Using HTML via .load() method");k.load(m+" "+s.itemSelector,null,function(t){f._loadcallback(k,t)});break;case "html":case "json":f._debug("Using "+q.toUpperCase()+" via $.ajax() method");g.ajax({url:m,dataType:s.dataType,
complete:function(t,o){(p=typeof t.isResolved!=="undefined"?t.isResolved():o==="success"||o==="notmodified")?f._loadcallback(k,t.responseText):f._error("end")}});break}};if(i.behavior&&this["retrieve_"+i.behavior]!==d)this["retrieve_"+i.behavior].call(this,b);else{if(i.state.isDestroyed){this._debug("Instance is destroyed");return false}i.state.isDuringAjax=true;i.loading.start.call(g(i.contentSelector)[0],i)}},scroll:function(){var b=this.options,f=b.state;if(b.behavior&&this["scroll_"+b.behavior]!==
d)this["scroll_"+b.behavior].call(this);else f.isDuringAjax||f.isInvalidPage||f.isDone||f.isDestroyed||f.isPaused||this._nearbottom()&&this.retrieve()},toggle:function(){this._pausing()},unbind:function(){this._binding("unbind")},update:function(b){if(g.isPlainObject(b))this.options=g.extend(true,this.options,b)}};g.fn.infinitescroll=function(b,f){switch(typeof b){case "string":var i=Array.prototype.slice.call(arguments,1);this.each(function(){var l=g.data(this,"infinitescroll");if(!l)return false;
if(!g.isFunction(l[b])||b.charAt(0)==="_")return false;l[b].apply(l,i)});break;case "object":this.each(function(){var l=g.data(this,"infinitescroll");l?l.update(b):g.data(this,"infinitescroll",new g.infinitescroll(b,f,this))});break}return this};var c=g.event,e;c.special.smartscroll={setup:function(){g(this).bind("scroll",c.special.smartscroll.handler)},teardown:function(){g(this).unbind("scroll",c.special.smartscroll.handler)},handler:function(b,f){var i=this,l=arguments;b.type="smartscroll";e&&
clearTimeout(e);e=setTimeout(function(){g.event.handle.apply(i,l)},f==="execAsap"?0:100)}};g.fn.smartscroll=function(b){return b?this.bind("smartscroll",b):this.trigger("smartscroll",["execAsap"])}})(window,jQuery);
(function(a){a.factory("collapse_module",{init:function(){var g=this;this.$column=a(this.options.column);this.modules=a(this.options.modules,this.element);this.first_module=this.modules.get(0);this.trigger=a(".trigger:first",this.first_module);this.first_section=a(".module-section",this.first_module);this.other_modules=this.modules.slice(1);this.column_offset=this.$column.css("margin-left");this.set_collapsed(this.options.collapsed);this.trigger.click(function(d){return g.toggle(d)})},set_collapsed:function(g){if(this.toggle_state=
g){this.trigger.addClass("collapsed");this.$column.css("margin-left",0);this.first_section.hide();this.other_modules.hide()}else{this.trigger.removeClass("collapsed");this.$column.css("margin-left",this.column_offset);this.first_section.show();this.other_modules.show()}},toggle:function(){var g=this;if(this.toggle_state){a.localstore("filters_collapsed",0,false);this.trigger.removeClass("collapsed");this.$column.animate({marginLeft:this.column_offset},function(){g.first_section.slideDown(function(){g.modules.removeClass("collapsed")});
g.other_modules.fadeIn()})}else{a.localstore("filters_collapsed",1,false);this.trigger.addClass("collapsed");this.other_modules.fadeOut();this.first_section.slideUp(function(){g.$column.animate({marginLeft:0});g.modules.addClass("collapsed")})}this.toggle_state=!this.toggle_state;this.options.toggle_callback&&this.options.toggle_callback.call(this.trigger,this.toggle_state);return false}});a.extend(true,a.collapse_module,{defaults:{collapsed:!!a.localstore("filters_collapsed"),modules:".module",column:"#main-column"}})})(jQuery);
(function(a,g){function d(c){return!a(c).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};if(!a.ui.version){a.extend(a.ui,{version:"1.8.10",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,
PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});a.fn.extend({_focus:a.fn.focus,focus:function(c,e){return typeof c==="number"?this.each(function(){var b=this;setTimeout(function(){a(b).focus();e&&e.call(b)},c)}):this._focus.apply(this,arguments)},scrollParent:function(){var c;c=a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,
"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!c.length?a(document):c},zIndex:function(c){if(c!==g)return this.css("zIndex",c);if(this.length){c=a(this[0]);for(var e;c.length&&c[0]!==document;){e=c.css("position");
if(e==="absolute"||e==="relative"||e==="fixed"){e=parseInt(c.css("zIndex"),10);if(!isNaN(e)&&e!==0)return e}c=c.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(c){c.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});a.each(["Width","Height"],function(c,e){function b(k,m,q,p){a.each(f,function(){m-=parseFloat(a.curCSS(k,"padding"+this,true))||0;if(q)m-=parseFloat(a.curCSS(k,
"border"+this+"Width",true))||0;if(p)m-=parseFloat(a.curCSS(k,"margin"+this,true))||0});return m}var f=e==="Width"?["Left","Right"]:["Top","Bottom"],i=e.toLowerCase(),l={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+e]=function(k){if(k===g)return l["inner"+e].call(this);return this.each(function(){a(this).css(i,b(this,k)+"px")})};a.fn["outer"+e]=function(k,m){if(typeof k!=="number")return l["outer"+e].call(this,k);return this.each(function(){a(this).css(i,
b(this,k,true,m)+"px")})}});a.extend(a.expr[":"],{data:function(c,e,b){return!!a.data(c,b[3])},focusable:function(c){var e=c.nodeName.toLowerCase(),b=a.attr(c,"tabindex");if("area"===e){e=c.parentNode;b=e.name;if(!c.href||!b||e.nodeName.toLowerCase()!=="map")return false;c=a("img[usemap=#"+b+"]")[0];return!!c&&d(c)}return(/input|select|textarea|button|object/.test(e)?!c.disabled:"a"==e?c.href||!isNaN(b):!isNaN(b))&&d(c)},tabbable:function(c){var e=a.attr(c,"tabindex");return(isNaN(e)||e>=0)&&a(c).is(":focusable")}});
a(function(){var c=document.body,e=c.appendChild(e=document.createElement("div"));a.extend(e.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=e.offsetHeight===100;a.support.selectstart="onselectstart"in e;c.removeChild(e).style.display="none"});a.extend(a.ui,{plugin:{add:function(c,e,b){c=a.ui[c].prototype;for(var f in b){c.plugins[f]=c.plugins[f]||[];c.plugins[f].push([e,b[f]])}},call:function(c,e,b){if((e=c.plugins[e])&&c.element[0].parentNode)for(var f=0;f<e.length;f++)c.options[e[f][0]]&&
e[f][1].apply(c.element,b)}},contains:function(c,e){return document.compareDocumentPosition?c.compareDocumentPosition(e)&16:c!==e&&c.contains(e)},hasScroll:function(c,e){if(a(c).css("overflow")==="hidden")return false;var b=e&&e==="left"?"scrollLeft":"scrollTop",f=false;if(c[b]>0)return true;c[b]=1;f=c[b]>0;c[b]=0;return f},isOverAxis:function(c,e,b){return c>e&&c<e+b},isOver:function(c,e,b,f,i,l){return a.ui.isOverAxis(c,b,i)&&a.ui.isOverAxis(e,f,l)}})}})(jQuery);
(function(a){a.widget("ui.slider",a.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var g=this,d=this.options;this._mouseSliding=this._keySliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");d.disabled&&this.element.addClass("ui-slider-disabled ui-disabled");
this.range=a([]);if(d.range){if(d.range===true){this.range=a("<div></div>");if(!d.values)d.values=[this._valueMin(),this._valueMin()];if(d.values.length&&d.values.length!==2)d.values=[d.values[0],d.values[0]]}else this.range=a("<div></div>");this.range.appendTo(this.element).addClass("ui-slider-range");if(d.range==="min"||d.range==="max")this.range.addClass("ui-slider-range-"+d.range);this.range.addClass("ui-widget-header")}a(".ui-slider-handle",this.element).length===0&&a("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");
if(d.values&&d.values.length)for(;a(".ui-slider-handle",this.element).length<d.values.length;)a("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");this.handles=a(".ui-slider-handle",this.element).addClass("ui-state-default ui-corner-all");this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(c){c.preventDefault()}).hover(function(){d.disabled||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).focus(function(){if(d.disabled)a(this).blur();
else{a(".ui-slider .ui-state-focus").removeClass("ui-state-focus");a(this).addClass("ui-state-focus")}}).blur(function(){a(this).removeClass("ui-state-focus")});this.handles.each(function(c){a(this).data("index.ui-slider-handle",c)});this.handles.keydown(function(c){var e=true,b=a(this).data("index.ui-slider-handle"),f,i,l;if(!g.options.disabled){switch(c.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:e=
false;if(!g._keySliding){g._keySliding=true;a(this).addClass("ui-state-active");f=g._start(c,b);if(f===false)return}break}l=g.options.step;f=g.options.values&&g.options.values.length?(i=g.values(b)):(i=g.value());switch(c.keyCode){case a.ui.keyCode.HOME:i=g._valueMin();break;case a.ui.keyCode.END:i=g._valueMax();break;case a.ui.keyCode.PAGE_UP:i=g._trimAlignValue(f+(g._valueMax()-g._valueMin())/5);break;case a.ui.keyCode.PAGE_DOWN:i=g._trimAlignValue(f-(g._valueMax()-g._valueMin())/5);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(f===
g._valueMax())return;i=g._trimAlignValue(f+l);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(f===g._valueMin())return;i=g._trimAlignValue(f-l);break}g._slide(c,b,i);return e}}).keyup(function(c){var e=a(this).data("index.ui-slider-handle");if(g._keySliding){g._keySliding=false;g._stop(c,e);g._change(c,e);a(this).removeClass("ui-state-active")}});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");
this._mouseDestroy();return this},_mouseCapture:function(g){var d=this.options,c,e,b,f,i;if(d.disabled)return false;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();c=this._normValueFromMouse({x:g.pageX,y:g.pageY});e=this._valueMax()-this._valueMin()+1;f=this;this.handles.each(function(l){var k=Math.abs(c-f.values(l));if(e>k){e=k;b=a(this);i=l}});if(d.range===true&&this.values(1)===d.min){i+=1;b=a(this.handles[i])}if(this._start(g,
i)===false)return false;this._mouseSliding=true;f._handleIndex=i;b.addClass("ui-state-active").focus();d=b.offset();this._clickOffset=!a(g.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:g.pageX-d.left-b.width()/2,top:g.pageY-d.top-b.height()/2-(parseInt(b.css("borderTopWidth"),10)||0)-(parseInt(b.css("borderBottomWidth"),10)||0)+(parseInt(b.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(g,i,c);return this._animateOff=true},_mouseStart:function(){return true},
_mouseDrag:function(g){var d=this._normValueFromMouse({x:g.pageX,y:g.pageY});this._slide(g,this._handleIndex,d);return false},_mouseStop:function(g){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(g,this._handleIndex);this._change(g,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(g){var d;
if(this.orientation==="horizontal"){d=this.elementSize.width;g=g.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{d=this.elementSize.height;g=g.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}d=g/d;if(d>1)d=1;if(d<0)d=0;if(this.orientation==="vertical")d=1-d;g=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+d*g)},_start:function(g,d){var c={handle:this.handles[d],value:this.value()};if(this.options.values&&this.options.values.length){c.value=
this.values(d);c.values=this.values()}return this._trigger("start",g,c)},_slide:function(g,d,c){var e;if(this.options.values&&this.options.values.length){e=this.values(d?0:1);if(this.options.values.length===2&&this.options.range===true&&(d===0&&c>e||d===1&&c<e))c=e;if(c!==this.values(d)){e=this.values();e[d]=c;g=this._trigger("slide",g,{handle:this.handles[d],value:c,values:e});this.values(d?0:1);g!==false&&this.values(d,c,true)}}else if(c!==this.value()){g=this._trigger("slide",g,{handle:this.handles[d],
value:c});g!==false&&this.value(c)}},_stop:function(g,d){var c={handle:this.handles[d],value:this.value()};if(this.options.values&&this.options.values.length){c.value=this.values(d);c.values=this.values()}this._trigger("stop",g,c)},_change:function(g,d){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[d],value:this.value()};if(this.options.values&&this.options.values.length){c.value=this.values(d);c.values=this.values()}this._trigger("change",g,c)}},value:function(g){if(arguments.length){this.options.value=
this._trimAlignValue(g);this._refreshValue();this._change(null,0)}return this._value()},values:function(g,d){var c,e,b;if(arguments.length>1){this.options.values[g]=this._trimAlignValue(d);this._refreshValue();this._change(null,g)}if(arguments.length)if(a.isArray(arguments[0])){c=this.options.values;e=arguments[0];for(b=0;b<c.length;b+=1){c[b]=this._trimAlignValue(e[b]);this._change(null,b)}this._refreshValue()}else return this.options.values&&this.options.values.length?this._values(g):this.value();
else return this._values()},_setOption:function(g,d){var c,e=0;if(a.isArray(this.options.values))e=this.options.values.length;a.Widget.prototype._setOption.apply(this,arguments);switch(g){case "disabled":if(d){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.attr("disabled","disabled");this.element.addClass("ui-disabled")}else{this.handles.removeAttr("disabled");this.element.removeClass("ui-disabled")}break;case "orientation":this._detectOrientation();
this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case "values":this._animateOff=true;this._refreshValue();for(c=0;c<e;c+=1)this._change(null,c);this._animateOff=false;break}},_value:function(){var g=this.options.value;return g=this._trimAlignValue(g)},_values:function(g){var d,c;if(arguments.length){d=this.options.values[g];
return d=this._trimAlignValue(d)}else{d=this.options.values.slice();for(c=0;c<d.length;c+=1)d[c]=this._trimAlignValue(d[c]);return d}},_trimAlignValue:function(g){if(g<=this._valueMin())return this._valueMin();if(g>=this._valueMax())return this._valueMax();var d=this.options.step>0?this.options.step:1,c=(g-this._valueMin())%d;alignValue=g-c;if(Math.abs(c)*2>=d)alignValue+=c>0?d:-d;return parseFloat(alignValue.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},
_refreshValue:function(){var g=this.options.range,d=this.options,c=this,e=!this._animateOff?d.animate:false,b,f={},i,l,k,m;if(this.options.values&&this.options.values.length)this.handles.each(function(q){b=(c.values(q)-c._valueMin())/(c._valueMax()-c._valueMin())*100;f[c.orientation==="horizontal"?"left":"bottom"]=b+"%";a(this).stop(1,1)[e?"animate":"css"](f,d.animate);if(c.options.range===true)if(c.orientation==="horizontal"){if(q===0)c.range.stop(1,1)[e?"animate":"css"]({left:b+"%"},d.animate);
if(q===1)c.range[e?"animate":"css"]({width:b-i+"%"},{queue:false,duration:d.animate})}else{if(q===0)c.range.stop(1,1)[e?"animate":"css"]({bottom:b+"%"},d.animate);if(q===1)c.range[e?"animate":"css"]({height:b-i+"%"},{queue:false,duration:d.animate})}i=b});else{l=this.value();k=this._valueMin();m=this._valueMax();b=m!==k?(l-k)/(m-k)*100:0;f[c.orientation==="horizontal"?"left":"bottom"]=b+"%";this.handle.stop(1,1)[e?"animate":"css"](f,d.animate);if(g==="min"&&this.orientation==="horizontal")this.range.stop(1,
1)[e?"animate":"css"]({width:b+"%"},d.animate);if(g==="max"&&this.orientation==="horizontal")this.range[e?"animate":"css"]({width:100-b+"%"},{queue:false,duration:d.animate});if(g==="min"&&this.orientation==="vertical")this.range.stop(1,1)[e?"animate":"css"]({height:b+"%"},d.animate);if(g==="max"&&this.orientation==="vertical")this.range[e?"animate":"css"]({height:100-b+"%"},{queue:false,duration:d.animate})}}});a.extend(a.ui.slider,{version:"1.8.10"})})(jQuery);
(function(a,g){g.filters={init_domain_type_property_filter:function(d){a(":text[name=domain], :text[name=type], :text[name=property]",d).suggest(g.suggest_options.any("/type/domain","/type/type","/type/property")).bind("fb-select",function(c,e){var b=a(this);b.val(e.id);var f=e["n:type"].id;if(f==="/type/domain")b.attr("name","domain");else if(f==="/type/type")b.attr("name","type");else f==="/type/property"&&b.attr("name","property");this.form.submit()})},init_limit_slider_filter:function(d,c,e,b,
f){var i=a(".limit-slider",d),l=a(".current-limit",d),k=a("input[name=limit]",d),m=parseInt(k.val()||c,10);i.slider({value:m,min:e||1,max:b||100,step:f||10,slide:function(q,p){l.css({color:"#f71"});l.text(p.value)},stop:function(q,p){l.css({color:"#333"});k.val(p.value);p.value!=m&&k[0].form.submit()}})}};a(function(){a(".filter-form-trigger").click(function(){var d=a(this).siblings(".filter-form");d.is(":hidden")?d.slideDown(function(){a(":text:first",d).focus()}):d.slideUp()})})})(jQuery,window.freebase);
(function(a){var g=function(){return typeof window.innerWidth!="undefined"?function(){return{w:window.innerWidth,h:window.innerHeight}}:typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!=0?function(){return{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}}:function(){return{w:document.getElementsByTagName("body")[0].clientWidth,h:document.getElementsByTagName("body")[0].clientHeight}}}();
window.kbs=function(d){a(".kbs.current",d).removeClass("current");var c=a(".domain-section:first",d),e=a(".domain-section:last",d),b=this.scroll_to=function(h){var j=a(document).scrollTop();a(document).height();var n=g().h;n=j+n;var r=h.offset().top;h=r+h.height();if(r<j)a(document).scrollTop(r);else h>n&&a(document).scrollTop(j+(h-n))},f=this.get_current=function(){return a(".kbs.current:first",d)},i=this.set_next=function(h,j,n){h=h||f();if(j.length){h.removeClass("current");j.addClass("current");
n||b(j)}},l=this.next_domain=function(h){var j=f(),n=k(j);if(n){n=n.find(".kbs:first");i(j,n,h)}},k=this._next_domain=function(h){if(!(h&&h.length))return a(".domain-section:first",d);h=h.closest(".domain-section");return!h.length||h[0]===e[0]?c:h.next(".domain-section")},m=this.prev_domain=function(){var h=f(),j=q(h);if(j){j=j.find(".kbs:first");i(h,j)}},q=this._prev_domain=function(h){if(!(h&&h.length))return a(".domain-section:last",d);var j=h.closest(".domain-section");if(h.closest(".property-section").length||
h.closest(".type-section").length)return j;return!j.length||j[0]===c[0]?e:j.prev(".domain-section")},p=this.next_type=function(){var h=f(),j=s(h);if(j){j=j.find(".kbs:first");i(h,j)}},s=this._next_type=function(h){if(!(h&&h.length))return a(".type-section:first",d);var j=h.closest(".domain-section");h=h.closest(".type-section");h=h.length?h.next(".type-section"):j.find(".type-section:first");if(!(h&&h.length)){var n=k(j);if(n)for(;n.get(0)!==j.get(0);){h=n.find(".type-section:first");if(h.length)break;
n=k(n)}}return h},t=this.prev_type=function(){var h=f(),j=o(h);if(j){j=j.find(".kbs:first");i(h,j)}},o=this._prev_type=function(h){if(!(h&&h.length))return a(".type-section:last",d);var j=h.closest(".domain-section"),n=h.closest(".type-section");if(h.closest(".property-section").length)return n;var r;if(n.length)r=n.prev(".type-section");if(!(r&&r.length))if(h=q(j))for(;h.get(0)!==j.get(0);){r=h.find(".type-section:last");if(r.length)break;h=q(h)}return r},u=this.next_prop=function(){var h=f(),j=
v(h);if(j){j=j.find(".kbs:first");i(h,j)}},v=this._next_prop=function(h){if(!(h&&h.length))return a(".property-section:first",d);var j=h.closest(".domain-section"),n=h.closest(".type-section"),r=h.closest(".property-section");j=r.length?r.next(".property-section"):n.length?n.find(".property-section:first"):j.find(".property-section:first");if(!(j&&j.length))if(h=s(h))for(;h.get(0)!==n.get(0);){j=h.find(".property-section:first");if(j.length)break;if(n.get(0)==null)n=h;h=s(h)}return j},x=this.prev_prop=
function(){var h=f(),j=z(h);if(j){j=j.find(".kbs:first");i(h,j)}},z=this._prev_prop=function(h){if(!(h&&h.length))return a(".property-section:last",d);var j=h.closest(".domain-section"),n=h.closest(".type-section"),r=h.closest(".property-section");if(h.closest(".data-section").length)return r;var w;if(r.length)w=r.prev(".property-section");if(!(w&&w.length))if(t=n.length?o(n):o(j))for(;t.get(0)!==n.get(0);){w=t.find(".property-section:last");if(w.length)break;if(n.get(0)==null)n=t;t=o(t)}return w};
this.next=function(){var h=f(),j=this._next(h);j&&i(h,j)};this._next=function(h){if(!(h&&h.length))return a(".domain-section:first .kbs:first",d);var j=h.closest(".domain-section"),n=h.closest(".type-section"),r=h.closest(".property-section");if(h.closest(".data-section").length){h=h.next(".kbs");if(h.length)return h;h=r.next(".property-section").find(".kbs:first");if(h.length)return h;h=n.next(".type-section").find(".kbs:first")}else if(r.length){h=r.find(".data-section:first .kbs:first");if(h.length)return h;
h=r.next(".property-section").find(".kbs:first");if(h.length)return h;h=n.next(".type-section").find(".kbs:first")}else if(n.length){h=n.find(".property-section:first .kbs:first");if(h.length)return h;h=n.next(".type-section").find(".kbs:first")}else h=j.find(".type-section:first .kbs:first");if(h.length)return h;return j.get(0)===e.get(0)?c.find(".kbs:first"):j.next(".domain-section").find(".kbs:first")};this.prev=function(){var h=f(),j=this._prev(h);j&&i(h,j)};this._prev=function(h){if(!(h&&h.length)){h=
a(".data-section:last .kbs:last",d);h.length||(h=a(".property-section:last .kbs:first",d));h.length||(h=a(".type-section:last .kbs:first",d));h.length||(h=a(".domain-section:last .kbs:first",d));return h}var j=h.closest(".domain-section"),n=h.closest(".type-section"),r=h.closest(".property-section");if(h.closest(".data-section").length){h=h.prev(".kbs");if(h.length)return h;return r.find(".kbs:first")}else if(r.length){h=r.prev(".property-section").find(".kbs:last");if(h.length)return h;return n.find(".kbs:first")}else if(n.length){h=
n.prev(".type-section").find(".kbs:last");if(h.length)return h;return j.find(".kbs:first")}else return j.get(0)===c.get(0)?e.find(".kbs:last"):j.prev(".domain-section").find(".kbs:last")};this.edit=function(){this.get_current().trigger("edit")};var y=this;a(document).unbind(".kbs").bind("keydown.kbs",function(h){var j=h.target;if(j==document.body||j==document||j==window||j==a("html")[0]){j=h.keyCode;if(j===68)h.shiftKey?m():l();else if(j===84)h.shiftKey?t():p();else if(j===80)h.shiftKey?x():u();else if(j===
74)y.next();else if(j===75)y.prev();else j===69&&y.edit()}})}})(jQuery);
(function(a,g){var d=window.propbox={init:function(c,e){e=a.extend({lang:"/lang/en"},e);if(!e.base_ajax_url)throw new Error("base_ajax_url required in propbox options");if(!e.base_static_url)throw new Error("base_static_url required in propbox options");if(!e.id)throw new Error("topic id required in propbox options");if(!e.lang)throw new Error("lang required in propbox options");d.options=e;d.kbs=new g(c);d.kbs.set_next(d.kbs.get_current(),a(".kbs:visible:first",c,true));a(".kbs",c).live("click",
function(){var b=d.kbs.get_current();d.kbs.set_next(b,a(this),true)}).live("edit",function(){var b=a(this).find(".headmenu:first").data("submenu");b&&a("li:first a:first",b).click()});d.init_menus(c)},init_menus:function(c,e){c=a(c||document);e&&a(".nicemenu",c).nicemenu();(c&&c.is(".data-row")?c:a(".data-row",c)).hover(d.row_menu_hoverover,d.row_menu_hoverout);a(".nicemenu .headmenu",c).add(a(".nicemenu .default-action",c)).click("click",function(){if(d.kbs){var b=d.kbs.get_current();b&&d.kbs.set_next(b,
a(this).parents(".kbs:first"),true)}return false})},row_menu_hoverover:function(){var c=a(this);d.row_menu_hoverover.timeout=setTimeout(function(){c.addClass("row-hover")},300)},row_menu_hoverout:function(){clearTimeout(d.row_menu_hoverover.timeout);a(this).removeClass("row-hover")},get_script:function(c,e){var b=d.get_script.cache;if(!b)b=d.get_script.cache={};var f=b[c];if(f)if(f.state===1)f.callbacks.push(e);else f.state===4&&e();else{f=b[c]={state:0,callbacks:[e]};a.ajax({url:d.options.base_static_url+
c,dataType:"script",beforeSend:function(){f.state=1},success:function(){f.state=4;a.each(f.callbacks,function(i,l){l()})},error:function(){f.state=-1}})}},prop_edit:function(c,e){var b=a(c).parents(".submenu").data("headmenu").parents(".property-section").find(".data-section .data-row:first:visible .nicemenu:first .headmenu:first a");b.length?b.click():d.prop_add(c,e);return false},prop_add:function(c,e){var b=a(c).parents(".submenu").data("headmenu").parents(".property-section");if(b.is(".editing"))return false;
b.addClass("editing");d.get_script("/propbox-edit.mf.js",function(){d.edit.prop_add_begin(b,e)});return false},value_edit:function(c){var e=a(c).parents(".submenu").data("headmenu").parents(".data-row:first"),b=e.parents(".property-section");if(b.is(".editing"))return false;b.addClass("editing");d.get_script("/propbox-edit.mf.js",function(){d.edit.value_edit_begin(b,e)});return false},value_delete:function(c){var e=a(c).parents(".submenu").data("headmenu").parents(".data-row:first"),b=e.parents(".property-section");
if(b.is(".editing"))return false;b.addClass("editing");d.get_script("/propbox-edit.mf.js",function(){d.edit.value_delete_begin(b,e)});return false},close_message:function(c){a(c).parents(".row-msg:first").remove();return false}}})(jQuery,window.kbs);
(function(a,g){var d=g.collection={init_infinitescroll:function(){var c=a("#infinitescroll");if(c.attr("data-next")){var e=a("#infinitescroll-next");c.infinitescroll({nextSelector:"#infinitescroll-next",navSelector:"#infinitescroll-next",dataType:"json",pathParse:function(){return[e[0].href+"&"+a.param({cursor:c.attr("data-next")})+"&page=",""]},appendCallback:false},function(b){b=JSON.parse(b);var f=b.result.cursor;b=a(b.result.html);i18n.ize(b);c.append(b);f?c.attr("data-next",f):a(window).unbind(".infscr")})}},
init:function(){d.init_infinitescroll()}};a(d.init)})(jQuery,window.freebase,window.propbox);
