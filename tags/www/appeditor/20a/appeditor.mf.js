
/*
 * Copyright 2010, Google Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above
 * copyright notice, this list of conditions and the following disclaimer
 * in the documentation and/or other materials provided with the
 * distribution.
 *     * Neither the name of Google Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Additional Licenses for Third Party components can be found here:
 * http://wiki.freebase.com/wiki/Freebase_Site_License
 *
 */
/*
 
 jQuery Tools @VERSION Tabs- The basics of UI design.

 NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.

 http://flowplayer.org/tools/tabs/

 Since: November 2008
 Date: @DATE 
*/
(function(e){function b(m,n,l){var s=this,g=m.add(this),f=m.find(l.tabs),r=n.jquery?n:m.children(n),d;f.length||(f=m.children());r.length||(r=m.parent().find(n));r.length||(r=e(n));e.extend(this,{click:function(c,p){var h=f.eq(c);if(typeof c=="string"&&c.replace("#","")){c=c.replace(/([\"\#\$\%\&\'\(\)\*\+\,\.\/\:\;\<\=\>\?\@\[\\\]\^\`\{\|\}\~])/g,"\\$1");h=f.filter("[href*="+c.replace("#","")+"]");c=Math.max(f.index(h),0)}if(l.rotate){var j=f.length-1;if(c<0)return s.click(j,p);if(c>j)return s.click(0,
p)}if(!h.length){if(d>=0)return s;c=l.initialIndex;h=f.eq(c)}if(c===d)return s;p=p||e.Event();p.type="onBeforeClick";g.trigger(p,[c]);if(!p.isDefaultPrevented()){i[l.effect].call(s,c,function(){p.type="onClick";g.trigger(p,[c])});d=c;f.removeClass(l.current);h.addClass(l.current);return s}},getConf:function(){return l},getTabs:function(){return f},getPanes:function(){return r},getCurrentPane:function(){return r.eq(d)},getCurrentTab:function(){return f.eq(d)},getIndex:function(){return d},next:function(){return s.click(d+
1)},prev:function(){return s.click(d-1)},destroy:function(){f.unbind(l.event).removeClass(l.current);r.find("a[href^=#]").unbind("click.T");return s}});e.each("onBeforeClick,onClick".split(","),function(c,p){e.isFunction(l[p])&&e(s).bind(p,l[p]);s[p]=function(h){e(s).bind(p,h);return s}});if(l.history&&e.fn.history){e.tools.history.init(f);l.event="history"}f.each(function(c){e(this).bind(l.event,function(p){s.click(c,p);return p.preventDefault()})});r.find("a[href^=#]").bind("click.T",function(c){s.click(e(this).attr("href"),
c)});if(location.hash)s.click(location.hash);else if(l.initialIndex===0||l.initialIndex>0)s.click(l.initialIndex)}e.tools=e.tools||{version:"@VERSION"};e.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialIndex:0,event:"click",rotate:false,history:false},addEffect:function(m,n){i[m]=n}};var i={"default":function(m,n){this.getPanes().hide().eq(m).show();n.call()},fade:function(m,n){var l=this.getConf(),s=l.fadeOutSpeed,g=this.getPanes();s?g.fadeOut(s):
g.hide();g.eq(m).fadeIn(l.fadeInSpeed,n)},slide:function(m,n){this.getPanes().slideUp(200);this.getPanes().eq(m).slideDown(400,n)},ajax:function(m,n){this.getPanes().eq(0).load(this.getTabs().eq(m).attr("href"),n)}},a;e.tools.tabs.addEffect("horizontal",function(m,n){a||(a=this.getPanes().eq(0).width());this.getCurrentPane().animate({width:0},function(){e(this).hide()});this.getPanes().eq(m).animate({width:a},function(){e(this).show();n.call()})});e.fn.tabs=function(m,n){var l=this.data("tabs");if(l){l.destroy();
this.removeData("tabs")}if(e.isFunction(n))n={onBeforeClick:n};n=e.extend({},e.tools.tabs.conf,n);this.each(function(){l=new b(e(this),m,n);e(this).data("tabs",l)});return n.api?l:this}})(jQuery);
(function(e,b){function i(a){return!e(a).parents().andSelf().filter(function(){return e.curCSS(this,"visibility")==="hidden"||e.expr.filters.hidden(this)}).length}e.ui=e.ui||{};if(!e.ui.version){e.extend(e.ui,{version:"1.8.10",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,
PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});e.fn.extend({_focus:e.fn.focus,focus:function(a,m){return typeof a==="number"?this.each(function(){var n=this;setTimeout(function(){e(n).focus();m&&m.call(n)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;a=e.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.curCSS(this,
"position",1))&&/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!a.length?e(document):a},zIndex:function(a){if(a!==b)return this.css("zIndex",a);if(this.length){a=e(this[0]);for(var m;a.length&&a[0]!==document;){m=a.css("position");
if(m==="absolute"||m==="relative"||m==="fixed"){m=parseInt(a.css("zIndex"),10);if(!isNaN(m)&&m!==0)return m}a=a.parent()}}return 0},disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});e.each(["Width","Height"],function(a,m){function n(f,r,d,c){e.each(l,function(){r-=parseFloat(e.curCSS(f,"padding"+this,true))||0;if(d)r-=parseFloat(e.curCSS(f,
"border"+this+"Width",true))||0;if(c)r-=parseFloat(e.curCSS(f,"margin"+this,true))||0});return r}var l=m==="Width"?["Left","Right"]:["Top","Bottom"],s=m.toLowerCase(),g={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+m]=function(f){if(f===b)return g["inner"+m].call(this);return this.each(function(){e(this).css(s,n(this,f)+"px")})};e.fn["outer"+m]=function(f,r){if(typeof f!=="number")return g["outer"+m].call(this,f);return this.each(function(){e(this).css(s,
n(this,f,true,r)+"px")})}});e.extend(e.expr[":"],{data:function(a,m,n){return!!e.data(a,n[3])},focusable:function(a){var m=a.nodeName.toLowerCase(),n=e.attr(a,"tabindex");if("area"===m){m=a.parentNode;n=m.name;if(!a.href||!n||m.nodeName.toLowerCase()!=="map")return false;a=e("img[usemap=#"+n+"]")[0];return!!a&&i(a)}return(/input|select|textarea|button|object/.test(m)?!a.disabled:"a"==m?a.href||!isNaN(n):!isNaN(n))&&i(a)},tabbable:function(a){var m=e.attr(a,"tabindex");return(isNaN(m)||m>=0)&&e(a).is(":focusable")}});
e(function(){var a=document.body,m=a.appendChild(m=document.createElement("div"));e.extend(m.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});e.support.minHeight=m.offsetHeight===100;e.support.selectstart="onselectstart"in m;a.removeChild(m).style.display="none"});e.extend(e.ui,{plugin:{add:function(a,m,n){a=e.ui[a].prototype;for(var l in n){a.plugins[l]=a.plugins[l]||[];a.plugins[l].push([m,n[l]])}},call:function(a,m,n){if((m=a.plugins[m])&&a.element[0].parentNode)for(var l=0;l<m.length;l++)a.options[m[l][0]]&&
m[l][1].apply(a.element,n)}},contains:function(a,m){return document.compareDocumentPosition?a.compareDocumentPosition(m)&16:a!==m&&a.contains(m)},hasScroll:function(a,m){if(e(a).css("overflow")==="hidden")return false;var n=m&&m==="left"?"scrollLeft":"scrollTop",l=false;if(a[n]>0)return true;a[n]=1;l=a[n]>0;a[n]=0;return l},isOverAxis:function(a,m,n){return a>m&&a<m+n},isOver:function(a,m,n,l,s,g){return e.ui.isOverAxis(a,n,s)&&e.ui.isOverAxis(m,l,g)}})}})(jQuery);
(function(e,b){if(e.cleanData){var i=e.cleanData;e.cleanData=function(m){for(var n=0,l;(l=m[n])!=null;n++)e(l).triggerHandler("remove");i(m)}}else{var a=e.fn.remove;e.fn.remove=function(m,n){return this.each(function(){if(!n)if(!m||e.filter(m,[this]).length)e("*",this).add([this]).each(function(){e(this).triggerHandler("remove")});return a.call(e(this),m,n)})}}e.widget=function(m,n,l){var s=m.split(".")[0],g;m=m.split(".")[1];g=s+"-"+m;if(!l){l=n;n=e.Widget}e.expr[":"][g]=function(f){return!!e.data(f,
m)};e[s]=e[s]||{};e[s][m]=function(f,r){arguments.length&&this._createWidget(f,r)};n=new n;n.options=e.extend(true,{},n.options);e[s][m].prototype=e.extend(true,n,{namespace:s,widgetName:m,widgetEventPrefix:e[s][m].prototype.widgetEventPrefix||m,widgetBaseClass:g},l);e.widget.bridge(m,e[s][m])};e.widget.bridge=function(m,n){e.fn[m]=function(l){var s=typeof l==="string",g=Array.prototype.slice.call(arguments,1),f=this;l=!s&&g.length?e.extend.apply(null,[true,l].concat(g)):l;if(s&&l.charAt(0)==="_")return f;
s?this.each(function(){var r=e.data(this,m),d=r&&e.isFunction(r[l])?r[l].apply(r,g):r;if(d!==r&&d!==b){f=d;return false}}):this.each(function(){var r=e.data(this,m);r?r.option(l||{})._init():e.data(this,m,new n(l,this))});return f}};e.Widget=function(m,n){arguments.length&&this._createWidget(m,n)};e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(m,n){e.data(n,this.widgetName,this);this.element=e(n);this.options=e.extend(true,{},this.options,
this._getCreateOptions(),m);var l=this;this.element.bind("remove."+this.widgetName,function(){l.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},
widget:function(){return this.element},option:function(m,n){var l=m;if(arguments.length===0)return e.extend({},this.options);if(typeof m==="string"){if(n===b)return this.options[m];l={};l[m]=n}this._setOptions(l);return this},_setOptions:function(m){var n=this;e.each(m,function(l,s){n._setOption(l,s)});return this},_setOption:function(m,n){this.options[m]=n;if(m==="disabled")this.widget()[n?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",n);return this},
enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(m,n,l){var s=this.options[m];n=e.Event(n);n.type=(m===this.widgetEventPrefix?m:this.widgetEventPrefix+m).toLowerCase();l=l||{};if(n.originalEvent){m=e.event.props.length;for(var g;m;){g=e.event.props[--m];n[g]=n.originalEvent[g]}}this.element.trigger(n,l);return!(e.isFunction(s)&&s.call(this.element[0],n,l)===false||n.isDefaultPrevented())}}})(jQuery);
(function(e){e.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(i){return b._mouseDown(i)}).bind("click."+this.widgetName,function(i){if(true===e.data(i.target,b.widgetName+".preventClickEvent")){e.removeData(i.target,b.widgetName+".preventClickEvent");i.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(b){b.originalEvent=
b.originalEvent||{};if(!b.originalEvent.mouseHandled){this._mouseStarted&&this._mouseUp(b);this._mouseDownEvent=b;var i=this,a=b.which==1,m=typeof this.options.cancel=="string"?e(b.target).parents().add(b.target).filter(this.options.cancel).length:false;if(!a||m||!this._mouseCapture(b))return true;this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet)this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=true},this.options.delay);if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){this._mouseStarted=
this._mouseStart(b)!==false;if(!this._mouseStarted){b.preventDefault();return true}}this._mouseMoveDelegate=function(n){return i._mouseMove(n)};this._mouseUpDelegate=function(n){return i._mouseUp(n)};e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);b.preventDefault();return b.originalEvent.mouseHandled=true}},_mouseMove:function(b){if(e.browser.msie&&!(document.documentMode>=9)&&!b.button)return this._mouseUp(b);if(this._mouseStarted){this._mouseDrag(b);
return b.preventDefault()}if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b))(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==false)?this._mouseDrag(b):this._mouseUp(b);return!this._mouseStarted},_mouseUp:function(b){e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;b.target==this._mouseDownEvent.target&&e.data(b.target,this.widgetName+".preventClickEvent",
true);this._mouseStop(b)}return false},_mouseDistanceMet:function(b){return Math.max(Math.abs(this._mouseDownEvent.pageX-b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);
(function(e){e.ui=e.ui||{};var b=/left|center|right/,i=/top|center|bottom/,a=e.fn.position,m=e.fn.offset;e.fn.position=function(n){if(!n||!n.of)return a.apply(this,arguments);n=e.extend({},n);var l=e(n.of),s=l[0],g=(n.collision||"flip").split(" "),f=n.offset?n.offset.split(" "):[0,0],r,d,c;if(s.nodeType===9){r=l.width();d=l.height();c={top:0,left:0}}else if(s.setTimeout){r=l.width();d=l.height();c={top:l.scrollTop(),left:l.scrollLeft()}}else if(s.preventDefault){n.at="left top";r=d=0;c={top:n.of.pageY,
left:n.of.pageX}}else{r=l.outerWidth();d=l.outerHeight();c=l.offset()}e.each(["my","at"],function(){var p=(n[this]||"").split(" ");if(p.length===1)p=b.test(p[0])?p.concat(["center"]):i.test(p[0])?["center"].concat(p):["center","center"];p[0]=b.test(p[0])?p[0]:"center";p[1]=i.test(p[1])?p[1]:"center";n[this]=p});if(g.length===1)g[1]=g[0];f[0]=parseInt(f[0],10)||0;if(f.length===1)f[1]=f[0];f[1]=parseInt(f[1],10)||0;if(n.at[0]==="right")c.left+=r;else if(n.at[0]==="center")c.left+=r/2;if(n.at[1]==="bottom")c.top+=
d;else if(n.at[1]==="center")c.top+=d/2;c.left+=f[0];c.top+=f[1];return this.each(function(){var p=e(this),h=p.outerWidth(),j=p.outerHeight(),o=parseInt(e.curCSS(this,"marginLeft",true))||0,q=parseInt(e.curCSS(this,"marginTop",true))||0,t=h+o+(parseInt(e.curCSS(this,"marginRight",true))||0),u=j+q+(parseInt(e.curCSS(this,"marginBottom",true))||0),x=e.extend({},c),C;if(n.my[0]==="right")x.left-=h;else if(n.my[0]==="center")x.left-=h/2;if(n.my[1]==="bottom")x.top-=j;else if(n.my[1]==="center")x.top-=
j/2;x.left=Math.round(x.left);x.top=Math.round(x.top);C={left:x.left-o,top:x.top-q};e.each(["left","top"],function(w,A){e.ui.position[g[w]]&&e.ui.position[g[w]][A](x,{targetWidth:r,targetHeight:d,elemWidth:h,elemHeight:j,collisionPosition:C,collisionWidth:t,collisionHeight:u,offset:f,my:n.my,at:n.at})});e.fn.bgiframe&&p.bgiframe();p.offset(e.extend(x,{using:n.using}))})};e.ui.position={fit:{left:function(n,l){var s=e(window);s=l.collisionPosition.left+l.collisionWidth-s.width()-s.scrollLeft();n.left=
s>0?n.left-s:Math.max(n.left-l.collisionPosition.left,n.left)},top:function(n,l){var s=e(window);s=l.collisionPosition.top+l.collisionHeight-s.height()-s.scrollTop();n.top=s>0?n.top-s:Math.max(n.top-l.collisionPosition.top,n.top)}},flip:{left:function(n,l){if(l.at[0]!=="center"){var s=e(window);s=l.collisionPosition.left+l.collisionWidth-s.width()-s.scrollLeft();var g=l.my[0]==="left"?-l.elemWidth:l.my[0]==="right"?l.elemWidth:0,f=l.at[0]==="left"?l.targetWidth:-l.targetWidth,r=-2*l.offset[0];n.left+=
l.collisionPosition.left<0?g+f+r:s>0?g+f+r:0}},top:function(n,l){if(l.at[1]!=="center"){var s=e(window);s=l.collisionPosition.top+l.collisionHeight-s.height()-s.scrollTop();var g=l.my[1]==="top"?-l.elemHeight:l.my[1]==="bottom"?l.elemHeight:0,f=l.at[1]==="top"?l.targetHeight:-l.targetHeight,r=-2*l.offset[1];n.top+=l.collisionPosition.top<0?g+f+r:s>0?g+f+r:0}}}};if(!e.offset.setOffset){e.offset.setOffset=function(n,l){if(/static/.test(e.curCSS(n,"position")))n.style.position="relative";var s=e(n),
g=s.offset(),f=parseInt(e.curCSS(n,"top",true),10)||0,r=parseInt(e.curCSS(n,"left",true),10)||0;g={top:l.top-g.top+f,left:l.left-g.left+r};"using"in l?l.using.call(n,g):s.css(g)};e.fn.offset=function(n){var l=this[0];if(!l||!l.ownerDocument)return null;if(n)return this.each(function(){e.offset.setOffset(this,n)});return m.call(this)}}})(jQuery);
(function(e){e.widget("ui.draggable",e.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper==
"original"&&!/^(?:r|a|f)/.test(this.element.css("position")))this.element[0].style.position="relative";this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(b){var i=
this.options;if(this.helper||i.disabled||e(b.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(b);if(!this.handle)return false;return true},_mouseStart:function(b){var i=this.options;this.helper=this._createHelper(b);this._cacheHelperProportions();if(e.ui.ddmanager)e.ui.ddmanager.current=this;this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-
this.margins.top,left:this.offset.left-this.margins.left};e.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(b);this.originalPageX=b.pageX;this.originalPageY=b.pageY;i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt);i.containment&&this._setContainment();if(this._trigger("start",b)===false){this._clear();return false}this._cacheHelperProportions();
e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,b);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(b,true);return true},_mouseDrag:function(b,i){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");if(!i){var a=this._uiHash();if(this._trigger("drag",b,a)===false){this._mouseUp({});return false}this.position=a.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||
this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";e.ui.ddmanager&&e.ui.ddmanager.drag(this,b);return false},_mouseStop:function(b){var i=false;if(e.ui.ddmanager&&!this.options.dropBehaviour)i=e.ui.ddmanager.drop(this,b);if(this.dropped){i=this.dropped;this.dropped=false}if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return false;if(this.options.revert=="invalid"&&!i||this.options.revert=="valid"&&i||this.options.revert===true||e.isFunction(this.options.revert)&&
this.options.revert.call(this.element,i)){var a=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){a._trigger("stop",b)!==false&&a._clear()})}else this._trigger("stop",b)!==false&&this._clear();return false},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(b){var i=!this.options.handle||!e(this.options.handle,this.element).length?true:false;e(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==
b.target)i=true});return i},_createHelper:function(b){var i=this.options;b=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[b])):i.helper=="clone"?this.element.clone():this.element;b.parents("body").length||b.appendTo(i.appendTo=="parent"?this.element[0].parentNode:i.appendTo);b[0]!=this.element[0]&&!/(fixed|absolute)/.test(b.css("position"))&&b.css("position","absolute");return b},_adjustOffsetFromHelper:function(b){if(typeof b=="string")b=b.split(" ");if(e.isArray(b))b={left:+b[0],top:+b[1]||
0};if("left"in b)this.offset.click.left=b.left+this.margins.left;if("right"in b)this.offset.click.left=this.helperProportions.width-b.right+this.margins.left;if("top"in b)this.offset.click.top=b.top+this.margins.top;if("bottom"in b)this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],
this.offsetParent[0])){b.left+=this.scrollParent.scrollLeft();b.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var b=this.element.position();return{top:b.top-
(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;if(b.containment==
"parent")b.containment=this.helper[0].parentNode;if(b.containment=="document"||b.containment=="window")this.containment=[(b.containment=="document"?0:e(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,(b.containment=="document"?0:e(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,(b.containment=="document"?0:e(window).scrollLeft())+e(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(b.containment=="document"?
0:e(window).scrollTop())+(e(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var i=e(b.containment)[0];if(i){b=e(b.containment).offset();var a=e(i).css("overflow")!="hidden";this.containment=[b.left+(parseInt(e(i).css("borderLeftWidth"),10)||0)+(parseInt(e(i).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(e(i).css("borderTopWidth"),
10)||0)+(parseInt(e(i).css("paddingTop"),10)||0)-this.margins.top,b.left+(a?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e(i).css("borderLeftWidth"),10)||0)-(parseInt(e(i).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(a?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e(i).css("borderTopWidth"),10)||0)-(parseInt(e(i).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}}else if(b.containment.constructor==
Array)this.containment=b.containment},_convertPositionTo:function(b,i){if(!i)i=this.position;var a=b=="absolute"?1:-1,m=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,n=/(html|body)/i.test(m[0].tagName);return{top:i.top+this.offset.relative.top*a+this.offset.parent.top*a-(e.browser.safari&&e.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():
n?0:m.scrollTop())*a),left:i.left+this.offset.relative.left*a+this.offset.parent.left*a-(e.browser.safari&&e.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():n?0:m.scrollLeft())*a)}},_generatePosition:function(b){var i=this.options,a=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,m=/(html|body)/i.test(a[0].tagName),n=b.pageX,l=b.pageY;
if(this.originalPosition){if(this.containment){if(b.pageX-this.offset.click.left<this.containment[0])n=this.containment[0]+this.offset.click.left;if(b.pageY-this.offset.click.top<this.containment[1])l=this.containment[1]+this.offset.click.top;if(b.pageX-this.offset.click.left>this.containment[2])n=this.containment[2]+this.offset.click.left;if(b.pageY-this.offset.click.top>this.containment[3])l=this.containment[3]+this.offset.click.top}if(i.grid){l=this.originalPageY+Math.round((l-this.originalPageY)/
i.grid[1])*i.grid[1];l=this.containment?!(l-this.offset.click.top<this.containment[1]||l-this.offset.click.top>this.containment[3])?l:!(l-this.offset.click.top<this.containment[1])?l-i.grid[1]:l+i.grid[1]:l;n=this.originalPageX+Math.round((n-this.originalPageX)/i.grid[0])*i.grid[0];n=this.containment?!(n-this.offset.click.left<this.containment[0]||n-this.offset.click.left>this.containment[2])?n:!(n-this.offset.click.left<this.containment[0])?n-i.grid[0]:n+i.grid[0]:n}}return{top:l-this.offset.click.top-
this.offset.relative.top-this.offset.parent.top+(e.browser.safari&&e.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():m?0:a.scrollTop()),left:n-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(e.browser.safari&&e.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():m?0:a.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=
this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(b,i,a){a=a||this._uiHash();e.ui.plugin.call(this,b,[i,a]);if(b=="drag")this.positionAbs=this._convertPositionTo("absolute");return e.Widget.prototype._trigger.call(this,b,i,a)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});e.extend(e.ui.draggable,{version:"1.8.10"});e.ui.plugin.add("draggable",
"connectToSortable",{start:function(b,i){var a=e(this).data("draggable"),m=a.options,n=e.extend({},i,{item:a.element});a.sortables=[];e(m.connectToSortable).each(function(){var l=e.data(this,"sortable");if(l&&!l.options.disabled){a.sortables.push({instance:l,shouldRevert:l.options.revert});l._refreshItems();l._trigger("activate",b,n)}})},stop:function(b,i){var a=e(this).data("draggable"),m=e.extend({},i,{item:a.element});e.each(a.sortables,function(){if(this.instance.isOver){this.instance.isOver=
0;a.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert)this.instance.options.revert=true;this.instance._mouseStop(b);this.instance.options.helper=this.instance.options._helper;a.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",b,m)}})},drag:function(b,i){var a=e(this).data("draggable"),m=this;e.each(a.sortables,function(){this.instance.positionAbs=
a.positionAbs;this.instance.helperProportions=a.helperProportions;this.instance.offset.click=a.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=e(m).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return i.helper[0]};b.target=this.instance.currentItem[0];this.instance._mouseCapture(b,
true);this.instance._mouseStart(b,true,true);this.instance.offset.click.top=a.offset.click.top;this.instance.offset.click.left=a.offset.click.left;this.instance.offset.parent.left-=a.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=a.offset.parent.top-this.instance.offset.parent.top;a._trigger("toSortable",b);a.dropped=this.instance.element;a.currentItem=a.element;this.instance.fromOutside=a}this.instance.currentItem&&this.instance._mouseDrag(b)}else if(this.instance.isOver){this.instance.isOver=
0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",b,this.instance._uiHash(this.instance));this.instance._mouseStop(b,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();this.instance.placeholder&&this.instance.placeholder.remove();a._trigger("fromSortable",b);a.dropped=false}})}});e.ui.plugin.add("draggable","cursor",{start:function(){var b=e("body"),i=e(this).data("draggable").options;if(b.css("cursor"))i._cursor=
b.css("cursor");b.css("cursor",i.cursor)},stop:function(){var b=e(this).data("draggable").options;b._cursor&&e("body").css("cursor",b._cursor)}});e.ui.plugin.add("draggable","iframeFix",{start:function(){var b=e(this).data("draggable").options;e(b.iframeFix===true?"iframe":b.iframeFix).each(function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(e(this).offset()).appendTo("body")})},
stop:function(){e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});e.ui.plugin.add("draggable","opacity",{start:function(b,i){var a=e(i.helper),m=e(this).data("draggable").options;if(a.css("opacity"))m._opacity=a.css("opacity");a.css("opacity",m.opacity)},stop:function(b,i){var a=e(this).data("draggable").options;a._opacity&&e(i.helper).css("opacity",a._opacity)}});e.ui.plugin.add("draggable","scroll",{start:function(){var b=e(this).data("draggable");if(b.scrollParent[0]!=
document&&b.scrollParent[0].tagName!="HTML")b.overflowOffset=b.scrollParent.offset()},drag:function(b){var i=e(this).data("draggable"),a=i.options,m=false;if(i.scrollParent[0]!=document&&i.scrollParent[0].tagName!="HTML"){if(!a.axis||a.axis!="x")if(i.overflowOffset.top+i.scrollParent[0].offsetHeight-b.pageY<a.scrollSensitivity)i.scrollParent[0].scrollTop=m=i.scrollParent[0].scrollTop+a.scrollSpeed;else if(b.pageY-i.overflowOffset.top<a.scrollSensitivity)i.scrollParent[0].scrollTop=m=i.scrollParent[0].scrollTop-
a.scrollSpeed;if(!a.axis||a.axis!="y")if(i.overflowOffset.left+i.scrollParent[0].offsetWidth-b.pageX<a.scrollSensitivity)i.scrollParent[0].scrollLeft=m=i.scrollParent[0].scrollLeft+a.scrollSpeed;else if(b.pageX-i.overflowOffset.left<a.scrollSensitivity)i.scrollParent[0].scrollLeft=m=i.scrollParent[0].scrollLeft-a.scrollSpeed}else{if(!a.axis||a.axis!="x")if(b.pageY-e(document).scrollTop()<a.scrollSensitivity)m=e(document).scrollTop(e(document).scrollTop()-a.scrollSpeed);else if(e(window).height()-
(b.pageY-e(document).scrollTop())<a.scrollSensitivity)m=e(document).scrollTop(e(document).scrollTop()+a.scrollSpeed);if(!a.axis||a.axis!="y")if(b.pageX-e(document).scrollLeft()<a.scrollSensitivity)m=e(document).scrollLeft(e(document).scrollLeft()-a.scrollSpeed);else if(e(window).width()-(b.pageX-e(document).scrollLeft())<a.scrollSensitivity)m=e(document).scrollLeft(e(document).scrollLeft()+a.scrollSpeed)}m!==false&&e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,b)}});e.ui.plugin.add("draggable",
"snap",{start:function(){var b=e(this).data("draggable"),i=b.options;b.snapElements=[];e(i.snap.constructor!=String?i.snap.items||":data(draggable)":i.snap).each(function(){var a=e(this),m=a.offset();this!=b.element[0]&&b.snapElements.push({item:this,width:a.outerWidth(),height:a.outerHeight(),top:m.top,left:m.left})})},drag:function(b,i){for(var a=e(this).data("draggable"),m=a.options,n=m.snapTolerance,l=i.offset.left,s=l+a.helperProportions.width,g=i.offset.top,f=g+a.helperProportions.height,r=
a.snapElements.length-1;r>=0;r--){var d=a.snapElements[r].left,c=d+a.snapElements[r].width,p=a.snapElements[r].top,h=p+a.snapElements[r].height;if(d-n<l&&l<c+n&&p-n<g&&g<h+n||d-n<l&&l<c+n&&p-n<f&&f<h+n||d-n<s&&s<c+n&&p-n<g&&g<h+n||d-n<s&&s<c+n&&p-n<f&&f<h+n){if(m.snapMode!="inner"){var j=Math.abs(p-f)<=n,o=Math.abs(h-g)<=n,q=Math.abs(d-s)<=n,t=Math.abs(c-l)<=n;if(j)i.position.top=a._convertPositionTo("relative",{top:p-a.helperProportions.height,left:0}).top-a.margins.top;if(o)i.position.top=a._convertPositionTo("relative",
{top:h,left:0}).top-a.margins.top;if(q)i.position.left=a._convertPositionTo("relative",{top:0,left:d-a.helperProportions.width}).left-a.margins.left;if(t)i.position.left=a._convertPositionTo("relative",{top:0,left:c}).left-a.margins.left}var u=j||o||q||t;if(m.snapMode!="outer"){j=Math.abs(p-g)<=n;o=Math.abs(h-f)<=n;q=Math.abs(d-l)<=n;t=Math.abs(c-s)<=n;if(j)i.position.top=a._convertPositionTo("relative",{top:p,left:0}).top-a.margins.top;if(o)i.position.top=a._convertPositionTo("relative",{top:h-a.helperProportions.height,
left:0}).top-a.margins.top;if(q)i.position.left=a._convertPositionTo("relative",{top:0,left:d}).left-a.margins.left;if(t)i.position.left=a._convertPositionTo("relative",{top:0,left:c-a.helperProportions.width}).left-a.margins.left}if(!a.snapElements[r].snapping&&(j||o||q||t||u))a.options.snap.snap&&a.options.snap.snap.call(a.element,b,e.extend(a._uiHash(),{snapItem:a.snapElements[r].item}));a.snapElements[r].snapping=j||o||q||t||u}else{a.snapElements[r].snapping&&a.options.snap.release&&a.options.snap.release.call(a.element,
b,e.extend(a._uiHash(),{snapItem:a.snapElements[r].item}));a.snapElements[r].snapping=false}}}});e.ui.plugin.add("draggable","stack",{start:function(){var b=e(this).data("draggable").options;b=e.makeArray(e(b.stack)).sort(function(a,m){return(parseInt(e(a).css("zIndex"),10)||0)-(parseInt(e(m).css("zIndex"),10)||0)});if(b.length){var i=parseInt(b[0].style.zIndex)||0;e(b).each(function(a){this.style.zIndex=i+a});this[0].style.zIndex=i+b.length}}});e.ui.plugin.add("draggable","zIndex",{start:function(b,
i){var a=e(i.helper),m=e(this).data("draggable").options;if(a.css("zIndex"))m._zIndex=a.css("zIndex");a.css("zIndex",m.zIndex)},stop:function(b,i){var a=e(this).data("draggable").options;a._zIndex&&e(i.helper).css("zIndex",a._zIndex)}})})(jQuery);
shortcut={all_shortcuts:{},add:function(e,b,i){var a={type:"keydown",propagate:false,disable_in_input:false,target:document,keycode:false};if(i)for(var m in a){if(typeof i[m]=="undefined")i[m]=a[m]}else i=a;a=i.target;if(typeof i.target=="string")a=document.getElementById(i.target);e=e.toLowerCase();m=function(n){n=n||window.event;if(i.disable_in_input){var l;if(n.target)l=n.target;else if(n.srcElement)l=n.srcElement;if(l.nodeType==3)l=l.parentNode;if(l.tagName=="INPUT"||l.tagName=="TEXTAREA")return}if(n.keyCode)code=
n.keyCode;else if(n.which)code=n.which;l=String.fromCharCode(code).toLowerCase();if(code==188)l=",";if(code==190)l=".";var s=e.split("-"),g=0,f={"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},r={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,
home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},d={shift:{wanted:false,pressed:false},ctrl:{wanted:false,pressed:false},alt:{wanted:false,pressed:false},meta:{wanted:false,pressed:false}};if(n.ctrlKey)d.ctrl.pressed=true;if(n.shiftKey)d.shift.pressed=true;if(n.altKey)d.alt.pressed=true;if(n.metaKey)d.meta.pressed=true;for(var c=0;k=s[c],c<s.length;c++)if(k==
"ctrl"||k=="control"){g++;d.ctrl.wanted=true}else if(k=="shift"){g++;d.shift.wanted=true}else if(k=="alt"){g++;d.alt.wanted=true}else if(k=="meta"){g++;d.meta.wanted=true}else if(k.length>1)r[k]==code&&g++;else if(i.keycode)i.keycode==code&&g++;else if(l==k)g++;else if(f[l]&&n.shiftKey){l=f[l];l==k&&g++}if(g==s.length&&d.ctrl.pressed==d.ctrl.wanted&&d.shift.pressed==d.shift.wanted&&d.alt.pressed==d.alt.wanted&&d.meta.pressed==d.meta.wanted){b(n);if(!i.propagate){n.cancelBubble=true;n.returnValue=
false;if(n.stopPropagation){n.stopPropagation();n.preventDefault()}return false}}};this.all_shortcuts[e]={callback:m,target:a,event:i.type};if(a.addEventListener)a.addEventListener(i.type,m,false);else if(a.attachEvent)a.attachEvent("on"+i.type,m);else a["on"+i.type]=m},remove:function(e){e=e.toLowerCase();var b=this.all_shortcuts[e];delete this.all_shortcuts[e];if(b){e=b.event;var i=b.target;b=b.callback;if(i.detachEvent)i.detachEvent("on"+e,b);else if(i.removeEventListener)i.removeEventListener(e,
b,false);else i["on"+e]=false}}};var assert={};assert.critical=function(e,b){if(!e){if(typeof mjt!=="undefined"&&mjt.error)mjt.error("Internal Error: "+b);else typeof console!=="undefined"&&console.error&&console.error("Internal Error: "+b);if(!document.getElementById("error-dialog")){var i="";i+='<div style="font-weight:bold;">Internal Error</div>';i+=b;assert.error_dialog(i)}}};
assert.error_dialog=function(e){var b=document.createElement("div");b.style.cssText="position: absolute; top: 30px; left: 50%; width: 350px; margin: 0 0 0 -175px; padding: 15px; background-color: #fce2db; border: 1px solid #f3c5ac; color: #676767; font-size: 12px; z-index: 100;";b.innerHTML='<div id="error-dialog" style="float:right; color: #1170a3; margin: -10px -5px 0 0; cursor: pointer;" onclick="document.body.removeChild(this.parentNode);">x</div>'+e;document.body.appendChild(b)};
var unicode={};unicode.escape_char=function(e){e=e.charCodeAt(0).toString(16).toUpperCase();if(e.length===1)return"\\u000"+e;if(e.length===2)return"\\u00"+e;if(e.length===3)return"\\u0"+e;if(e.length===4)return"\\u"+e;return null};unicode.escape_str=function(e){return e.replace(/[^\u0020-\u007F]/g,unicode.escape_char)};
var zen=function(){function e(g,f){if(!g||!g.length)return"";var r=g.shift().split("+"),d=r.length-1,c=e(g,f+1);return r.map(function(p,h){var j=h===d?c:"";s.newTag();var o=p.replace(i,s.tag).replace(a,s.id).replace(m,s.className).replace(n,s.attr).replace(l,s.mult);if(o.length&&!b.length)b=o;return s.html(j,f)}).join("\n")}var b="",i=/^[\w:]+/,a=/^\#[:\w\$]+/,m=/^(\.[\w\$]+)+/,n=/^\[.+\]/,l=/^\*\d+/,s=function(){var g=function(r){return(new Array(r+1)).join("  ")},f;return{newTag:function(){return f=
{tagName:"div"}},tag:function(r){f.tagName=r;return""},id:function(r){f.id=r.slice(1);return""},className:function(r){f.className=r.slice(1).replace(/\./g," ");return""},attr:function(r){f.attrs=r.slice(1,-1);return""},mult:function(r){f.multiplier=parseInt(r.slice(1),10);return""},html:function(r,d){for(var c="<"+f.tagName+(f.id?' id="'+f.id+'"':"")+(f.className?' class="'+f.className+'"':"")+(f.attrs?" "+f.attrs:"")+">"+(r?"\n"+r+"\n"+g(d):"")+"</"+f.tagName+">",p=[],h=0,j=f.multiplier||1;h<j;h++)p[h]=
c.replace(/\$/g,h+1);return g(d)+p.join("\n"+g(d))}}}();return{convert:function(g,f){b="";var r=g.split("|"),d=r[0].split(">");r=r[1];d=e(d,f||0);if(r)if(r==="e")d=d.replace(/</g,"&lt;").replace(/>/g,"&gt;");else b="Unknown filter "+r;if(/^[\.\#\[\*]$/.test(b))b="";return{out:d,error:b}}}}(),FreebaseStore;
(function(){function e(i){var a=mjt.define_task(mjt.freebase.FreebaseJsonPTask,[{name:"service"},{name:"args"}]);a.prototype.request=function(){return this.service_request(i.get_service_path()+this.service,this.args)};a.prototype.response=function(g){return this.ready(g.result)};var m=mjt.define_task(mjt.freebase.FreebaseXhrTask,[{name:"service"},{name:"args"}]);m.prototype.request=function(){var g=i.get_service_path()+this.service;if(this.args)g+="?"+mjt.formencode(this.args);return this.xhr_request("GET",
g).onready(function(f){if(f.csrf_token){i.set_csrf_token(f.csrf_token);delete f.csrf_token}})};var n=mjt.define_task(mjt.freebase.FreebaseXhrTask,[{name:"service"},{name:"args"}]);n.prototype.request=function(){this.args.ACRE_CSRF_TOKEN=i.get_csrf_token();return this.xhr_form_post(i.get_service_path()+this.service,this.args)};var l=mjt.define_task(null,[{name:"service"},{name:"form"},{name:"args"}]);l.prototype.dynamic_iframe=function(g){var f=document.createElement("iframe");if(typeof g==="string"){f.id=
g;f.name=g}f.style.display="none";f.className="mjt_dynamic";return f};l.prototype.request=function(){function g(){var h=r.contentWindow||r.contentDocument;if(h.document)return h.document;return h}function f(){window.setTimeout(function(){$(r).remove()},1)}this.domid=mjt.uniqueid("mjt_iframe");var r=this.dynamic_iframe(this.domid);$("body").append(r);var d=this.form,c=this,p=window.setTimeout(function(){c.error("timeout","Upload timed out - no response from server.");f()},3E4);r.onload=function(){window.clearTimeout(p);
var h=$(g(r).body).text();h=JSON.parse(h);if(h.code==="/api/status/ok"){c.result=h.result;c.ready(c.result)}else c.error(h.code,h.messages[0].message);f()};this.args.ACRE_CSRF_TOKEN=i.get_csrf_token();d.attr({target:this.domid,action:mjt.form_url(i.get_service_path()+this.service,this.args),method:"POST",enctype:"multipart/form-data"}).submit()};var s=mjt.define_task(mjt.freebase.FreebaseJsonPTask,[{name:"service_url","default":null}]);s.prototype.request=function(){this.jsonp.cache_controller={is_fresh:function(){return false}};
return this.service_request("/acre/touch?_="+ +new Date)};s.prototype.response=function(){return this.ready(null)};i.Jsonp=a;i.XhrGet=m;i.XhrPost=n;i.FileUpload=l;i.AppTouch=s}FreebaseStore=function(i,a){this._url=i||fb.acre.freebase.service_url;this._site_url=fb.acre.freebase.site_host;this._acre_server=a||fb.acre.host.name+(fb.acre.host.port===80?"":":"+fb.acre.host.port);this._handlers=[];this._user=null;return this};FreebaseStore.prototype.set_user=function(i){if(i){this._user=new AcreUser(this,
i);if(i.apps)this._user_apps=i.apps;mjt.freebase.freebase_user={name:i.name,id:"/user/"+i.name}}else{this._user_apps=this._user=null;mjt.freebase.freebase_user=null}};FreebaseStore.prototype.set_csrf_token=function(i){this._csrf_token=i};FreebaseStore.prototype.t_init=function(){var i=this;i._service_path=fb.acre.appeditor.service_path;e(i);mjt.app=new mjt.App;mjt.freebase.service_url=window.location.protocol+"//"+window.location.host;mjt.freebase.xhr_ok=true;return this.XhrGet("init_store").onready(function(a){i._csrf_token=
a.csrf_token;i._acre_server=a.host.name+(a.host.port===80?"":":"+a.host.port);i._handlers=a.acre_handlers;i._version=a.version;i.set_user(a.user)}).enqueue()};FreebaseStore.prototype.destroy=function(){};var b=mjt.define_task(null,[{name:"store"}]);b.prototype.request=function(){this.url=window.location.protocol+fb.acre.apps.appeditor+"."+this.store.get_acre_host()+"/services/check_thirdparty_cookies";var i=this;this.jsonp=mjt.JsonP();this.jsonp.set_timeout().jsonp_request_form(this.url,null,"callback").onready(function(a){a.result===
"success"?i.ready():i.error()}).onerror("error",i)};FreebaseStore.prototype.TestCookies=b;FreebaseStore.prototype.get_service_path=function(){return this._service_path};FreebaseStore.prototype.get_acre_version=function(){return this._version};FreebaseStore.prototype.get_user=function(){return this._user};FreebaseStore.prototype.get_csrf_token=function(){return this._csrf_token};FreebaseStore.prototype.get_user_apps=function(i){if(i){for(var a=0;a<this._user_apps.length;a++)if(this._user_apps[a].appid==
i)return this._user_apps[a].appid;return null}else return this._user_apps};FreebaseStore.prototype.set_user_apps=function(i){this._user_apps=i};FreebaseStore.prototype.t_refresh_user_apps=function(){var i=this;i.XhrGet("list_user_apps").enqueue().onready(function(a){i._user_apps=a})};FreebaseStore.prototype.get_url=function(){return this._url};FreebaseStore.prototype.get_service_path=function(){return this._service_path};FreebaseStore.prototype.get_name=function(){var i=this._name?this._name:"???";
if(i==="OTG")i="";return i};FreebaseStore.prototype.get_acre_handlers=function(){return this._handlers};FreebaseStore.prototype.get_acre_host=function(){return this._acre_server};FreebaseStore.prototype.get_freebase_url=function(){return this._site_url};FreebaseStore.prototype.get_user_new_app_path=function(i,a){return"//"+a+"."+i.get_name()+".user.dev"};FreebaseStore.prototype.get_user_default_app_host=function(i){return i.get_name()+".user.dev."+this.get_acre_host()};FreebaseStore.prototype.get_user_view_url=
function(i){return this.get_freebase_url()+"/user/"+i.get_name()};FreebaseStore.prototype.get_user_image_url=function(i){return this.get_url()+"/api/trans/image_thumb/user/"+i.get_name()+"?maxwidth=30&maxheight=30&mode=fillcrop"};FreebaseStore.prototype.validate_filename=function(i){if(!/^[A-Za-z][\-_0-9A-Za-z\.\/]+$/.test(i))return false;if(i in{acre:true,status:"",api:true})return false;return true};mjt.label_package("FreebaseStore")})();var AcreDoc;
(function(){AcreDoc=function(e,b,i,a){assert.critical(e,"Must specify app when creating a file");this._app=e;this._name=b&&this._app.get_store().validate_filename(b)?b:this._app.get_untitled_file_name();this._acre_handler=i.handler;this._mime_type=i.media_type||"text/plain";this._revision=i.content_id||null;this._based_on=i.based_on||null;this._has_been_saved=i.has_been_saved||false;this._dom_element=document.createElement("div");this._dom_element.className="file";this._event_handlers={};this._initial_state=
a||null;e=!this.has_been_saved();this._dirty_state={name:e,content:e,metadata:e,to_delete:false,revision:false,editor:false};this._loaded_editors={};this._current_editor=null;this._app.register_file(this);return this};AcreDoc.prototype.t_get_history=function(){var e={fileid:this.get_fileid()};return this.get_store().XhrGet("get_file_history",e).enqueue()};AcreDoc.prototype.t_get_revision=function(e){var b={fileid:this.get_fileid()};if(this.get_app().get_repository_capability("versioned")){b.revision=
e||this.get_revision();return b.revision?this.get_store().XhrGet("get_file_revision",b):mjt.Succeed({text:""})}else return this.get_store().XhrGet("get_file_revision",b)};AcreDoc.prototype.hide=function(){this._current_editor&&this._current_editor.hide();$(this._dom_element).hide()};AcreDoc.prototype.destroy=function(){for(var e in this._loaded_editors){var b=this._loaded_editors[e];b.destroy&&b.destroy()}$(this._dom_element).remove()};AcreDoc.prototype.is_writable=function(){return this.get_app().is_writable()};
AcreDoc.prototype.has_been_saved=function(){return!!this._has_been_saved};AcreDoc.prototype.is_dirty=function(e){if(e)return this._dirty_state[e];else for(var b in this._dirty_state)if(this._dirty_state[b]===true)return true;return false};AcreDoc.prototype.get_element=function(){return this._dom_element};AcreDoc.prototype.get_store=function(){return this.get_app().get_store()};AcreDoc.prototype.get_app=function(){return this._app};AcreDoc.prototype.get_name=function(){return this._name};AcreDoc.prototype.get_fileid=
function(){var e=this._old_name||this._name;return this.get_app().get_path()+"/"+e};AcreDoc.prototype.get_relative_path=function(){return this.get_name()};AcreDoc.prototype.get_revision=function(){return this._revision};AcreDoc.prototype.get_acre_handler=function(){if(this._acre_handler)return this._acre_handler;return this.get_app().get_extension_metadata(this._name).handler||"acre_script"};AcreDoc.prototype.get_mime_type=function(){return this.get_app().get_extension_metadata(this._name).media_type||
this._mime_type};AcreDoc.prototype.is_library=function(){return this._library};AcreDoc.prototype.get_based_on=function(){return this._based_on};AcreDoc.prototype.get_acre_url=function(e){return this.get_app().get_base_url()+"/"+this.get_name()+(e?"?acre.console=1":"")};AcreDoc.prototype.set_name=function(e){if(e!==this.get_name()){if(!/^[\-_0-9A-Za-z\.]+$/.test(e))throw"File names can only contain alphanumeric characters, ., - and _";if(!/^[A-Za-z]/.test(e))throw"File names must be begin with a letter";
if(!/[0-9A-Za-z]$/.test(e))throw"File names cannot end with a special character";this._old_name=this.get_name();this.get_app().unregister_file(this._old_name);this._name=e;this.get_app().register_file(this);this.set_dirty("name")}};AcreDoc.prototype.set_acre_handler=function(e){if(e!==this._acre_handler){this._acre_handler=e;this.set_dirty("metadata");this.set_dirty("editor")}};AcreDoc.prototype.set_mime_type=function(e){if(e!==this._mime_type){this._mime_type=e;this.set_dirty("content");this.set_dirty("editor")}};
AcreDoc.prototype.set_revision=function(e){if(this.is_dirty("content")||e!==this._revision){this._revision=e;this.set_dirty("revision");this.set_dirty("editor")}this.set_dirty("content",false);this.set_dirty("to_delete",false)};AcreDoc.prototype.set_dirty=function(e,b){var i=e||"content",a=typeof b=="undefined"?true:b;if(i==="all")for(var m in this._dirty_state)this._dirty_state[m]=a;else this._dirty_state[i]=a};AcreDoc.prototype.t_save=function(e){var b=this;if(b.is_dirty("to_delete"))return b.t_delete();
var i={fileid:b.get_fileid()},a=b.get_store().XhrPost("save_text_file",i);if(!b.has_been_saved()&&b.get_based_on())i.based_on=b.get_based_on().id;if(b.is_dirty("name"))i.name=b.get_name();if(b.is_dirty("metadata")||!b.has_been_saved()){var m=b.get_acre_handler();if(m)i.acre_handler=m}if(!e&&b.get_revision()&&!(b.is_dirty("content")&&b.is_dirty("revision")))i.revision=b.get_revision();if(b.is_dirty("content")){e=b.get_editor_state();if(e.form)a=b.get_store().FileUpload("save_binary_file",e.form,i);
else{i.text=e.text;i.content_type=b.get_mime_type()}}else if(b.is_dirty("revision"))a=b.get_store().XhrPost("set_file_revision",i);a.onready(function(n){if(n.content_id)b._revision=n.content_id;if(n.content_type)b._mime_type=n.content_type;delete b._old_name;b._has_been_saved=true;b.set_dirty("all",false);b._current_editor&&typeof b._current_editor.refresh==="function"&&b._current_editor.refresh()}).onerror(function(n,l,s){if(n==="/api/status/error/file_format/unsupported_mime_type"){delete b._old_name;
b._has_been_saved=true;b.set_dirty("all",false)}else mjt.warn("Save of",b.get_name(),"failed: ",n," - ",l,s)});return this.get_app().t_flush_cache().require(a).enqueue()};AcreDoc.prototype.t_delete=function(){function e(){b.get_app().unregister_file(b.get_name());b.destroy()}var b=this,i={appid:b.get_app().get_path(),name:b.get_name()};if(!b.has_been_saved())return mjt.Succeed().enqueue().onready(e);i=b.get_store().XhrPost("delete_app_file",i).onready(e).onerror(function(a,m,n){mjt.warn("Delete of",
b.get_name(),"failed: ",a," - ",m,n)});return this.get_app().t_flush_cache().require(i).enqueue()};AcreDoc.prototype.t_revert_to_saved=function(){var e=this,b={fileid:e.get_fileid()};return e.get_store().XhrGet("get_file",b).onready(function(i){e.set_name(i.name);e.set_acre_handler(i.handler);e.set_mime_type(i.content_type);e.set_revision(i.content_id);e.set_dirty("all",false);e.clear_editors()}).onerror(function(i,a,m){mjt.warn("Rever of",e.get_name(),"failed: ",i," - ",a,m)}).enqueue()};AcreDoc.prototype.is_editor_loaded=
function(e){var b=false;if(e)b=this._loaded_editors[e]?true:false;else for(var i in this._loaded_editors){b=true;break}return b};AcreDoc.prototype.clear_editors=function(e){function b(m){var n=i._loaded_editors[m];n.destroy&&n.destroy();delete i._loaded_editors[m]}var i=this;if(e){if(i.get_edtior_name()===e)i._current_editor=null;b(e)}else{i._current_editor=null;for(var a in i._loaded_editors)b(a)}};AcreDoc.prototype.get_editor_name=function(){for(var e in EDITORS)if(this._current_editor&&this._current_editor instanceof
EDITORS[e].editor_class)return e;return false};AcreDoc.prototype.t_editor_show=function(e,b,i){var a=this;if(a._showing_editor)return mjt.Succeed().enqueue();a._showing_editor=true;var m=null;if(i){m=i;a.set_dirty("content")}else if(a.is_dirty("revision"))m=null;else if(a._current_editor)m=a.get_editor_state();else if(a._initial_state){m=a._initial_state;a._initial_state=null}if(a.is_dirty("editor")){a.clear_editors();a.set_dirty("editor",false)}i=EDITORS[e].editor_class;a._current_editor&&!(a._current_editor instanceof
i)&&a._current_editor.hide();if(typeof a._loaded_editors[e]!=="undefined"){a._current_editor=a._loaded_editors[e];a.is_dirty("content")&&m&&a.set_editor_state(m);a._current_editor.show(b);a._showing_editor=false;return mjt.Succeed().enqueue()}return i.t_load(a,m).onready(function(n){a._loaded_editors[e]=n;a._current_editor=a._loaded_editors[e];a._current_editor.show(b);a._showing_editor=false}).onerror(function(n,l,s){mjt.warn("Loading of",a.get_name(),"failed: ",n," - ",l,s)}).enqueue()};AcreDoc.prototype.get_editor_state=
function(){var e=null;if(this._current_editor)e=this._current_editor.get_state();else if(this._initial_state)e=this._initial_state;return e};AcreDoc.prototype.set_editor_state=function(e){assert.critical(e,"Trying to set undefined editor state");this._current_editor&&this._current_editor.set_state(e)};AcreDoc.prototype.get_editor_supported_features=function(e){if(!this.get_editor_name())return false;var b=EDITORS[this.get_editor_name()].supports;return e?!!b[e]:b};AcreDoc.prototype.register_editor_event_handlers=
function(e){for(var b in e)this._event_handlers[b]=e[b]};AcreDoc.prototype.trigger_editor_event=function(e,b){if(e==="change"){var i=b[0];if(typeof i!=="number")this.set_dirty("content");else if(i>0){this.set_dirty("content");this.set_dirty("revision",false)}else this.set_dirty("content",false)}this._event_handlers[e]&&this._event_handlers[e].apply(this,b)};AcreDoc.prototype.editor_undo=function(){this._current_editor&&this._current_editor.undo&&this._current_editor.undo()};AcreDoc.prototype.editor_redo=
function(){this._current_editor&&this._current_editor.redo&&this._current_editor.redo()};AcreDoc.prototype.editor_indent=function(){this._current_editor&&this._current_editor.reindentSelection&&this._current_editor.reindentSelection()};AcreDoc.prototype.editor_goto_line=function(e){this._current_editor&&this._current_editor.goto_line&&this._current_editor.goto_line(Number(e))}})();var AcreApp;
(function(){AcreApp=function(e,b){this._store=e;this._acre_host=e.get_acre_host();this._service_url=e.get_url();this._path=b;this._version=null;this._name="Untitled";this._release=this._listed=this._write_user=this._oauth_enabled=null;this._hosts=[];this._versions=[];this._handlers=$.extend(true,{},e.get_acre_handlers());this._extensions={};this._authors={};this._files={};this._untitled_label="untitled_";this._untitled_counter=1;return this};AcreApp.prototype.t_load=function(){var e=this;return e._store.XhrGet("get_app",
{appid:e._path}).onready(function(b){e._acre_host=b.acre_host;e._remote_app=b.acre_host!==e.get_store().get_acre_host();e._repository=b.repository||{versioned:true};e._path=b.path;e._appid=b.id;e._version=b.version;e._name=b.name||"Untitled";e._oauth_enabled=b.oauth_enabled;e._write_user=b.write_user;e._parent=b.parent;e._children=b.children;e._listed=b.listed;e._release=b.release;e._hosts=b.hosts;e._versions=b.all_versions||[];e._last_edit=null;e._initial_file=b.current_file;e._extensions=b.extensions;
for(var i in b.handlers)e._handlers[i]=e._handlers[i]||{key:i,name:i,plural_name:i,description:"",supported_mime_types:["text/plain"]};for(var a in b.authors){i=b.authors[a];e._authors[i.name]=new AcreUser(e.get_store(),i)}for(var m in b.files){a=b.files[m];a.has_been_saved=true;new AcreDoc(e,a.name,a)}e.is_writable()&&!e._write_user&&e._oauth_enabled===null&&e.t_set_oauth(true)}).enqueue()};AcreApp.prototype.t_flush_cache=function(e){var b=this.get_store().AppTouch(this.get_base_url());if(e){e=this.get_hosts();
for(var i=0;i<e.length;i++)this.get_store().AppTouch("http://"+e[i].host).enqueue()}return b};AcreApp.prototype.destroy=function(){for(var e in this._files)this._files[e].destroy();for(var b in this._authors)this._authors[b].destroy()};AcreApp.prototype.register_file=function(e){var b=(new RegExp(this._untitled_label+"(\\d+)")).exec(e.get_name());if(b&&b.length){b=parseInt(b[1],10);if(this._untitled_counter<=b)this._untitled_counter=b+1}this._files[e.get_name()]=e};AcreApp.prototype.unregister_file=
function(e){delete this._files[e]};AcreApp.prototype.is_dirty=function(){var e=this.get_files();for(var b in e)if(e[b].is_dirty())return true;return false};AcreApp.prototype.get_store=function(){return this._store};AcreApp.prototype.get_repository_capability=function(e){return!!this._repository[e]};AcreApp.prototype.get_path=function(){return this.get_acre_host()===this.get_store().get_acre_host()?this._path:this._path+"."+this._acre_host+"."};AcreApp.prototype.get_versioned_path=function(){var e=
this.get_path();if(this.is_version())e=e.replace("//","//"+this._version+".");return e};AcreApp.prototype.get_name=function(){return this._path.split("//")[1].split(".").shift()};AcreApp.prototype.get_display_name=function(){return this._name};AcreApp.prototype.get_parent=function(){return this._parent};AcreApp.prototype.get_children=function(){return this._children};AcreApp.prototype.get_released_version=function(){return this._release};AcreApp.prototype.get_versions=function(){return this._versions};
AcreApp.prototype.get_patches=function(){return this._patches};AcreApp.prototype.get_hosts=function(){return this._hosts};AcreApp.prototype.get_extension_metadata=function(e){e=e.split(".");for(e.shift();e.length;){var b=e.join("."),i={};if(b&&this._extensions&&this._extensions[b]){i=this._extensions[b];break}e.shift()}return i||{}};AcreApp.prototype.get_acre_handlers=function(){return this._handlers};AcreApp.prototype.get_supported_mime_types=function(e){return this._handlers[e].supported_mime_types};
AcreApp.prototype.get_files=function(){return this._files};AcreApp.prototype.get_file=function(e){if(e)return this._files[e];if(this._initial_file&&this._files[this._initial_file]){e=this._files[this._initial_file];this._initial_file=null;return e}else if(this._files.index)return this._files.index;else{var b=this.get_files();for(var i in b)if(e=b[i])return e}return null};AcreApp.prototype.get_untitled_file_name=function(){return this._untitled_label+this._untitled_counter};AcreApp.prototype.get_acre_host=
function(){return this._acre_host};AcreApp.prototype.get_base_url=function(){return"http:"+this.get_versioned_path()+"."+this.get_acre_host()};AcreApp.prototype.get_view_url=function(){return this._repository.url+"/apps"+this._appid};AcreApp.prototype.get_edit_url=function(){return this._repository.url+"/apps/admin"+this._appid};AcreApp.prototype.is_version=function(){return!!this._version};AcreApp.prototype.get_version_label=function(){return this._version};AcreApp.prototype.get_version_timestamp=
function(e){e=e?e:this._version;for(var b=0;b<this._versions.length;b++){var i=this._versions[b];if(i.name==e)return i.as_of_time}return null};AcreApp.prototype.t_save_all=function(){var e=mjt.Succeed();for(var b in this._files){var i=this._files[b];i.is_dirty()&&e.require(i.t_save())}return this.t_flush_cache().require(e).enqueue()};AcreApp.prototype.t_get_history=function(e){var b={appid:this.get_path()};if(e)b.limit=e;return this.get_store().XhrGet("get_app_history",b).enqueue()};AcreApp.prototype.get_last_change=
function(){return this._last_edit};AcreApp.prototype.set_last_change=function(e){this._last_edit=e};AcreApp.prototype.t_set_listing=function(e,b,i){var a=this,m={appid:a.get_path()};if(e)m.name=e;if(e)m.description=b;if(e)m.listed=i;return a.get_store().XhrPost("set_app_properties",m).onready(function(){if(e)a._display_name=e}).onerror(function(n,l,s){mjt.warn("Changing app listing of",a.get_name(),"failed: ",n," - ",l,s)}).enqueue()};AcreApp.prototype.t_move=function(e){var b=this,i={appid:b.get_path(),
to_appid:e};return b.get_store().XhrPost("move_app",i).onready(function(){b._path=e;b.t_flush_cache().enqueue()}).onerror(function(a,m,n){mjt.warn("Move of",b.get_display_name(),"failed: ",a," - ",m,n)}).enqueue()};AcreApp.prototype.t_delete=function(){var e=this,b={appid:e.get_path()};return this.get_store().XhrPost("delete_app",b).enqueue().onready(function(){e.destroy()}).onerror(function(i,a,m){mjt.warn("Failed to delete app: "+i+", "+a+", "+m)})};AcreApp.prototype.t_set_host=function(e){var b=
this;e={appid:b.get_path(),host:e};return b.get_store().XhrPost("set_app_host",e).onready(function(i){b._hosts=i.hosts;if(i.listed)b._listed=true;b.t_flush_cache(true).enqueue()}).onerror(function(i,a,m){mjt.warn("Setting release URL of",b.get_display_name(),"failed: ",i," - ",a,m)}).enqueue()};AcreApp.prototype.t_set_release=function(e){var b=this;e={appid:b.get_path(),version:e};return b.get_store().XhrPost("set_app_release",e).onready(function(i){b._hosts=i.hosts;b._versions=i.versions;b._release=
i.release;b.t_flush_cache(true).enqueue()}).onerror(function(i,a,m){mjt.warn("Setting release of",b.get_display_name(),"failed: ",i," - ",a,m)}).enqueue()};AcreApp.prototype.t_add_version=function(e,b,i){var a=this;e={appid:a.get_path(),version:e};if(b)e.timestamp=b;if(typeof i!=="undefined")e.service_url=i;return this.get_store().XhrPost("create_app_version",e).onready(function(m){a._versions=m.versions}).onerror(function(m,n,l){mjt.warn("Failed to add version: "+m+", "+n+", "+l)}).enqueue()};AcreApp.prototype.t_remove_version=
function(e){var b=this;e={appid:b.get_path(),version:e};return this.get_store().XhrPost("delete_app_version",e).onready(function(i){b._versions=i.versions}).onerror(function(i,a,m){mjt.warn("Failed to remove version: "+i+", "+a+", "+m)}).enqueue()};AcreApp.prototype.is_remote=function(){return this._remote_app};AcreApp.prototype.is_writable=function(){return this.is_author()&&!this.is_version()&&!this.is_remote()};AcreApp.prototype.is_author=function(){return this.get_store().get_user()?this.get_store().get_user().get_name()in
this.get_authors():false};AcreApp.prototype.is_oauth_enabled=function(){return!!this._oauth_enabled};AcreApp.prototype.get_authors=function(){return this._authors};AcreApp.prototype.get_write_user=function(){return this._authors[this._write_user]};AcreApp.prototype.t_add_author=function(e){var b=this,i={appid:b.get_path(),username:e};return this.get_store().XhrPost("add_app_author",i).onready(function(a){a=new AcreUser(b._store,a.authors[e]);b._authors[e]=a}).onerror(function(a,m,n){mjt.warn("Failed to add author: "+
a+", "+m+", "+n)}).enqueue()};AcreApp.prototype.t_remove_author=function(e){var b=this,i={appid:b.get_path(),username:e};return this.get_store().XhrPost("remove_app_author",i).onready(function(){delete b._authors[e]}).onerror(function(a,m,n){mjt.warn("Failed to add author: "+a+", "+m+", "+n)}).enqueue()};AcreApp.prototype.t_get_apikeys=function(){var e={appid:this.get_path()};return this.get_store().XhrPost("list_app_apikeys",e).onerror(function(b,i,a){mjt.warn("Failed to get API Keys: "+b+", "+i+
", "+a)}).enqueue()};AcreApp.prototype.t_add_apikey=function(e,b,i){e={appid:this.get_path(),name:e,token:b,secret:i};return this.get_store().XhrPost("create_app_apikey",e).onerror(function(a,m,n){mjt.warn("Failed to add api key: "+a+", "+m+", "+n)}).enqueue()};AcreApp.prototype.t_remove_apikey=function(e){e={appid:this.get_path(),name:e};return this.get_store().XhrPost("delete_app_apikey",e).onerror(function(b,i,a){mjt.warn("Failed to add api key: "+b+", "+i+", "+a)}).enqueue()};AcreApp.prototype.t_set_oauth=
function(e){var b=this;if(b.is_oauth_enabled()==e)return mjt.Succeed().enqueue();if(!(e===true||e===false))return mjt.Fail(500,"Must set oauth_enabled to true or false").enqueue();var i={appid:b.get_path(),enable:e};return b.get_store().XhrPost("set_app_oauth_enabled",i).onready(function(){b._oauth_enabled=e}).onerror(function(a,m,n){mjt.warn("Setting OAuth enabled for ",b.get_name(),"failed: ",a," - ",m,n)}).enqueue()};AcreApp.prototype.t_set_writeuser=function(e){var b=this;if(!!b.get_write_user()===
e)return mjt.Succeed().enqueue();if(!(e===true||e===false))return mjt.Fail(500,"Must set write_user to true or false (current user)").enqueue();var i={appid:b.get_path(),enable:e};return b.get_store().XhrPost("set_app_writeuser",i).onready(function(a){b._write_user=e?a.write_user:null}).onerror(function(a,m,n){mjt.warn("Setting write user for ",b.get_name(),"failed: ",a," - ",m,n)}).enqueue()}})();var AcreUser;
(function(){AcreUser=function(e,b){this._store=e;this._name=b.name||null;this._full_name=b.full_name||null;this._is_admin=b.admin;return this};AcreUser.prototype.destroy=function(){};AcreUser.prototype.get_name=function(){return this._name};AcreUser.prototype.get_full_name=function(){return this._full_name};AcreUser.prototype.is_admin=function(){return!!this._is_admin};AcreUser.prototype.get_image_url=function(){return this._store.get_user_image_url(this)};AcreUser.prototype.get_view_url=function(){return this._store.get_user_view_url(this)};
AcreUser.prototype.get_new_app_host=function(){return this._store.get_user_default_app_host(this)};AcreUser.prototype.get_new_app_path=function(e){return this._store.get_user_new_app_path(this,e)}})();var EDITORS={},ImageEditor;
(function(){ImageEditor=function(e){this.supports_mime_type_change=false;this.ui_element=document.createElement("div");if(e.cssClassName)this.ui_element.className=e.cssClassName;this.file=e.file;this.readOnly=e.readOnly;if(e.onChange)this.on_change=e.onChange};ImageEditor.t_load=function(e,b){var i=EDITORS.ImageEditor.config;i.readOnly=!e.is_writable();i.onChange=function(a,m){e.trigger_editor_event("change",[a,m])};i=new ImageEditor(i);i.file=e;$(e.get_element()).append(i.ui_element);b&&i.set_state(b);
return mjt.Succeed(i)};ImageEditor.prototype.destroy=function(){$(this.ui_element).remove()};ImageEditor.prototype.show=function(e){var b="Upload an image";this._prefs=e;$(this.ui_element).empty();this.file.set_dirty("content",false);if(this.file.has_been_saved())b="Replace this image";if(!this.readOnly){this.form_element=$('<form class="image-upload"><label for="image-browse">'+b+':</label> <input id="image-browse" type="file" name="file" size="40"></form>');$(this.form_element).change(this.on_change);
$(this.ui_element).append(this.form_element)}e=this.file.get_name();b=this.file.get_app().get_base_url();if(this.file.has_been_saved())if(this.file.get_mime_type().substr(0,6)==="image/")$('<div class="image-preview"><p>'+e+':</p><img src="'+this.file.get_acre_url()+'"/></div>').appendTo(this.ui_element);else this.file.get_revision()&&$('<a href="'+b+"/"+e+'">download file</a>').appendTo(this.ui_element);$(this.ui_element).append('<div class="image-attribution"><img src="'+fb.h.reentrant_url("/static",
"freebase-cc-by-61x23.png")+' alt="Freebase CC-BY" width="61" height="23" /><p>All images included in Acre apps are released under <a href="http://creativecommons.org/licenses/by/3.0/">CC-BY</a>.</p></div>');$(this.ui_element).show()};ImageEditor.prototype.refresh=ImageEditor.prototype.show;ImageEditor.prototype.hide=function(){$(this.ui_element).hide()};ImageEditor.prototype.get_state=function(){return{form:this.form_element}};ImageEditor.prototype.set_state=function(e){if(e.revision){this.file.set_revision(e.revision);
this.file.set_dirty("content")}this.show()}})();EDITORS.ImageEditor={editor_class:ImageEditor,supports:{},config:{cssClassName:"Editor-view"}};
function EditorMargin(e){this._container=e;this._container.innerHTML="<div style='position: relative; left: 0; top: 0; width: 100%; height: 100%'></div>";e=[];for(var b=0;b<100;b++)e.push("<div>0</div>");this._lineMetricDiv=this._createLayer();this._lineMetricDiv.style.visibility="hidden";this._lineMetricDiv.innerHTML=e.join("");this._fontMetricDiv=this._createLayer();this._fontMetricDiv.style.visibility="hidden";this._fontMetricDiv.style.height="100em";this._lineNumberDiv=this._createLayer();this._lineNumberDiv.className=
"editor-margin-line-numbers";this._renderedLineCount=this._firstRenderedLine=0;this._currentLine=-1}
(function(){EditorMargin.get_layout_metrics=function(e,b){var i;if(e.getComputedStyle){i=e.getComputedStyle(b,null);return{paddingTop:i.getPropertyValue("padding-top"),marginTop:i.getPropertyValue("margin-top")}}else{i=b.currentStyle;return{paddingTop:i.paddingTop,marginTop:i.marginTop}}};EditorMargin.prototype={dispose:function(){},redraw:function(e,b){var i=this._lineMetricDiv.offsetHeight/100,a=this._fontMetricDiv.offsetHeight/100,m=i/a,n=null;if(b.contentHeight!==null)n=Math.floor(b.contentHeight/
i);var l=Math.floor(b.scrollY/i);i=Math.ceil((b.scrollY+b.visibleHeight)/i)-1;if(n!==null)i=Math.min(i,n-1);var s=this._firstRenderedLine+this._renderedLineCount;if(l<this._firstRenderedLine||l>=s||i>=s||n!==null&&n<i){s=i-l+1;l=Math.max(0,l-s);i=i+s;if(n!==null)i=Math.min(i,n-1);this._lineNumberDiv.style.paddingTop=m*l+"em";m=[];for(n=l;n<=i;n++)m.push("<div>"+(n+1)+"</div>");this._lineNumberDiv.innerHTML=m.join("");this._firstRenderedLine=l;this._renderedLineCount=i-l+1;this._highlightCurrentLine()}m=
function(g){try{if(g.indexOf("px")>0)return parseInt(g.replace(/px$/g,""),10);else if(g.indexOf("em")>0)return Math.round(parseFloat(g.replace(/em$/g,""),10)*a)}catch(f){}return 0};this._lineNumberDiv.style.top=-b.scrollY+m(e.paddingTop)+m(e.marginTop)+"px"},_createLayer:function(){var e=document.createElement("div");e.style.position="absolute";this._container.firstChild.appendChild(e);return e},setCurrentLine:function(e){if(e!==this._currentLine){this._unhighlightCurrentLine();this._currentLine=
e;this._highlightCurrentLine()}},_unhighlightCurrentLine:function(){if(this._currentLine!==-1){var e=this._lineNumberDiv.childNodes,b=this._currentLine-this._firstRenderedLine;if(b>=0&&b<e.length)e[b].className=""}},_highlightCurrentLine:function(){if(this._currentLine!==-1){var e=this._lineNumberDiv.childNodes,b=this._currentLine-this._firstRenderedLine;if(b>=0&&b<e.length)e[b].className="edit-margin-current-line-number"}}}})();var TextareaEditor;
(function(){TextareaEditor=function(e){var b=this;b._edit_element=document.createElement("textarea");if(e.cssClassName)b._edit_element.className=e.cssClassName;if(e.readOnly){$(b._edit_element).attr("readonly","yes").addClass("readonly");$(b._top_element).append("<div class='readonly-warning'>READ ONLY</div></div>")}if(e.on_change){b.timeout_id=null;var i=function(){b.timeout_id&&window.clearTimeout(b.timeout_id);b.timeout_id=window.setTimeout(e.on_change,300)},a=["input","drop"];$.browser.mozilla||
a.push("paste","keypress");for(var m=0;m<a.length;m++)$(b._edit_element).bind(a[m],i)}};TextareaEditor.t_load=function(e,b){var i=EDITORS.TextareaEditor.config;i.readOnly=!e.is_writable();i.on_change=function(){e.trigger_editor_event("change",[])};var a=new TextareaEditor(i);a._top_element=document.createElement("div");$(a._top_element).css({height:"100%",width:"100%"});$(e.get_element()).append(a._top_element);$(a._top_element).append(a._edit_element);a._margin_width=i.marginWidth;a._margin_element=
document.createElement("div");a._margin_element.className="edit-margin";$(a._top_element).append(a._margin_element);i=mjt.Succeed(a);if(b)a.set_state(b);else if(e.has_been_saved()){var m=e.t_get_revision().onready(function(n){a.set_state({text:n.text})});i.require(m)}return i};TextareaEditor.prototype.destroy=function(){$(this._top_element).remove()};TextareaEditor.prototype.show=function(e){var b=this;b._prefs=e;if(e.margin){if(!b.editorMargin)b.editorMargin=new EditorMargin(b._margin_element,{});
b._scroll_callback=function(){b._redraw_editor_margin()};if($.browser.msie)b._edit_element.onscroll=b._scroll_callback;else $(b._edit_element).bind("scroll",b._scroll_callback)}b._resize_callback=function(){b._on_resize()};$(window).bind("resize",b._resize_callback);b._on_resize();$(b._top_element).show()};TextareaEditor.prototype.hide=function(){$(this._top_element).hide();$(this._edit_element).unbind("scroll",this._scroll_callback);$(window).unbind("resize",this._resize_callback)};TextareaEditor.prototype.get_state=
function(){return{text:this._edit_element.value}};TextareaEditor.prototype.set_state=function(e){this._edit_element.value=e.text};TextareaEditor.prototype._on_resize=function(){if(this._prefs.margin){$(this._edit_element).css("left",this._margin_width);$(this._edit_element).width($(this._top_element).width()-this._margin_width);$(this._margin_element).width(this._margin_width);$(this._margin_element).show();this._redraw_editor_margin()}else{$(this._edit_element).css("left",0).width($(this._top_element).width());
$(this._margin_element).hide()}};TextareaEditor.prototype._redraw_editor_margin=function(){if(this._prefs.margin)try{var e=this._get_scroll_info();this.editorMargin.redraw(this._get_layout_metrics(),e)}catch(b){}};TextareaEditor.prototype._get_scroll_info=function(){return{scrollY:$(this._edit_element).scrollTop(),visibleHeight:$(this._edit_element).innerHeight(),contentHeight:null}};TextareaEditor.prototype._get_layout_metrics=function(){return EditorMargin.get_layout_metrics(window,this._edit_element)}})();
EDITORS.TextareaEditor={name:"TextArea",editor_class:TextareaEditor,supports:{hotswap:true,mimetype_change:true,margin:true},config:{cssClassName:"Editor-view",marginWidth:45}};
var QueryEditor=function(e,b,i){var a;e.innerHTML='<div style="position: relative"><div style="position: absolute;"></div><div style="position: absolute;"></div></div>';var m=e.firstChild.childNodes[0],n=e.firstChild.childNodes[1];$(m).css("top","10px");$(m).css("left","10px");$(n).css("right","10px").css("top","10px");var l=this,s=function(){var g=Math.round((Math.max(100,e.offsetWidth)-20-10)/2)+"px",f=Math.max(100,e.offsetHeight);e.firstChild.style.width="100%";e.firstChild.style.height=f+"px";
f=f-20;a.queryEditor.layout(f,g);a.outputPane.layout(f,g)};b.focusOnReady=true;b.onReady=function(){i.ready(l)};this.composition=a=CueCard.createComposition({queryEditorElement:m,queryEditorOptions:b,outputPaneElement:n,outputPaneOptions:{verticalPadding:2,horizontalPadding:2,hideHelp:true}});a.queryEditor._onRun=function(){this.run(true)};this.get_state=function(){return{text:a.queryEditor.content()}};this.set_state=function(g){a.queryEditor.content(g.text)};this.destroy=function(){$(e).hide();$(e).remove()};
this.show=function(g){var f=this;f._prefs=g;if(g.emql)this.composition.queryEditor._getQueryEnvelope=function(){return{extended:1}};var r=a.queryEditor._editor;setTimeout(function(){r.setLineNumbers(g.margin);r.setTextWrapping(g.softwrap);f._file.trigger_editor_event("linechange",[r.currentLine()]);if(r._last_selection){var d=r._last_selection.start,c=r._last_selection.end;r.selectLines(d.line,d.character,c.line,c.character);delete r._last_selection}},1);$(window).bind("resize",s);$(".cuecard-queryEditor-controls-bottom").acre(fb.acre.apps.appeditor+
"/templates.mjt","query_button_bar");$(f._file.get_element()).show();$(e).show();s()};this.hide=function(){$(e).hide();$(window).unbind("resize",s)};this.undo=function(){a.queryEditor._editor.editor.history.undo()};this.redo=function(){a.queryEditor._editor.editor.history.redo()};this.reindentSelection=function(){a.queryEditor._editor.editor.reindentSelection()};this.query_assist=function(){a.queryEditor.startAssistAtCursor()};this.query_run=function(){a.queryEditor.run(this._file.is_writable())};
this.query_redangle=function(){var g=a.queryEditor,f=g.getQueryModelAndContext();f.model.toInsideOutQueryJson(f.context,CueCard.UI.createBlockingContinuations(function(r,d){g.content(CueCard.jsonize(d,g.getJsonizingSettings()))}))};this.generate_template=function(){var g=this,f=ui.get_app().get_untitled_file_name(),r=a.queryEditor.getQueryModelAndContext().model.toQueryJson();CueCard.CodeGeneration.serializers["acre-template"].generateQueryCall=function(d,c,p,h,j,o,q){c.appendIndent();c.append("<acre:script>");
c.appendLineBreak();c.indent();c.appendIndent();c.append("var "+o+' = acre.require("'+g._file.get_name()+'").query');c.append(";");c.appendLineBreak();if(g._prefs.emql){c.appendIndent();c.append("var "+q+" = acre.freebase.mqlread("+o+", {extended:1});")}else{c.appendIndent();c.append("var "+q+" = acre.freebase.mqlread("+o+");")}c.appendLineBreak();c.unindent();c.appendIndent();c.append("</acre:script>");c.appendLineBreak();return q+".result"};r=CueCard.CodeGeneration.generate(r,CueCard.CodeGeneration.serializers["acre-template"],
{indentLevel:1});ui.do_file_create_new(f,{handler:"mjt"},{text:'<html>\r<head>\r\r  <title>Query-Generated Template</title>\r\r  <style type="text/css" media="screen">\r    * { vertical-align: baseline; font-weight: inherit; font-family: inherit; \r        font-style: inherit; font-size: inherit; border: 0 none; outline: 0; padding: 0; margin: 0; }\r    body { margin: 15px; }\r    ul { list-style: none; }\r    li { padding: 3px; }\r    table { border-collapse: collapse; border-spacing: 0; width: 100%; }\r    th, td { border: 1px solid #ddd; vertical-align: top; padding: 6px; }\r    th { width: 20%; text-align: right; font-size: 11px; font-weight: bold; padding: 6px; color: #666; background: #f5f5f5; }\r    td { width: 80%; font-size: 12px; }\r    img { padding: 1px; border: 1px solid #ccc;}\r    ins { color: #aaa; text-decoration: none;}\r  </style>\r\r</head>\r\r<body>\r'+
r+'  \r  <!-- Freebase attribution template --\>\r  ${acre.require("/freebase/apps/attribution/templates").blanket()}\r</body>\r</html>\r'})};CodeMirror.prototype.highlight_line=function(){var g=this._file,f=this.currentLine(),r=$(this.lineNumbers);r.find(".Codemirror-current-line").removeClass("Codemirror-current-line");r.find("div").eq(f).addClass("Codemirror-current-line");g.trigger_editor_event("linechange",[f])};this.goto_line=function(g){var f=a.queryEditor._editor.editor;try{f.jumpToLine(g)}catch(r){f.selectLines(f.prevLine(f.lastLine()),
0)}}};
(function(){var e=mjt.define_task(null,[{name:"parent"},{name:"editor_config"}]);e.prototype._task_class="CreateQueryEditor";e.prototype.request=function(){return new QueryEditor(this.parent,this.editor_config,this)};QueryEditor.t_load=function(b,i){CueCard.helper=fb.acre.freebase.site_host+"/cuecard/";CueCard.freebaseServiceUrl=fb.acre.freebase.service_url+"/";CueCard.urlPrefix=CueCard.apiProxy.base=fb.acre.appeditor.cuecard_api;var a=$.extend(true,{},EDITORS.QueryEditor.config);a.readOnly=!b.is_writable();
var m=document.createElement("div");$(m).css({height:"100%",width:"100%"});$(b.get_element()).hide().append(m);a.codeMirror.onChange=function(){try{var s=b._loaded_editors.QueryEditor.composition.queryEditor._editor.historySize();b.trigger_editor_event("change",[s.undo,s.redo])}catch(g){}};a.codeMirror.cursorActivity=function(){b._loaded_editors.QueryEditor.composition.queryEditor._editor.highlight_line()};var n,l=e(m,a).onready(function(s){s.composition.queryEditor._editor.setParser("JSParser");
if(i)s.set_state(i);else n&&s.set_state({text:n.result.text});s._file=s.composition.queryEditor._editor._file=b;s._top_element=m;$(">div",m).css("height","100%");if(a.readOnly){$(b.get_element()).addClass("readonly");$(".cuecard-queryEditor",b.get_element()).append("<div class='readonly-warning'>READ ONLY</div>")}b.trigger_editor_event("newframe",[s.composition.queryEditor._editor.frame])});if(!i&&b.has_been_saved()){n=b.t_get_revision();l.require(n)}return l}})();
EDITORS.QueryEditor={editor_class:QueryEditor,supports:{margin:true,linenumbers:true,softwrap:true,undo:true,indent:true,inline_preview:true,emql:true},config:{codeMirror:{lineNumbers:false,parserfile:[fb.acre.libs.codemirror],stylesheet:[fb.acre.libs.codemirror_css]}}};
(function(){function e(a){var m="DummyParser",n={mqlquery:"JSParser",acre_script:"JSParser",mjt:"HTMLMixedParser",freebase_template:"HTMLMixedParser",coffee_script:"JSParser",controller:"JSParser",ajax:"JSParser"},l={"text/html":"HTMLMixedParser","text/css":"CSSParser","text/javascript":"JSParser","application/json":"JSParser"},s=a.get_acre_handler();a=a.get_mime_type();if(a!=="text/plain"){if(a in l)m=l[a]}else if(s in n)m=n[s];return m}var b=mjt.define_task(null,[{name:"parent"},{name:"editor_config"}]);
b.prototype._task_class="CreateCodeMirror";b.prototype.request=function(){var a=this,m=new CodeMirror(this.parent,this.editor_config);this.editor_config.initCallback=function(){a.ready(m)};m.get_state=function(){return{text:this.editor.getCode()}};m.set_state=function(n){this.editor.importCode(n.text)}};CodeMirror.t_load=function(a,m){var n=$.extend(true,{},EDITORS.CodeMirror.config);n.readOnly=!a.is_writable();n.readOnly&&$(a.get_element()).addClass("readonly").append("<div class='readonly-warning'>READ ONLY</div>");
n.onChange=function(){if(a._loaded_editors.CodeMirror){var f=a._loaded_editors.CodeMirror.historySize();a.trigger_editor_event("change",[f.undo,f.redo])}};var l=document.createElement("div");$(l).css({height:"100%",width:"100%"});$(a.get_element()).append(l);var s,g=b(l,n).onready(function(f){f.setParser(e(a));if(m)f.set_state(m);else s&&f.set_state({text:s.result.text});f._file=a;f._top_element=l;a.trigger_editor_event("newframe",[f.frame]);n.cursorActivity=function(){f.highlight_line()}});if(!m&&
a.has_been_saved()){s=a.t_get_revision();g.require(s)}return g};CodeMirror.prototype.destroy=function(){if("_codeAssist"in this){this._codeAssist.dispose();this._codeAssist=null}$(this._top_element).remove()};CodeMirror.prototype.show=function(a){var m=this,n=m._file;m._prefs=a;setTimeout(function(){m.setLineNumbers(a.margin);m.setTextWrapping(a.softwrap);m.highlight_line();$(m._top_element).show();$("iframe",m._top_element).focus();if(m._last_selection){var l=m._last_selection.start,s=m._last_selection.end;
m.selectLines(l.line,l.character,s.line,s.character);delete m._last_selection}a.dotTrigger&&n.is_writable()&&fb.get_script(fb.acre.libs.codeassist,function(){if(!m._codeAssist)m._codeAssist=new CodeAssist(m.frame,m,{isMjt:n.get_acre_handler()=="mjt"});m._codeAssist.putSetting("dotTrigger",a.dotTrigger)})},1)};CodeMirror.prototype.hide=function(){var a=this.cursorPosition(),m=this.cursorPosition(false);this._last_selection={start:a,end:m};$(this._top_element).hide()};CodeMirror.prototype.highlight_line=
function(){var a=this._file,m=this.currentLine(),n=$(this.lineNumbers);n.find(".Codemirror-current-line").removeClass("Codemirror-current-line");n.find("div").eq(m).addClass("Codemirror-current-line");a.trigger_editor_event("linechange",[m])};CodeMirror.prototype.goto_line=function(a){try{this.jumpToLine(a)}catch(m){this.selectLines(this.prevLine(this.lastLine()),0)}};var i={"acre:doc":"xml-tagname-acre","acre:block":"xml-tagname-acre","acre:script":"xml-tagname-acre"};CodeMirror.style_token=function(a,
m){var n=m.content.toLowerCase();if(m.style=="xml-tagname")if(i[n])a.className+=" "+i[n]}})();
EDITORS.CodeMirror={name:"CodeMirror",editor_class:CodeMirror,supports:{hotswap:true,mimetype_change:true,margin:true,linenumbers:true,softwrap:true,undo:true,indent:true,codeassist:true},config:{parserConfig:{triggers:{"acre:script":"JSParser",script:"JSParser",style:"CSSParser"}},activeTokens:CodeMirror.style_token,height:"100%",marginWidth:45,autoMatchParens:true,passDelay:100,undoDelay:250,basefiles:[],parserfile:[fb.acre.libs.codemirror],stylesheet:[fb.acre.libs.codemirror_css],lineNumbers:true,
highlightActiveLine:true,tabMode:"shift",dotTrigger:false}};var ui={};
(function(){function e(h){h=h.replace(/<\?xml[^>]+>/g,"");h=h.replace(/<style[^>]+>/g,"<style>");return h=h.replace(/type=['"]text\/(css|javascript)['"]/g,"")}function b(h){return h.replace(/acre:/g,"")}function i(h){h=h.replace(/<acre:script>/g,"<script>").replace(/<\/acre:script>/g,"<\/script>");h=h.replace(/<\/?acre:(block|doc)[^>]*>/g,"");h=h.replace(/<[^>]+>/g,b);return h=e(h)}function a(h){/^\s*@charset\s+"UTF-8";/.test(h)||(h='@charset "UTF-8"; '+h);return h}ui.init=function(){$("#body").acre(fb.acre.apps.appeditor+
"/templates.mjt","body");$("#button-apps").click(function(){ui.do_show_menu("apps")}).attr("title",ui.shortcut.get_keys("Open App"));ui.shortcut.register_keys(document);window.onbeforeunload=ui.warn_user_about_unsaved_files;$(document).keydown(function(h){return!(h.which===8&&h.target.nodeName!=="INPUT"&&h.target.nodeName!=="TEXTAREA")});$(".exit").live("click",ui.do_hide_overlays);$(".app-link").live("click",function(h){if(!(h.ctrlKey||h.metaKey||h.altKey||h.shiftKey)){h=$(this).attr("apppath");
ui.do_hide_overlays();ui.get_app()&&ui.get_app().is_dirty()?ui.do_show_dialog("files_dirty",[h]):ui.do_choose_app(h);return false}});ui.check_browser_hash();setInterval(ui.check_browser_hash,250)};ui.refresh_app_templates=function(h){var j=ui.get_app();$("#header-apptitle").acre(fb.acre.apps.appeditor+"/templates.mjt","header",[h]);if(j){$("#list-column").acre(fb.acre.apps.appeditor+"/templates.mjt","list_column");j.is_writable()?$("#about-bar").hide():$("#about-bar").acre(fb.acre.apps.appeditor+
"/templates.mjt","about_bar").show()}};ui.refresh_file_templates=function(){$("#file-list").acre(fb.acre.apps.appeditor+"/templates.mjt","file_list");$("#button-bar").acre(fb.acre.apps.appeditor+"/templates.mjt","button_bar");ui.finish_drawing()};ui.finish_drawing=function(){$(".refresh").show();ui.set_state();$(window).trigger("resize")};ui.do_show_dialog=function(h,j){function o(q){if(q.keyCode==27){ui.do_hide_dialog_overlays();$(document).unbind("keydown",o)}}ui.do_hide_overlays();if(h=="welcome")ui.dialog=
$("<div id='"+h+"'></div>").acre(fb.acre.apps.appeditor+"/dialogs.mjt",h,j).prependTo(document.body);else{$("<div id='dialog-overlay'></div>").prependTo(document.body);$(document).bind("keydown",o);ui.dialog=$("<div id='dialog-"+h+"' class='dialog'></div>").acre(fb.acre.apps.appeditor+"/dialogs.mjt",h,j).prepend("<div class='dialog-close' onclick='ui.do_hide_overlays()'></div>").prependTo(document.body)}ui.dialog.show();ui.dialog.css("left",($(window).width()-ui.dialog.outerWidth())/2);return false};
ui.do_show_menu=function(h,j){function o(){ui.do_hide_menu_overlays();$(document).unbind("keydown",q)}function q(x){x.keyCode==27&&o()}$("<div id='menu-overlay'></div>").prependTo(document.body).click(o);$(document).bind("keydown",q);$("#button-"+h).addClass("button-open");var t=$("#button-"+h).offset(),u=$("#button-"+h).height();$("<div id='menu-"+h+"' class='menu'></div>").css({top:t.top+u+10,left:t.left}).prependTo(document.body).acre(fb.acre.apps.appeditor+"/menus.mjt",h,j);return false};ui.do_setup_submenu=
function(h,j,o){var q,t,u=false,x=$("#"+h),C=x.closest(".menu"),w=$("<div id='menu-"+j+"' class='menu submenu'></div>");x.mouseenter(function(){q=setTimeout(function(){if(u)w.css("visibility","visible");else{w.css({top:x.offset().top,left:C.offset().left+C.width()}).prependTo(document.body).acre(fb.acre.apps.appeditor+"/menus.mjt",j,o).mouseenter(function(){clearTimeout(t)}).mouseleave(function(){clearTimeout(q);t=setTimeout(function(){w.css("visibility","hidden")},100)});u=true}},250)}).mouseleave(function(){clearTimeout(q);
t=setTimeout(function(){w.css("visibility","hidden")},100)})};ui.do_hide_dialog_overlays=function(){delete ui.dialog;$("#dialog-overlay, .dialog").remove();$(".fbs-pane, .fbs-flyout-pane").hide()};ui.do_hide_menu_overlays=function(){$("#menu-overlay, .menu").remove();$(".button-open").removeClass("button-open");$(".fbs-pane, .fbs-flyout-pane").hide()};ui.do_hide_overlays=function(){ui.do_hide_dialog_overlays();ui.do_hide_menu_overlays()};ui.do_hide_welcome=function(){$("#welcome").remove()};var m=
true,n,l,s,g,f,r=false,d=false,c=+new Date;ui.check_browser_hash=function(){if(!d){var h=ui._get_browser_hash();if(h=="0")ui.set_state();else if(m||ui._ui_state_to_browser_hash()!==h){m=false;h=mjt.app.decode_uristate(h);var j=/[\<\>]/,o=h.path||h.app;o=!j.test(o)?o:null;j=!j.test(h.file)?h.file:null;ui.do_choose_app(o,j,h.line,h.create)}}};ui._get_browser_hash=function(){return window.location.hash.replace(/#!?/,"")};ui._ui_state_to_browser_hash=function(){if(typeof ui.get_app()=="undefined")return null;
var h={};if(ui.get_app())h.path=ui.get_app().get_versioned_path();if(ui.get_file())h.path+="/"+ui.get_file().get_relative_path();return mjt.app.encode_uristate(h)};ui.set_state=function(){var h=ui.get_app(),j=ui.get_file();r=j?j.is_dirty():null;var o="";if(h)o+=(h.get_display_name()||h.get_path())+" - ";if(j)o+=j.get_name()+" - ";o+="Freebase App Editor";document.title=o;h=ui._ui_state_to_browser_hash();if(h!==ui._get_browser_hash())window.location.hash="!"+h;d=false};ui.clear_state=function(){r=
f=g=s=null};ui.get_store=function(){return n};ui.set_store=function(h){n=h};ui.set_user=function(h){var j=ui.get_store();h!==j.get_user()&&j.set_user(h);l=j.get_user()};ui.get_app=function(){if(!s)return null;return s};ui.get_file=function(){if(!g)return null;return g};ui.get_line=function(){return f};ui.get_user=function(){return l};ui.get_recents=function(h,j){var o=$.localstore("recent_"+h,undefined,false);if(o===null)o=[];!j&&o&&o.length>0&&o.shift();return o};ui.add_recent=function(h,j,o){var q=
$.localstore("recent_"+h,undefined,false);if(!q||!jQuery.isArray(q))q=[];for(var t=JSON.stringify(j),u=0;u<q.length;u++)if(JSON.stringify(q[u])==t||h=="apps"&&(j&&(q[u].path==j.path||ui.id_to_path(q[u].path)==j.path)||q[u].path==o))q.splice(u,1);if(j){q.unshift(j);if(q&&q.length>16){j=q.splice(16);if(h=="apps")for(o=0;o<j.length;o++)ui.clear_recents(j[o])}}$.localstore("recent_"+h,q,false)};ui.clear_recents=function(h){$.localstore("recent_"+h,null,false)};ui.do_choose_app=function(h,j,o,q){function t(){ui.clear_state();
ui.set_state();ui.refresh_app_templates("open");var A=ui.get_recents("apps",true);if(q=="app"){if(!ui.get_user())location.href=ui.get_store().get_user_account_url("signin")+"create=app";ui.do_show_dialog("new_app")}else if(A.length>0){var E=A.shift();$.localstore("recent_apps",A,false);ui.do_choose_app(E.path)}else ui.get_user()?ui.do_show_dialog("welcome",[true]):ui.do_show_dialog("welcome")}function u(){if(q=="file"){ui.set_state();ui.do_show_dialog("add_file")}else ui.do_choose_file(j,o)}d=true;
var x=ui.get_app(),C=x?x.get_versioned_path():null;if(h&&x&&h==C){ui.refresh_app_templates();u()}else{ui.do_hide_overlays();ui.do_hide_welcome();$(".refresh").hide();if(h){x&&x.destroy();ui.refresh_app_templates("loading");var w=new AcreApp(ui.get_store(),h);w.t_load().onready(function(){s=w;ui.add_recent("apps",{path:w.get_path(),name:w.get_display_name()});g=null;ui.refresh_app_templates();u();ui.do_status_check()}).onerror(function(A,E,F){if(A=="/api/status/error/input/no_app"){ui.MessagePanel.error(E?
E:"Error loading app: "+h+". "+E||"");ui.add_recent("apps",null,h);t()}else{assert.critical(false,"Error connecting to Freebase<br/>"+E);mjt.error(A,E,F);ui.clear_state();ui.set_state();ui.refresh_app_templates("open")}})}else t()}};ui.do_choose_file=function(h,j){function o(){var x=ui.get_file();if(!x)return ui.refresh_file_templates();var C=ui._get_desired_editor_classname();return x.t_editor_show(C,ui.get_editor_prefs()).onready(function(){j&&setTimeout(function(){x.editor_goto_line(j)},0);ui.refresh_file_templates();
ui.set_state()})}d=true;var q=ui.get_app(),t=ui.get_file(),u=q.get_file(h);u||(u=q.get_file());if(!u||u==t)o(j);else{g=u;r=u.is_dirty();if($("#file-area").has(u.get_element()).length===0){$("#file-area").append(u.get_element());ui._register_editor_event_handlers(u)}t&&t.hide();$(u.get_element()).show();return o(j)}};ui.do_refresh_file=function(){var h=ui.get_file();if(h){h.set_dirty("editor");var j=ui._get_desired_editor_classname();h.t_editor_show(j,ui.get_editor_prefs()).onready(function(){ui.refresh_file_templates();
setTimeout(function(){h.editor_goto_line(ui.get_line())},0)})}};ui.do_run_view=function(h,j){var o=ui.get_file();if(o.get_acre_handler()=="mqlquery")o._current_editor.query_run();else{var q=ui.get_file().get_acre_url(j),t=window.open("about:blank",ui.get_app().get_path().replace(/[\/-]/g,"_"));if(!t){ui.MessagePanel.error("A window couldn't be opened.  Tell your web browser to allow this site to open pop up windows and try again to continue.");return false}ui.do_app_save_all(function(){t.location=
q;t.focus()})}};ui.do_acre_home_link=function(){location.href=ui.get_store().get_freebase_url()+"/apps";return false};ui.do_status_check=function(){var h={};if(ui.get_app())h.appid=ui.get_app().get_path();ui.get_store().XhrGet("get_app_status",h).enqueue().onready(function(j){ui.get_app().set_last_change(j.change);if(!!j.user!==!!ui.get_user()){ui.set_user(j.user);if(!j.user){ui.MessagePanel.error("You are no longer signed in.  Sign back in in another window to not lose any changes.");$(window).trigger("fb.user.signedout")}$(window).trigger("fb.user.signedin")}$("#app-edits-shim").acre(fb.acre.apps.appeditor+
"/templates.mjt","app_edits");ui.refresh_file_templates()})};ui.do_app_create_new=function(h,j,o){var q={appid:h};if(j)q.name=j;if(o)q.clone=o;if(ui.get_store().get_user_apps(h))ui.MessagePanel.error("App with that URL already exists");else{ui.MessagePanel.doing("Creating: "+j+"...");ui.get_store().XhrPost("create_app",q).enqueue().onready(function(t){ui.MessagePanel.info("Created: "+j);ui.do_choose_app(h);ui.get_store().set_user_apps(t)}).onerror(function(t,u){ui.MessagePanel.error(u?u:"Error creating: "+
h+". "+u||"")})}};ui.do_app_move=function(h){var j=ui.get_app(),o=j.get_path();d=true;ui.MessagePanel.doing("Moving app...");j.t_move(h).onready(function(){ui.set_state();ui.add_recent("apps",{path:j.get_path(),name:j.get_display_name()},o);ui.get_store().t_refresh_user_apps();ui.MessagePanel.info("App moved to "+h)}).onerror(function(q,t){ui.MessagePanel.error(t?t:"Error moving: "+j.get_display_name())})};ui.do_app_set_host=function(h){var j=ui.get_app();ui.MessagePanel.doing("Updating release URL for "+
j.get_display_name()+"...");j.t_set_host(h).onready(function(){ui.MessagePanel.info("Release URL updated");$("#app-hosts-list").acre(fb.acre.apps.appeditor+"/menus.mjt","app_hosts_list")}).onerror(function(o,q){ui.MessagePanel.error(q?q:"Error updating release URL for: "+j.get_display_name())})};ui.do_app_set_release=function(h){var j=ui.get_app();ui.MessagePanel.doing("Updating release of "+j.get_display_name()+"...");j.t_set_release(h).onready(function(){ui.MessagePanel.info("Release updated to "+
h);$("#app-versions-add").acre(fb.acre.apps.appeditor+"/menus.mjt","app_versions_list");$("#app-hosts-list").acre(fb.acre.apps.appeditor+"/menus.mjt","app_hosts_list")}).onerror(function(o,q){ui.MessagePanel.error(q?q:"Error releasing: "+j.get_display_name())})};ui.do_app_add_version=function(h,j,o){var q=ui.get_app();ui.MessagePanel.doing("Creating version "+h);q.t_add_version(h,j,o).onready(function(){ui.MessagePanel.info("Created version "+h);$("#app-versions-add").acre(fb.acre.apps.appeditor+
"/menus.mjt","app_versions_list")}).onerror(function(t,u){ui.MessagePanel.error("Failed to add version. "+u)})};ui.do_app_remove_version=function(h){var j=ui.get_app();ui.MessagePanel.doing("Removing version "+h);j.t_remove_version(h).onready(function(o){ui.MessagePanel.info("Removed version "+h);$("#app-versions-add").acre(fb.acre.apps.appeditor+"/menus.mjt","app_versions_list",[o])})};ui.do_app_set_listing=function(h,j,o){var q=ui.get_app();ui.MessagePanel.doing("Updating app name...");q.t_set_listing(h,
j,o).onready(function(){h&&ui.add_recent("apps",{path:q.get_path(),name:q.get_display_name()},q.get_path());ui.MessagePanel.info("Updated app name");ui.refresh_app_templates()}).onerror(function(t,u){ui.MessagePanel.error(u?u:"Error changing app name")})};ui.do_app_add_author=function(h){ui.get_app().t_add_author(h).onready(function(){var j=ui.get_app().get_authors();$("#app-authors-list").acre(fb.acre.apps.appeditor+"/menus.mjt","app_authors_list",[j])})};ui.do_app_remove_author=function(h){ui.get_app().t_remove_author(h).onready(function(){var j=
ui.get_app().get_authors();$("#app-authors-list").acre(fb.acre.apps.appeditor+"/menus.mjt","app_authors_list",[j])})};ui.do_app_set_oauth=function(h){var j=ui.get_app();ui.MessagePanel.doing("Setting OAuth state...");j.t_set_oauth(h).onready(function(){ui.MessagePanel.info("OAuth "+(h?"enabled":"disabled"))}).onerror(function(o,q){ui.MessagePanel.error("Failed to update OAuth state: "+q)})};ui.do_app_set_writeuser=function(h){var j=ui.get_app();ui.MessagePanel.doing("Setting write user...");j.t_set_writeuser(h).onready(function(){ui.MessagePanel.info("Write user "+
(h?"enabled":"disabled"))}).onerror(function(o,q){ui.MessagePanel.error("Failed to update writeuser state: "+q)})};ui.do_app_add_apikey=function(h,j,o){var q=ui.get_app();ui.MessagePanel.doing("Adding API key for "+h+"...");q.t_add_apikey(h,j,o).onready(function(t){ui.MessagePanel.info(h+" API key added.");$("#app-apikeys-add").acre(fb.acre.apps.appeditor+"/menus.mjt","app_apikeys_list",[t.keys])}).onerror(function(t,u){ui.MessagePanel.error("Failed to add API key: "+u)})};ui.do_app_remove_apikey=
function(h){var j=ui.get_app();ui.MessagePanel.doing("Deleting API key for "+h+"...");j.t_remove_apikey(h).onready(function(o){ui.MessagePanel.info(h+" API key deleted.");$("#app-apikeys-add").acre(fb.acre.apps.appeditor+"/menus.mjt","app_apikeys_list",[o.keys])}).onerror(function(o,q){ui.MessagePanel.error("Failed to delete API key: "+q)})};ui.do_app_save_all=function(h){var j=ui.get_app();if(!j.is_dirty()&&typeof h==="function")h();else{ui.MessagePanel.doing("Saving all files...");j.t_save_all().onready(function(){ui.MessagePanel.info("All files saved.");
ui.refresh_file_templates();typeof h==="function"&&setTimeout(h,500)}).onerror(function(o,q){ui.MessagePanel.error("Failed to save all files: "+q)})}};ui.do_app_delete=function(){var h=ui.get_app();ui.MessagePanel.doing("Deleting: "+h.get_display_name()+"...");h.t_delete().onready(function(j){ui.get_store().set_user_apps(j);ui.MessagePanel.info("Deleted app");s=null;ui.add_recent("apps",null,h.get_path());ui.do_choose_app()}).onerror(function(j,o){ui.MessagePanel.error(o?o:"Error deleting: "+h.get_display_name())})};
ui.do_app_apply_changes=function(h,j,o){for(var q=0;q<j.length;q++)ui.do_file_apply_change(h.files[j[q]]);ui.refresh_file_templates();o&&ui.do_app_save_all()};ui.do_file_create_new=function(h,j,o){if(ui.get_app().get_file(h))ui.MessagePanel.error("File with that name already exists");else{h=new AcreDoc(ui.get_app(),h,j,o);ui.do_choose_file(h.get_name())}};ui.do_file_set_acre_handler=function(h){var j=ui.get_file();if(h!==j.get_acre_handler()){j.set_acre_handler(h);ui.do_refresh_file()}};ui.do_file_set_mime_type=
function(h){var j=ui.get_file();if(h!==j.get_mime_type()){j.set_mime_type(h);ui.do_refresh_file()}};ui.do_file_save=function(h){var j=ui.get_file();if(j.is_dirty()){ui.MessagePanel.doing("Saving file: "+j.get_name()+"...");j.t_save(h).enqueue().onready(function(){ui.refresh_file_templates();ui.MessagePanel.info("File saved: "+j.get_name())}).onerror(function(o,q,t){if(o==="/api/status/error/upload/content_mismatch"){ui.MessagePanel.clear();ui.do_show_dialog("diff_patch",["save_conflict",t.info])}else if(o===
"/api/status/error/auth")ui.MessagePanel.error("You are not currently signed in.  To not lose your changes, sign in in a new tab or window and then try again.");else o==="/api/status/error/file_format/unsupported_mime_type"?ui.MessagePanel.error(q):ui.MessagePanel.error(q||"Error saving: "+j.get_name());ui.refresh_file_templates()})}};ui.do_file_save_as=function(h,j){var o=ui.get_file(),q=h==o.get_app().get_path()?o.get_app():new AcreApp(ui.get_store(),h),t={handler:o.get_acre_handler(),content_type:o.get_mime_type(),
based_on:o.get_app().get_path()+"/"+mjt.freebase.mqlkey_quote(o.get_name())},u=new AcreDoc(q,j,t,o.get_editor_state());ui.MessagePanel.doing("Saving file as: "+j+"...");u.t_save().enqueue().onready(function(){q==ui.get_app()?ui.do_choose_file(u.get_name()):q.destroy();ui.MessagePanel.info("File created: "+j)}).onerror(function(x,C,w){w&&w.code=="/api/status/error/auth"?ui.MessagePanel.error("You are not currently signed in.  To not lose your changes, sign in in a new tab or window and then try again."):
ui.MessagePanel.error(C||"Error creating: "+j)})};ui.do_file_revert_to_saved=function(){ui.get_file().t_revert_to_saved().onready(function(){ui.do_refresh_file()})};ui.do_file_move=function(h,j){var o=ui.get_file(),q=o.get_name();if(h!=q)if(ui.get_app().get_file(h))ui.MessagePanel.error('The name "'+h+'" is already taken. Please choose a different name.',j);else{try{o.set_name(h)}catch(t){ui.MessagePanel.error(t,j);return}ui.do_choose_file(o.get_name())}};ui.do_file_delete=function(h){var j=h?ui.get_app().get_file(h):
ui.get_file();ui.MessagePanel.doing("Deleting file:"+j.get_name()+"...");j.t_delete().onready(function(){ui.MessagePanel.info("File deleted: "+j.get_name());g=null;ui.do_choose_file()}).onerror(function(o,q){ui.MessagePanel.error(q?q:"Error deleting: "+j.get_name())})};ui.do_file_apply_change=function(h,j){var o=h.file1,q=h.file2,t;if(o)if(q){t=ui.get_app().get_file(q.name);t.set_name(o.name);t.set_acre_handler(o.acre_handler);t.set_mime_type(o.content_type);if(h.patch){o=h.patch.text;if(t.is_editor_loaded())t.set_editor_state({text:o});
else{$("#file-area").append(t.get_element());t.t_editor_show("TextareaEditor",{margin:false},{text:o});t.hide()}}else o.content_id&&o.content_id!==q.content_id&&t.set_revision(o.content_id)}else{t={handler:o.acre_handler,content_type:o.content_type,based_on:o.fileid};t=new AcreDoc(ui.get_app(),o.name,t,{text:o.text});t.hide()}else{t=ui.get_app().get_file(q.name);t.set_dirty("to_delete")}q&&q.name===ui.get_file().get_name()&&ui.do_refresh_file();j&&ui.do_file_save()};ui.do_file_editor_undo=function(){ui.get_file().editor_undo()};
ui.do_file_editor_redo=function(){ui.get_file().editor_redo()};ui.do_file_editor_goto_line=function(h){ui.get_file().editor_goto_line(h)};ui.do_file_editor_indent=function(){ui.get_file().editor_indent()};ui.get_file_check_options=function(){var h={bitwise:true,eqeqeq:true,forin:true,sub:true,undef:true,useful:1},j=["acre","JSON","XMLHttpRequest","console"];switch(ui.get_file().get_acre_handler()){case "mqlquery":break;case "acre_script":h.predef=j;h.es5=true;break;case "mjt":h.es5=true;h.useful=
0;h.predef=j;h.before_check=i;break;case "passthrough":h.browser=true;switch(ui.get_file().get_mime_type()){case "application/json":break;case "text/javascript":break;case "text/html":h.before_check=e;break;case "text/css":h.before_check=a;break;case "text/plain":h.useful=0;break;default:h.useful=-1;break}break;default:h.useful=-1;break}return h};ui.do_click_error=function(h){h=$(h.target);if(h.hasClass("jslint-error")){var j=h.attr("title");ui.MessagePanel.clear();j=(j+"").replace(/\&/g,"&amp;").replace(/</g,
"&lt;").replace(/>/g,"&gt;");ui.MessagePanel.error(j);h=h.text();ui.get_file().editor_goto_line(h)}};ui.do_file_check=function(){ui.do_hide_overlays();var h=$(".CodeMirror-line-numbers,.editor-margin-line-numbers",ui.get_file().get_element());$(">div.jslint-error",h).attr("title","").removeClass("jslint-error");ui.MessagePanel.clear();var j=ui.get_file_check_options();assert.critical(j,"missing jslint_options");var o=ui.get_file().get_editor_state().text;if(j.before_check)o=j.before_check(o);fb.get_script(fb.acre.libs.fulljslint,
function(){if(JSLINT(o,j))ui.MessagePanel.info("No syntax errors found");else{var q=JSLINT.errors,t="Found "+q.length+" errors.  Click any of the red line numbers below to see corresponding error details.",u=$(">div",h);if(u.length)for(var x=0;x<q.length;x++){var C=q[x];if(C){var w=u.eq(C.line-1);w.addClass("jslint-error");w.attr("title",w.attr("title")+" "+C.reason)}}else{q=q.slice(0,3);t=$.map(q,function(A){if(A)return"Line: "+A.line+" "+A.reason})}ui.MessagePanel.error(t);ui.get_file().editor_goto_line(q[0].line)}})};
ui.do_zen_coding=function(){if(ui.get_file().get_editor_name()==="CodeMirror"){var h=ui.get_file()._current_editor.editor,j=h.cursorPosition(),o=h.options.indentUnit,q=/(\s*)(.*)/.exec(h.lineContent(j.line));o=Math.floor(q[1].length/o);if(q=q[2]){q=zen.convert(q,o);if(q.error)ui.MessagePanel.error('Zen Coding syntax error in "'+mjt.htmlencode(q.error)+'".<br> See <a target="_blank" href="http://code.google.com/p/zen-coding/wiki/ZenHTMLSelectorsEn">ZenCoding</a> for help');else{ui.MessagePanel.info('Expanded <a target="_blank" href="http://code.google.com/p/zen-coding/wiki/ZenHTMLSelectorsEn">ZenCoding</a> expression');
h.setLineContent(j.line,q.out)}}}};var p={texteditor:"CodeMirror",syntax:navigator.userAgent.indexOf("iPad")===-1?true:false,margin:true,softwrap:false,dotTrigger:false,flw:200,emql:false};ui.get_editor_prefs=function(h){function j(q){var t=$.localstore(q);return t===null?p[q]:t=="1"?true:t=="0"?false:t}if(h)return j(h);else{h={};for(var o in p)h[o]=j(o);return h}};ui.set_editor_prefs=function(h,j){var o;if(arguments.length==1)o=h;else if(arguments.length==2){o={};o[h]=j}for(var q in o)$.localstore(q,
o[q]===true?"1":o[q]===false?"0":o[q])};ui._get_desired_editor_classname=function(h){h=h||this.get_file();h=h.get_acre_handler();if(h=="binary")return"ImageEditor";else if(h=="mqlquery")return"QueryEditor";else{h=ui.get_editor_prefs("texteditor");return EDITORS[h]?h:p.texteditor}};ui._register_editor_event_handlers=function(h){h.register_editor_event_handlers({change:ui.editor_change_handler,linechange:ui.editor_linechange_handler,newframe:ui.editor_newframe_handler})};ui.editor_change_handler=function(h,
j){if(+new Date-c>6E4){c=+new Date;ui.do_status_check()}if(r!=ui.get_file().is_dirty()||h===0)ui.refresh_file_templates();if(h>0){ui._has_undos||$("#button-undo").removeAttr("disabled");ui._has_undos=true}else{ui._has_undos&&$("#button-undo").attr("disabled","disabled");ui._has_undos=false}if(j>0){ui._has_redos||$("#button-redo").removeAttr("disabled");ui._has_redos=true}else{ui._has_redos&&$("#button-redo").attr("disabled","disabled");ui._has_redos=false}};ui.editor_linechange_handler=function(h){f=
h;$("#linenumber").val(h)};ui.editor_newframe_handler=function(h){ui.shortcut.register_keys(h.contentWindow?h.contentWindow.document:h.contentDocument)};ui.warn_user_about_unsaved_files=function(){if(ui&&ui.get_app()&&ui.get_app().is_dirty())return"You have unsaved files! The changes you made to these files will be lost if you leave this page."};ui.url_for=function(h){return fb.acre.request.base_path+"/"+h};ui.get_app_url=function(h){return"http://"+h+ui.get_store().get_acre_host()};ui.get_appeditor_url=
function(h,j){var o;if(typeof h=="string")o=h;else if(h instanceof AcreDoc){o=h.get_app().get_versioned_path();j=h.get_relative_path()}else if(h instanceof AcreApp)o=h.get_versioned_path();var q=window.location.protocol+"//"+window.location.host+window.location.pathname;if(o)q+="#!path="+o;if(j)q+="/"+j;return q};ui.id_to_path=function(h){return"//"+h.split("/").reverse().join(".")+"dev"};ui.get_human_timestamp=function(h){return mjt.freebase.date_from_iso(h).toLocaleString()};ui.get_relative_timestamp=
function(h){var j=new Date;h=mjt.freebase.date_from_iso(h);var o=j.getTime()-h.getTime();j=Math.floor(o/94608E7);h=Math.floor(o/2592E6);var q=Math.floor(o/864E5),t=Math.floor(o/36E5);o=Math.floor(o/6E4);if(j>0)return j===1?"1 year ago":j+" years ago";if(h>0)return h===1?"1 month ago":h+" months ago";if(q>0)return q===1?"1 day ago":q+" days ago";if(t>0)return t===1?"1 hour ago":t+" hours ago";if(o>0)return o===1?"1 minute ago":o+" minutes ago";if(o===0)return"less than a minute ago";if(o<0)return"in the future???"};
ui.order_section_files=function(h){var j={};h=h.get_files();for(var o in h){var q=h[o],t=q.get_name();q=q.get_acre_handler();q=q=="acre_script"&&t.substr(0,5)=="test_"?"test":q;if(typeof j[q]=="undefined")j[q]=[];j[q].push(t)}for(var u in j)j[u].sort(function(x,C){return x.localeCompare(C)});return j};ui.order_lib_files=function(h){var j=[];h=h.get_files();for(var o in h)j.push(h[o].get_name());j.sort(function(q,t){return q.localeCompare(t)});return j};ui.watch_inputs=function(h,j){function o(){var C=
false,w=j.inputs.length,A={};jQuery.each(j.inputs,function(E){var F,z=$("#"+E)[0];if(typeof z=="undefined")z=$("input[name='"+E+"']")[0];if(typeof z!="undefined"){if(z.tagName=="TEXTAREA")F=jQuery.trim($("#"+E).val());else if(z.tagName=="INPUT"){z=$(z).attr("type");if(z=="text")F=jQuery.trim($("#"+E).val());else if(z=="radio")F=$("input[name='"+E+"']:checked").val();else if(z=="checkbox")F=$("#"+E).attr("checked")}else if(z.tagName=="SELECT")F=$("#"+E+" :selected").val();if(F!=j.inputs[E]){C=true;
w-=1;A[E]=F}}});return j.activate_on=="all"?w===0?A:false:C?A:false}function q(){var C=o();if(C&&j.change){var w=j.change.apply(this,[C]);if(typeof w!=="undefined")C=w}C?$("#button-"+h).removeAttr("disabled").addClass("button-main"):$("#button-"+h).attr("disabled","disabled").removeClass("button-main")}function t(C){$("#"+C).bind("change",function(){q()})}function u(C){var w;$("#"+C).bind("keyup",function(){clearTimeout(w);w=setTimeout(q,j.text_delay||300)})}function x(C){$("input[name='"+C+"']").bind("click",
function(){q()})}jQuery.each(j.inputs,function(C,w){var A=$("#"+C)[0];if(typeof A=="undefined")A=$("input[name='"+C+"']")[0];if(typeof A!="undefined")if(A.tagName=="TEXTAREA")u(C,w);else if(A.tagName=="INPUT"){A=$(A).attr("type");if(A=="text")u(C);else A=="radio"?x(C):t(C)}else A.tagName=="SELECT"&&t(C)});$("#button-"+h).unbind("click").click(function(){var C=o();j.submit.apply(this,[C]);if(j.update_on_submit){jQuery.extend(j.inputs,C);q()}})};ui.populate_diff=function(h,j,o){function q(){var G=h.parent().height()-
C.height();A.height(G);E.height(G);z.height(G);y.height(G)}function t(){var G;if(j.file1||typeof j.file1==="undefined"){G=E.scrollTop();A.scrollTop(G)}else G=y.scrollTop();if(j.file2||typeof j.file2==="undefined"){z.scrollTop(G);y.scrollTop(G)}}function u(G,K,J,H){var D;D=J.length>1?"replace":J[0][0]==-1&&H==="left"?"delete":J[0][0]==1&&H==="right"?"insert":"eq";var L=$('<div class="line"></div>'),N=H==="left"?1:-1;if(J.length==1&&J[0][0]==N)L.append("<pre> </pre>");else{L.append($("<pre></pre>").text(v[H]));
J.length===1&&J[0][0]===N||(v[H]+=1)}G.append(L);G=$('<div class="code"></div>').addClass(D);D=$("<pre></pre>");L=false;for(N=0;N<J.length;N++){var M=J[N],O=M[1]===""?" ":M[1];switch(M[0]){case 0:L=true;M=$('<span class="text-eq"></span>').text(O);D.append(M);break;case 1:if(H==="right"){L=true;M=$('<span class="text-add"></span>').text(O);D.append(M)}break;case -1:if(H==="left"){L=true;M=$('<span class="text-delete"></span>').text(O);D.append(M)}break}}L||D.text(" ");G.append(D);K.append(G)}function x(G){G=
G.fileid.split("/");G.pop();return G.join("/")}var C=$('<div class="diff-header-container"></div>'),w=$('<div class="diff-header"></div>'),A=$('<div class="diff-line-container"></div>'),E=$('<div class="diff-code-container"></div>'),F=$('<div class="diff-header"></div>'),z=$('<div class="diff-line-container"></div>'),y=$('<div class="diff-code-container"></div>'),v={left:1,right:1};if(j.labels&&j.labels.length){if(j.labels[0]){o=$("<h3></h3>");o.text(j.labels[0]);F.append(o);C.append(F)}if(j.labels[1]){o=
$("<h3></h3>");o.text(j.labels[1]);w.append(o);C.append(w)}}else{if(j.file2){var B=$("<h3></h3>");if(!j.file1){F.addClass("full");y.addClass("full");B.append("Delete: ")}(j.file1&&j.file2?j.file1.name!==j.file2.name:false)&&B.addClass("change");B.append(j.file2.name);x(j.file2)!==ui.get_app().get_path()&&B.append(" in "+x(j.file2));var I=$("<h3></h3>");(j.file1&&j.file2?j.file1.handler!==j.file2.handler||j.file1.content_type!==j.file2.content_type:false)&&I.addClass("change");I.append(ui.get_app().get_acre_handlers()[j.file2.handler].name);
j.file2.content_type&&I.append(" ("+j.file2.content_type+")");F.append(B).append(I);if(o==="get_file_diff"){B=$("<h3></h3>");j.file2.last_modified&&B.append("Last Mod: "+ui.get_human_timestamp(j.file2.last_modified));F.append(B)}C.append(F)}if(j.file1){F=$("<h3></h3>");if(j.file2)o=="get_file_merge"&&F.append("After Merge: ");else{w.addClass("full");E.addClass("full");F.append("Create: ")}F.append(j.file1.name);o=="get_file_diff"&&x(j.file1)!==ui.get_app().get_path()&&F.append(" in "+x(j.file1));
B=$("<h3></h3>");B.append(ui.get_app().get_acre_handlers()[j.file1.handler].name);j.file1.content_type&&B.append(" ("+j.file1.content_type+")");w.append(F).append(B);if(o==="get_file_diff"){o=$("<h3></h3>");j.file1.last_modified&&o.append("Last Mod: "+ui.get_human_timestamp(j.file1.last_modified));w.append(o)}C.append(w)}}h.append(C);if(j.message)h.append($('<div class="message"></div>').text(j.message));else if(j.file1&&j.file2&&j.file1.content_id===j.file2.content_id)h.append('<div class="message">No change in content</div>');
else if(j.file2&&j.file2.binary||j.file1&&j.file1.binary){if(j.file2&&j.file2.binary){z.append("<pre> </pre>");y.append('<div class="image"><div class="image-preview"><img src="'+j.file2.binary+'" /></div></div>');h.append(z).append(y)}if(j.file1&&j.file1.binary){A.append("<pre> </pre>");E.append('<div class="image"><div class="image-preview"><img src="'+j.file1.binary+'" /></div></div>');h.append(A).append(E)}}else if(j.diff){for(w=0;w<j.diff.length;w++){o=j.diff[w];if(j.file2||typeof j.file2===
"undefined")u(z,y,o,"left");if(j.file1||typeof j.file1==="undefined")u(A,E,o,"right")}if(j.file2||typeof j.file2==="undefined"){z.append('<div class="line"><pre> </pre></div>');h.append(z).append(y);y.scroll(t)}if(j.file1||typeof j.file1==="undefined"){A.append('<div class="line"><pre> </pre></div>');h.append(A).append(E);E.scroll(t)}if((j.file1||typeof j.file1==="undefined")&&(j.file2||typeof j.file2==="undefined"))y.css("overflow-y","hidden")}q();$(window).resize(q)};ui.MessagePanel=function(){function h(t,
u,x){if(q&&q==="error")mjt.error("MessagePanel: Already displaying error. Ignoring: "+t+": "+u);else{$("#message-panel").hide().acre(fb.acre.apps.appeditor+"/templates.mjt","message_panel",[t,u,null]);q=t;window.clearTimeout(j);o=function(){$("#message-panel").empty();q=o=null};j=window.setTimeout(o,x);$("#message-panel").slideDown(300)}}var j,o,q;return{doing:function(t,u){h("doing",t,2E6,u);return""},info:function(t,u){h("info",t,4E3,u);return""},error:function(t,u){h("error",t,6E3,u);return""},
clear:function(){window.clearTimeout(j);o&&o()}}}();ui.shortcut={};(function(){var h=[{op:"Code Assist"},{op:"Open App",key:"O",action:function(){ui.do_show_menu("apps",[true])}},{op:"Save File",key:"S",action:function(){ui.do_file_save()}},{op:"View",key:"Shift-P",action:function(){ui.do_run_view(null,false)}},{op:"View with Console",key:"P",action:function(){ui.do_run_view(null,true)}},{op:"Undo",key:"Z",action:function(){ui.do_file_editor_undo()}},{op:"Redo",key:"Shift-Z",action:function(){ui.do_file_editor_redo()}},
{op:"Redo",key:"Y",action:function(){ui.do_file_editor_redo()}},{op:"Check Syntax",key:"Shift-C",action:function(){ui.do_file_check()}},{op:"Expand Expression",key:"E",action:function(){ui.do_zen_coding()}},{op:"Indent Selection",key:"Shift-I",action:function(){ui.do_file_editor_indent()}},{op:"Jump to Line",key:"J",action:function(){$("#linenumber").focus().select()}}],j=navigator.platform.indexOf("Mac")===0?"Meta":"Ctrl";ui.shortcut.register_keys=function(o){$.each(h,function(q,t){shortcut.add(j+
"-"+t.key,t.action,{target:o})})};ui.shortcut.get_shortcuts=function(){return h};ui.shortcut.get_keys=function(o){var q;if(o=="Code Assist")q=(navigator.platform.indexOf("Mac")===0?"Alt-":"Ctrl-")+"Space";else $.each(h,function(t,u){if(u.op==o)q=(navigator.platform.indexOf("Mac")===0?"&#8984;-":"Ctrl-")+u.key});return q}})()})();
$(document).ready(function(){if($.browser.msie&&$.browser.version<"8.0")assert.critical(false,"Internet Explorer 6 and 7 are not supported.  IE8+, Firefox 3+ and Safari 3+ are.Another option is to install <a href='http://www.google.com/chromeframe'>Google Chrome Frame</a>");else{ui.set_store(new FreebaseStore);var e=ui.get_store();e.t_init().onready(function(){ui.set_user(e.get_user());ui.init();e.TestCookies(e).enqueue().onerror(function(){ui.MessagePanel.error("Your browser configuration may not always let you see your latest changes when clicking <b>View</b> (third-party cookies).<br/><br/>Hold down the <b>Shift</b> key when clicking the browser <b>Refresh</b> button to ensure you're seeing the latest.")})}).onerror(function(b,
i,a){assert.critical(false,"Error connecting to Freebase<br/>"+i);mjt.error(b,i,a)})}});
(function(){jQuery&&jQuery(window).trigger("acre.template.register",{pkgid:"//20a.appeditor.www.tags.svn.freebase-site.googlecode.dev/templates.mjt",source:{def:function(){var e=function(){var b=this.tpackage,i=this.exports,a=b._template_fragments,m=b.runtime.new_markuplist(),n=0;m[n++]=a[0];var l=function(){var g=b.runtime.new_markuplist(),f=0;g[f++]=a[1];b.runtime.ondomready(function(){var r=parseInt(ui.get_editor_prefs("flw"));$(window).resize(function(){$("#list-column").width(r);$("#file-margin").css("left",
r);$("#file-column").css("left",r+$("#file-margin").width());var d=$("#fixer"),c=d.offset(),p=$("#file-column").offset(),h=Math.max(c.top+d[0].offsetHeight,$(window).height())-Math.max(p.top,$("#header").height()+1);p=Math.max(c.left+d[0].offsetWidth,$(window).width())-p.left;var j=$("#file-area").offset();d=Math.max(c.top+d[0].offsetHeight,$(window).height())-j.top;$(".row").width(p);$(".column").height(h-1);$("#file-area").height(d-1);$("#file-list").height(d-$("#app-search").height()-$("#app-edits").height());
$(".refresh-right").show();ui.dialog&&ui.dialog.css("left",($(window).width()-ui.dialog.outerWidth())/2)});$("#file-margin").draggable({axis:"x",iframeFix:true,containment:[125,,400],drag:function(){r=$("#file-margin").offset().left;$(window).trigger("resize")},stop:function(){r=$("#file-margin").offset().left;ui.set_editor_prefs({flw:r});$(window).trigger("resize")}});$("#file-area").click(ui.do_click_error)},this);g[f++]=a[2];return g};l=b.runtime.tfunc_factory("body()",l,b,undefined,false);i.body=
l;l.source_microdata=null;m[n++]=a[3];l=function(g){var f=b.runtime.new_markuplist(),r=0;f[r++]=a[4];ui.get_store();ui.get_user();var d=ui.get_app();f[r++]=a[5];if(g=="open")f[r++]=a[6];else if(g=="loading")f[r++]=a[7];else{g=b.runtime.uniqueid("onclick");mjt._eventcb[g]=function(){ui.do_show_menu("appsettings")};f[r++]=a[8];f[r++]=b.runtime.make_attr_safe(g,false);f[r++]=a[9];f[r++]=d.get_display_name();f[r++]=a[10]}f[r++]=a[11];return f};l=b.runtime.tfunc_factory("header(state)",l,b,undefined,false);
i.header=l;l.source_microdata=null;m[n++]=a[12];l=function(){var g=b.runtime.new_markuplist(),f=0;g[f++]=a[13];var r=ui.get_app(),d=r.is_author(),c=r.is_remote(),p=ui.get_user(),h=r.get_versions(),j=r.get_released_version(),o=r.get_version_label(),q=r.get_path(),t=r.get_versioned_path();j=j?q.replace("//","//release."):null;var u=h.length;if(j&&j!=t)u-=1;g[f++]=a[14];if(o){g[f++]=a[15];g[f++]=o;g[f++]=a[16]}else{g[f++]=a[17];o="Current";g[f++]=a[18]}g[f++]=a[19];if(c){g[f++]=a[20];g[f++]=r.get_acre_host();
g[f++]=a[21]}else if(d){g[f++]=a[22];var x=b.runtime.uniqueid("onclick");mjt._eventcb[x]=function(){ui.do_choose_app(ui.get_app().get_path())};g[f++]=a[23];g[f++]=b.runtime.make_attr_safe(x,false);g[f++]=a[24];x=b.runtime.uniqueid("onclick");mjt._eventcb[x]=function(){ui.do_show_dialog("new_app",[true])};g[f++]=a[25];g[f++]=b.runtime.make_attr_safe(x,false);g[f++]=a[26]}else{g[f++]=a[27];r=b.runtime.uniqueid("onclick");mjt._eventcb[r]=function(){ui.do_show_dialog("new_app",[true])};g[f++]=a[28];p=
p?{}:{disabled:"disabled"};"class"in p||(g[f++]=a[29]);"id"in p||(g[f++]=a[30]);if(!("onclick"in p)){g[f++]=a[31];g[f++]=b.runtime.make_attr_safe(r,false);g[f++]=a[32]}for(x in p){g[f++]=" "+x;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+p[x]);g[f++]=b.runtime.bless('"')}g[f++]=a[33]}g[f++]=a[34];if(h.length){g[f++]=a[35];if(j&&j!=t){g[f++]=a[36];g[f++]=b.runtime.make_attr_safe(j,false);g[f++]=a[37];g[f++]=b.runtime.make_attr_safe(ui.get_appeditor_url(j),true);g[f++]=a[38]}g[f++]=a[39];
if(o&&o!="Current"){g[f++]=a[40];g[f++]=b.runtime.make_attr_safe(q,false);g[f++]=a[41];g[f++]=b.runtime.make_attr_safe(ui.get_appeditor_url(q),true);g[f++]=a[42]}g[f++]=a[43];if(u>0){h=b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){return ui.do_show_menu("appsettings",["general"])};g[f++]=a[44];g[f++]=b.runtime.make_attr_safe(h,false);g[f++]=a[45]}g[f++]=a[46]}g[f++]=a[47];return g};l=b.runtime.tfunc_factory("about_bar()",l,b,undefined,false);i.about_bar=l;l.source_microdata=null;m[n++]=
a[48];l=function(){var g=b.runtime.new_markuplist(),f=0;g[f++]=a[49];if(ui.get_app().is_writable()){var r=b.runtime.uniqueid("onclick");mjt._eventcb[r]=function(){ui.do_show_dialog("add_file")};g[f++]=a[50];g[f++]=b.runtime.make_attr_safe(r,false);g[f++]=a[51]}g[f++]=a[52];g[f++]=s();g[f++]=a[53];g[f++]=b.runtime.make_attr_safe(ui.get_app().get_acre_host(),false);g[f++]=a[54];g[f++]=b.runtime.make_attr_safe(ui.get_app().get_path(),false);g[f++]=a[55];return g};l=b.runtime.tfunc_factory("list_column()",
l,b,undefined,false);i.list_column=l;l.source_microdata=null;m[n++]=a[56];var s=function(){var g=b.runtime.new_markuplist(),f=0;g[f++]=a[57];var r=false,d=ui.get_app().get_last_change();if(d)if(+new Date-mjt.freebase.date_from_iso(d.timestamp)<36E5)r=true;g[f++]=a[58];if(r){g[f++]=a[59];g[f++]=d.attribution.name;g[f++]=a[60];g[f++]=mjt.freebase.mqlkey_unquote(d.file);g[f++]=a[61];g[f++]=ui.get_relative_timestamp(d.timestamp);g[f++]=a[62]}g[f++]=a[63];return g};s=b.runtime.tfunc_factory("app_edits()",
s,b,undefined,false);i.app_edits=s;s.source_microdata=null;m[n++]=a[64];l=function(){function g(h,j){var o="file-list-item",q=ui.get_file()?ui.get_file().get_relative_path():null;if(h.get_relative_path()==q)o+=" selected-file";if(h.is_dirty("to_delete"))o+=" deleted-file";if(h.is_dirty())o+=" edited-file";if(ui.get_editor_prefs("c_"+j))o+=" hidden-file";return o}var f=b.runtime.new_markuplist(),r=0;f[r++]=a[65];var d=function(h,j,o,q,t){var u=b.runtime.new_markuplist(),x=0;u[x++]=a[66];u[x++]=b.runtime.make_attr_safe(h,
false);u[x++]=a[67];if(q){u[x++]=a[68];if(ui.get_editor_prefs("c_"+h)){u[x++]=a[69];u[x++]=b.runtime.make_attr_safe(h,false);u[x++]=a[70]}else{u[x++]=a[71];u[x++]=b.runtime.make_attr_safe(h,false);u[x++]=a[72]}u[x++]=a[73];if(t){u[x++]=a[74];u[x++]=b.runtime.make_attr_safe(o.get_path(),false);u[x++]=a[75];u[x++]=b.runtime.make_attr_safe(ui.get_appeditor_url(o.get_path()),true);u[x++]=a[76];u[x++]=j;u[x++]=a[77]}else{u[x++]=a[78];u[x++]=j;u[x++]=a[79]}u[x++]=a[80]}u[x++]=a[81];b.runtime.foreach(this,
q,function(C,w){for(var A=1;A;){if(q){u[x++]=a[82];var E={"class":g(o.get_file(w),h),fname:o.get_file(w).get_relative_path()};for(var F in E){u[x++]=" "+F;u[x++]=b.runtime.bless('="');u[x++]=b.runtime.htmlencode(""+E[F]);u[x++]=b.runtime.bless('"')}u[x++]=a[83];E=b.runtime.uniqueid("onclick");mjt._eventcb[E]=function(){ui.do_show_dialog("delete_file",[w])};u[x++]=a[84];var z=o.is_writable()?{"class":"file-delete"}:{"class":"file-nodelete"};"class"in z||(u[x++]=a[85]);if(!("onclick"in z)){u[x++]=a[86];
u[x++]=b.runtime.make_attr_safe(E,false);u[x++]=a[87]}for(var y in z){u[x++]=" "+y;u[x++]=b.runtime.bless('="');u[x++]=b.runtime.htmlencode(""+z[y]);u[x++]=b.runtime.bless('"')}u[x++]=a[88];u[x++]=b.runtime.make_attr_safe(ui.get_appeditor_url(o.get_file(w)),true);u[x++]=a[89];u[x++]=w;u[x++]=a[90]}A--}return A?b.runtime._break_token:b.runtime._continue_token});u[x++]=a[91];return u};d=b.runtime.tfunc_factory("filelist_section(section_key, section_name, app, filenames, link)",d,b,undefined,false);
d.source_microdata=null;f[r++]=a[92];var c=ui.get_app(),p=ui.order_section_files(c);f[r++]=a[93];b.runtime.foreach(this,ui.get_app().get_acre_handlers(),function(h,j){for(var o=1;o;){f[r++]=a[94];f[r++]=d(h,j.plural_name,c,p[h]);f[r++]=a[95];o--}return o?b.runtime._break_token:b.runtime._continue_token});f[r++]=a[96];if(p.test&&p.test.length){f[r++]=a[97];f[r++]=d("test","Tests",c,p.test);f[r++]=a[98]}f[r++]=a[99];b.runtime.ondomready(function(){$(".file-list-section-toggle").click(function(){var h=
$(this).attr("section");if($(this).text()=="\u25bc"){$(this).text("\u25ba");ui.set_editor_prefs("c_"+h,true);$("ul[section='"+h+"'] .file-list-item").addClass("hidden-file")}else{$(this).text("\u25bc");ui.set_editor_prefs("c_"+h,false);$("ul[section='"+h+"'] .file-list-item").removeClass("hidden-file")}});$("#file-list .file-list-item").click(function(h){if(!(h.ctrlKey||h.metaKey||h.altKey||h.shiftKey)){h=$(this).attr("fname");ui.do_choose_file(h);return false}})},this);f[r++]=a[100];return f};l=
b.runtime.tfunc_factory("file_list()",l,b,undefined,false);i.file_list=l;l.source_microdata=null;m[n++]=a[101];l=function(){var g=b.runtime.new_markuplist(),f=0;g[f++]=a[102];var r=ui.get_app(),d=ui.get_file(),c=r?r.is_writable():false,p=d?d.get_editor_supported_features():false;p=p.margin||p.softwrap||p.hotswap||p.emql;var h=$("#button-fileactions").hasClass("button-open"),j=$("#button-editoroptions").hasClass("button-open");g[f++]=a[103];if(d){g[f++]=a[104];var o=b.runtime.uniqueid("onclick");mjt._eventcb[o]=
function(){ui.do_run_view(null,false)};g[f++]=a[105];var q=d.get_editor_supported_features("inline_preview")?{disabled:"disabled"}:{};"id"in q||(g[f++]=a[106]);if(!("title"in q)){g[f++]=a[107];g[f++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("View")),false);g[f++]=a[108]}if(!("onclick"in q)){g[f++]=a[109];g[f++]=b.runtime.make_attr_safe(o,false);g[f++]=a[110]}for(var t in q){g[f++]=" "+t;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+q[t]);g[f++]=b.runtime.bless('"')}g[f++]=
a[111];t=b.runtime.uniqueid("onclick");mjt._eventcb[t]=function(){ui.do_run_view(null,true)};g[f++]=a[112];o=d.get_editor_supported_features("inline_preview")?{disabled:"disabled"}:{};"class"in o||(g[f++]=a[113]);"id"in o||(g[f++]=a[114]);if(!("title"in o)){g[f++]=a[115];g[f++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("View with Console")),false);g[f++]=a[116]}if(!("onclick"in o)){g[f++]=a[117];g[f++]=b.runtime.make_attr_safe(t,false);g[f++]=a[118]}for(var u in o){g[f++]=" "+u;g[f++]=
b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+o[u]);g[f++]=b.runtime.bless('"')}g[f++]=a[119];u=b.runtime.uniqueid("onclick");mjt._eventcb[u]=function(){ui.do_file_save()};g[f++]=a[120];t=d.is_dirty()?{}:{disabled:"disabled"};"class"in t||(g[f++]=a[121]);"id"in t||(g[f++]=a[122]);if(!("title"in t)){g[f++]=a[123];g[f++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Save File")),false);g[f++]=a[124]}if(!("onclick"in t)){g[f++]=a[125];g[f++]=b.runtime.make_attr_safe(u,false);g[f++]=
a[126]}for(var x in t){g[f++]=" "+x;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+t[x]);g[f++]=b.runtime.bless('"')}g[f++]=a[127];x=b.runtime.uniqueid("onclick");mjt._eventcb[x]=function(){ui.do_app_save_all()};g[f++]=a[128];r=r.is_dirty()?{}:{disabled:"disabled"};"class"in r||(g[f++]=a[129]);"id"in r||(g[f++]=a[130]);if(!("onclick"in r)){g[f++]=a[131];g[f++]=b.runtime.make_attr_safe(x,false);g[f++]=a[132]}for(var C in r){g[f++]=" "+C;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+
r[C]);g[f++]=b.runtime.bless('"')}g[f++]=a[133];C=b.runtime.uniqueid("onclick");mjt._eventcb[C]=function(){ui.do_show_dialog("save_file_as")};g[f++]=a[134];r=!ui.get_user()||d.get_acre_handler()=="binary"?{disabled:"disabled"}:{};"class"in r||(g[f++]=a[135]);"id"in r||(g[f++]=a[136]);if(!("onclick"in r)){g[f++]=a[137];g[f++]=b.runtime.make_attr_safe(C,false);g[f++]=a[138]}for(var w in r){g[f++]=" "+w;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+r[w]);g[f++]=b.runtime.bless('"')}g[f++]=
a[139];w=b.runtime.uniqueid("onclick");mjt._eventcb[w]=function(){ui.do_file_editor_undo()};g[f++]=a[140];C=ui._has_undos?{}:{disabled:"disabled"};"class"in C||(g[f++]=a[141]);"id"in C||(g[f++]=a[142]);if(!("title"in C)){g[f++]=a[143];g[f++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Undo")),false);g[f++]=a[144]}if(!("onclick"in C)){g[f++]=a[145];g[f++]=b.runtime.make_attr_safe(w,false);g[f++]=a[146]}for(var A in C){g[f++]=" "+A;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+
C[A]);g[f++]=b.runtime.bless('"')}g[f++]=a[147];A=b.runtime.uniqueid("onclick");mjt._eventcb[A]=function(){ui.do_file_editor_redo()};g[f++]=a[148];w=ui._has_redos?{}:{disabled:"disabled"};"class"in w||(g[f++]=a[149]);"id"in w||(g[f++]=a[150]);if(!("title"in w)){g[f++]=a[151];g[f++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Redo")),false);g[f++]=a[152]}if(!("onclick"in w)){g[f++]=a[153];g[f++]=b.runtime.make_attr_safe(A,false);g[f++]=a[154]}for(var E in w){g[f++]=" "+E;g[f++]=b.runtime.bless('="');
g[f++]=b.runtime.htmlencode(""+w[E]);g[f++]=b.runtime.bless('"')}g[f++]=a[155];E=b.runtime.uniqueid("onclick");mjt._eventcb[E]=function(){ui.do_file_editor_indent()};g[f++]=a[156];c=d.get_editor_supported_features("indent")&&c?{}:{disabled:"disabled"};"id"in c||(g[f++]=a[157]);if(!("title"in c)){g[f++]=a[158];g[f++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Indent Selection")),false);g[f++]=a[159]}if(!("onclick"in c)){g[f++]=a[160];g[f++]=b.runtime.make_attr_safe(E,false);g[f++]=a[161]}for(var F in c){g[f++]=
" "+F;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+c[F]);g[f++]=b.runtime.bless('"')}g[f++]=a[162];F=b.runtime.uniqueid("onclick");mjt._eventcb[F]=function(){ui.do_show_menu("fileactions")};g[f++]=a[163];h=h?{"class":"button-open"}:{};"class"in h||(g[f++]=a[164]);"id"in h||(g[f++]=a[165]);if(!("onclick"in h)){g[f++]=a[166];g[f++]=b.runtime.make_attr_safe(F,false);g[f++]=a[167]}for(var z in h){g[f++]=" "+z;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+h[z]);g[f++]=b.runtime.bless('"')}g[f++]=
a[168];z=b.runtime.uniqueid("onclick");mjt._eventcb[z]=function(){ui.do_show_menu("editoroptions")};g[f++]=a[169];p=j?{"class":"button-open"}:p?{}:{disabled:"disabled"};"class"in p||(g[f++]=a[170]);"id"in p||(g[f++]=a[171]);if(!("onclick"in p)){g[f++]=a[172];g[f++]=b.runtime.make_attr_safe(z,false);g[f++]=a[173]}for(var y in p){g[f++]=" "+y;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+p[y]);g[f++]=b.runtime.bless('"')}g[f++]=a[174];y=b.runtime.uniqueid("onclick");mjt._eventcb[y]=function(){ui.do_show_menu("help")};
g[f++]=a[175];g[f++]=b.runtime.make_attr_safe(y,false);g[f++]=a[176];if(d.get_editor_supported_features("linenumbers")){g[f++]=a[177];g[f++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Jump to Line")),false);g[f++]=a[178];g[f++]=b.runtime.make_attr_safe(ui.get_line()||"",false);g[f++]=a[179]}g[f++]=a[180]}g[f++]=a[181];b.runtime.ondomready(function(){$("#linenumber").keypress(function(v){if(v.which==13){v=parseInt($("#linenumber").val(),10);ui.do_file_editor_goto_line(v)}})},this);g[f++]=
a[182];return g};l=b.runtime.tfunc_factory("button_bar()",l,b,undefined,false);i.button_bar=l;l.source_microdata=null;m[n++]=a[183];l=function(){var g=b.runtime.new_markuplist(),f=0;g[f++]=a[184];var r=ui.get_app().is_writable();g[f++]=a[185];var d=b.runtime.uniqueid("onclick");mjt._eventcb[d]=function(){ui.get_file()._current_editor.query_run()};g[f++]=a[186];g[f++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("View")),false);g[f++]=a[187];g[f++]=b.runtime.make_attr_safe(d,false);g[f++]=
a[188];d=b.runtime.uniqueid("onclick");mjt._eventcb[d]=function(){ui.get_file()._current_editor.query_assist()};g[f++]=a[189];var c=r?{}:{disabled:"disabled"};"title"in c||(g[f++]=a[190]);if(!("onclick"in c)){g[f++]=a[191];g[f++]=b.runtime.make_attr_safe(d,false);g[f++]=a[192]}for(var p in c){g[f++]=" "+p;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+c[p]);g[f++]=b.runtime.bless('"')}g[f++]=a[193];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){ui.get_file()._current_editor.generate_template()};
g[f++]=a[194];r=r?{}:{disabled:"disabled"};if(!("onclick"in r)){g[f++]=a[195];g[f++]=b.runtime.make_attr_safe(p,false);g[f++]=a[196]}for(var h in r){g[f++]=" "+h;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+r[h]);g[f++]=b.runtime.bless('"')}g[f++]=a[197];return g};l=b.runtime.tfunc_factory("query_button_bar()",l,b,undefined,false);i.query_button_bar=l;l.source_microdata=null;m[n++]=a[198];n=function(g,f,r){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[199];d[c++]=b.runtime.make_attr_safe(g,
false);d[c++]=a[200];if(this.subst_id)d[c++]=b.runtime.bless(' id="'+this.subst_id+'"');d[c++]=a[201];d[c++]=b.runtime.make_attr_safe(g,false);d[c++]=a[202];d[c++]=f;d[c++]=a[203];d[c++]=r||"";d[c++]=a[204];b.runtime.ondomready(function(){$("#message-panel-close").click(function(){ui.MessagePanel.clear()})},this);d[c++]=a[205];return d};n=b.runtime.tfunc_factory("message_panel(type, msg, tid)",n,b,undefined,false);i.message_panel=n;n.source_microdata=null;return m};e.source_microdata=null;return e}(),
info:{file:"//20a.appeditor.www.tags.svn.freebase-site.googlecode.dev/templates.mjt",stringtable:["\n\n<!-- called by ui.init --\>",'\n  <div id="message-panel"></div>\n  <div id="about-bar"></div>\n  <div id="columns">\n    <div class="refresh column" id="list-column"></div>\n    <div class="refresh column" id="file-margin"></div>\n    <div class="column row" id="file-column">\n      <div class="refresh" id="button-bar"></div>\n      <div class="refresh" id="file-area"></div>\n    </div>\n  </div>',
"","\n\n<!-- called by ui.refresh_app_templates --\>    ","","",'\n  <p>\n    <span class="app-name">Acre App Editor</span>\n  </p>','\n  <p><span class="app-name">Loading...</span></p>','\n  <div class="app-name" id="button-appsettings" onclick="return mjt._eventcb.','.apply(this, [event])">\n    <p><span class="button-menu">',"</span></p>\n  </div>","","\n\n<!-- called by ui.refresh_app_templates --\>","",'\n  <div class="column left" id="about-bar-left">',"\n      <span>\n        Version ","\n      </span>",
"\n      <span>","\n        Current \n      </span>",'\n  </div>\n  <div class="column margin" id="about-bar-margin"> </div>\n  <div class="column row" id="about-bar-middle">',"\n    <div>\n      <h2><em>This app is hosted on ","</em></h2>\n    </div>","\n    <div>",'\n      <button class="button-main" id="button-trunk" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Edit Current</button>\n      or','\n      <button id="button-clone" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Clone this App</button>      \n    </div>',
"\n    <div>","\n      <button",' class="button-main"',' id="button-clone"',' onclick="return mjt._eventcb.','.apply(this, [event])"',">\n        Clone this App</button> \n        Sign in to make an app based on this one!\n    </div>",'\n    <div class="refresh-right" id="about-bar-right">',"\n      <span><b>\n        Versions:",'\n        <a apppath="','" class="app-link" href="','">Release</a>',"",'\n        <a apppath="','" class="app-link" href="','">Current</a>',"",'\n        <a href="#0" onclick="return mjt._eventcb.',
'.apply(this, [event])">more...</a>',"\n      </b></span>","\n    </div>\n  </div>","","",'\n  <button id="button-new-file" onclick="return mjt._eventcb.','.apply(this, [event])">\n    New File</button>','\n  <h1>Files</h1>\n  \n  <div id="file-list"></div>\n  <div id="app-edits-shim">\n    ','\n  </div>\n  \n  <div id="app-search">\n    <form action="http://codesearch.','/" id="codesearch-form" target="_blank">\n      <div class="file-list-section-title">Find code in app:</div>\n      <input id="codesearch-app" name="app" type="hidden" value="',
'">\n      <input name="q" type="text" value="">\n    </form>\n  </div>',"","","",'\n    <div id="app-edits">\n      <div class="content">\n        <span class="file-list-section-title">Active Author: </span>\n        <span class="change">\n          '," edited '","' ","\n        </span>\n      </div>\n    </div>","","\n\n<!-- called by ui.refresh_file_templates --\>  ","",'\n    <ul section="','">','\n      <li class="file-list-section-header">','\n        <span class="file-list-section-toggle" section="',
'">\u25ba</span>','\n        <span class="file-list-section-toggle" section="','">\u25bc</span>',"",'\n        <a apppath="','" class="file-list-section-title app-link" href="','">',"</a>",'\n        <span class="file-list-section-title">',"</span>","\n      </li>","","\n      <li",">","\n          <div",' class="file-delete"',' onclick="return mjt._eventcb.','.apply(this, [event])"','></div>\n          <a href="','">',"</a>\n      </li>","\n    </ul>","","","\n\n  <div>\n    ","\n  </div>","","\n  <div>\n    ",
"\n  </div>","","","\n\n<!-- called by ui.refresh_file_templates --\>  ","",'\n    <div id="file-buttons">','\n      <div>\n      <div class="refresh-right" id="file-buttons-right">\n        <!-- mjt.bless for system control characters (HTML entities) declared in ui.shortcut --\>',"\n        <button",' id="button-view"',' title="','"',' onclick="return mjt._eventcb.','.apply(this, [event])"',">\n          View</button>","\n        <button",' class="button-main"',' id="button-preview"',' title="',
'"',' onclick="return mjt._eventcb.','.apply(this, [event])"','>\n          View with Console</button>\n      </div>\n      <span class="buttonset">\n        <!-- mjt.bless for system control characters (HTML entities) declared in ui.shortcut --\>',"\n        <button",' class="button-left button-main"',' id="button-save"',' title="','"',' onclick="return mjt._eventcb.','.apply(this, [event])"',">\n          Save\n        </button>","<button",' class="button-middle"',' id="button-saveall"',' onclick="return mjt._eventcb.',
'.apply(this, [event])"',">\n          Save All\n        </button>","<button",' class="button-right"',' id="button-save"',' onclick="return mjt._eventcb.','.apply(this, [event])"',">\n          Save As</button>","\n        <button",' class="button-left"',' id="button-undo"',' title="','"',' onclick="return mjt._eventcb.','.apply(this, [event])"',">\n          Undo\n        </button>","<button",' class="button-right"',' id="button-redo"',' title="','"',' onclick="return mjt._eventcb.','.apply(this, [event])"',
">\n          Redo</button>","\n        <button",' id="button-indent"',' title="','"',' onclick="return mjt._eventcb.','.apply(this, [event])"','>\n          Indent\n        </button>\n      </span>\n      <span class="buttonset">',"\n       <button",' class="button-left"',' id="button-fileactions"',' onclick="return mjt._eventcb.','.apply(this, [event])"','>    \n          <span class="button-menu">File</span></button>',"<button",' class="button-middle"',' id="button-editoroptions"',' onclick="return mjt._eventcb.',
'.apply(this, [event])"','>\n          <span class="button-menu">Editor</span></button>','<button class="button-right" id="button-help" onclick="return mjt._eventcb.','.apply(this, [event])">\n          <span class="button-menu">Help</span></button>\n      </span>\n      <span class="buttoncount">\n        <!-- mjt.bless for system control characters (HTML entities) declared in ui.shortcut --\>','\n        <span class=" buttonset linecount">\n          Line <input class="form-textbox" id="linenumber" title="',
'" type="text" value="','">\n        </span>',"\n      </span>\n    </div>","","\n  </div>","",'<div id="query-editor-buttons">',"\n  <!-- mjt.bless for system control characters (HTML entities) declared in ui.shortcut --\>",'\n  <button class="button-main" title="','" onclick="return mjt._eventcb.','.apply(this, [event])">\n    Run</button>',"\n  <button",' title="Tab"',' onclick="return mjt._eventcb.','.apply(this, [event])"',">Query Assist</button>","\n  <button",' onclick="return mjt._eventcb.',
'.apply(this, [event])"',">Create Template</button>\n</div>","\n\n<!-- utilities --\>  ",'<div class="message-','"','>\n  <!--<span id="message-panel-close">x</span>--\>\n  <div class="message-icon ','"></div>','\n  <span class="message-tid">',"</span>","\n</div>"],debug_locs:[1,1,1,1,1,1,7,7,7,7,7,7,18,18,18,18,18,18,18,18,18,18,18,18,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,68,68,68,68,
68,70,70,70,70,70,70,71,71,72,73,74,75,76,76,78,78,78,78,78,79,79,79,79,80,80,80,80,80,80,80,81,81,81,82,82,82,83,83,83,83,83,83,86,86,86,86,86,86,87,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,103,103,104,104,104,104,105,105,105,106,107,107,107,110,110,110,110,113,113,113,113,113,114,114,114,114,115,115,115,116,117,117,117,117,117,117,117,117,120,120,120,120,120,120,120,120,120,122,122,122,122,123,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,
127,127,127,127,127,129,129,129,131,131,131,131,131,131,131,131,131,131,131,132,132,132,132,132,132,132,132,132,133,133,133,133,133,133,133,133,133,133,134,134,134,137,137,137,137,137,137,137,137,139,139,139,139,140,140,140,140,140,140,140,140,141,141,141,146,146,146,146,146,146,146,150,150,150,150,150,150,152,152,152,152,156,156,156,156,156,156,156,156,156,158,158,158,158,159,159,160,161,162,163,164,165,166,167,167,171,171,171,171,171,171,171,171,171,171,171,174,174,174,174,174,175,175,175,175,175,
175,178,178,178,178,178,178,180,180,180,180,181,181,181,182,182,183,183,183,183,183,183,183,183,184,184,184,184,184,184,186,186,186,186,186,186,186,186,186,186,186,187,187,187,187,187,187,188,188,188,190,190,190,190,190,190,190,190,190,190,190,190,190,190,190,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191,192,192,192,192,192,193,193,193,193,193,193,193,195,195,195,195,195,195,197,197,198,199,200,201,202,203,204,205,206,207,208,209,210,212,212,212,212,213,213,213,213,
213,214,214,214,214,214,214,215,215,216,216,216,216,217,217,217,219,219,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,244,244,244,244,244,246,246,246,246,246,246,247,247,248,249,250,251,252,253,254,255,256,257,259,259,259,263,263,263,263,263,263,263,263,263,263,263,263,263,263,263,263,263,263,263,263,263,263,263,263,263,263,263,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,272,272,
272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,272,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,
284,284,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,293,293,293,293,293,293,293,293,293,293,293,293,293,293,293,293,293,293,293,293,293,293,293,293,293,293,295,295,295,295,295,295,295,295,295,295,295,295,295,295,295,295,295,295,295,295,295,295,296,296,296,296,296,296,296,301,301,301,301,301,301,302,302,302,302,302,302,303,303,303,305,305,305,305,306,306,306,307,308,309,310,311,312,313,314,316,316,316,316,316,316,316,317,317,317,317,318,318,319,
320,322,322,322,322,322,322,322,322,322,322,325,325,325,325,325,325,325,325,325,325,325,325,325,325,325,325,325,325,325,325,325,327,327,327,327,327,327,327,327,327,327,327,327,327,327,327,327,327,327,328,328,328,328,328,328,328,331,331,331,331,331,331,331,331,331,331,333,333,333,333,333,333,334,334,334,335,335,335,336,337,338,339,340,341,341,341,341,341,341,341,341,341,341],output_mode:"html"}}})})(window.freebase.acre,window.freebase.h);
(function(){jQuery&&jQuery(window).trigger("acre.template.register",{pkgid:"//20a.appeditor.www.tags.svn.freebase-site.googlecode.dev/dialogs.mjt",source:{def:function(){var e=function(){var b=this.tpackage,i=this.exports,a=b._template_fragments,m=b.runtime.new_markuplist(),n=0;m[n++]=a[0];var l=function(s){var g=b.runtime.new_markuplist(),f=0;g[f++]=a[1];var r=b.runtime.uniqueid("onclick");mjt._eventcb[r]=function(){ui.do_choose_app(s)};g[f++]=a[2];g[f++]=b.runtime.make_attr_safe(r,false);g[f++]=
a[3];return g};l=b.runtime.tfunc_factory("files_dirty(new_app)",l,b,undefined,false);i.files_dirty=l;l.source_microdata=null;m[n++]=a[4];l=function(s){var g=b.runtime.new_markuplist(),f=0;g[f++]=a[5];if(s){g[f++]=a[6];g[f++]=b.runtime.make_attr_safe(ui.get_store().get_freebase_url(),true);g[f++]=a[7];g[f++]=b.runtime.make_attr_safe(ui.get_store().get_freebase_url(),true);g[f++]=a[8];s=b.runtime.uniqueid("onclick");mjt._eventcb[s]=function(){ui.do_show("new_app")};g[f++]=a[9];g[f++]=b.runtime.make_attr_safe(s,
false);g[f++]=a[10];s=b.runtime.uniqueid("onclick");mjt._eventcb[s]=function(){ui.do_show_menu("yourapps")};g[f++]=a[11];g[f++]=b.runtime.make_attr_safe(s,false);g[f++]=a[12]}else{g[f++]=a[13];g[f++]=b.runtime.make_attr_safe(ui.get_store().get_freebase_url(),true);g[f++]=a[14];g[f++]=b.runtime.make_attr_safe(ui.get_store().get_freebase_url(),true);g[f++]=a[15]}g[f++]=a[16];return g};l=b.runtime.tfunc_factory("welcome(is_user)",l,b,undefined,false);i.welcome=l;l.source_microdata=null;m[n++]=a[17];
l=function(s){var g=b.runtime.new_markuplist(),f=0;g[f++]=a[18];var r=s?ui.get_app().get_display_name()+" copy":"",d=s?ui.get_app().get_name()+"-copy":"";g[f++]=a[19];var c=s?{}:{checked:"checked"};"id"in c||(g[f++]=a[20]);"name"in c||(g[f++]=a[21]);"type"in c||(g[f++]=a[22]);"value"in c||(g[f++]=a[23]);for(var p in c){g[f++]=" "+p;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+c[p]);g[f++]=b.runtime.bless('"')}g[f++]=a[24];c=s?{checked:"checked"}:{};"id"in c||(g[f++]=a[25]);"name"in
c||(g[f++]=a[26]);"type"in c||(g[f++]=a[27]);"value"in c||(g[f++]=a[28]);for(var h in c){g[f++]=" "+h;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+c[h]);g[f++]=b.runtime.bless('"')}g[f++]=a[29];h=s?{}:{style:"display:none"};"id"in h||(g[f++]=a[30]);for(var j in h){g[f++]=" "+j;g[f++]=b.runtime.bless('="');g[f++]=b.runtime.htmlencode(""+h[j]);g[f++]=b.runtime.bless('"')}g[f++]=a[31];g[f++]=b.runtime.make_attr_safe(s?ui.get_app().get_versioned_path():"",false);g[f++]=a[32];g[f++]=b.runtime.make_attr_safe(r,
false);g[f++]=a[33];g[f++]=b.runtime.make_attr_safe(d,false);g[f++]=a[34];g[f++]=ui.get_user().get_new_app_host();g[f++]=a[35];b.runtime.ondomready(function(){$("#new-app-dialog-name").focus().select();$("#dialog-new_app input[name='new-app']").change(function(){$("#new-app-clone-field").toggle()});$("#new-app-clone-id").suggest({type:"/freebase/apps/acre_app",filter:"(any type:/freebase/apps/acre_app)"}).bind("fb-select",function(o,q){$(this).val(ui.id_to_path(q.id))});$("#button-new-app").click(function(){var o=
[ui.get_user().get_new_app_path($.trim($("#new-app-dialog-key").val())),$.trim($("#new-app-dialog-name").val())],q=$("#dialog-new_app input[name='new-app']:checked").val(),t=$("#new-app-clone-id").val();q=="clone"&&t!==""&&o.push(t);ui.do_app_create_new.apply(this,o)})},this);g[f++]=a[36];return g};l=b.runtime.tfunc_factory("new_app(clone)",l,b,undefined,false);i.new_app=l;l.source_microdata=null;m[n++]=a[37];l=function(){var s=b.runtime.new_markuplist(),g=0;s[g++]=a[38];s[g++]=ui.get_app().get_display_name();
s[g++]=a[39];var f=b.runtime.uniqueid("onclick");mjt._eventcb[f]=function(){ui.do_app_delete()};s[g++]=a[40];s[g++]=b.runtime.make_attr_safe(f,false);s[g++]=a[41];return s};l=b.runtime.tfunc_factory("delete_app()",l,b,undefined,false);i.delete_app=l;l.source_microdata=null;m[n++]=a[42];l=function(){var s=b.runtime.new_markuplist(),g=0;s[g++]=a[43];var f=function(r){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[44];ui.app_keys={};$.each(r,function(){ui.app_keys[this.path]=this.files});d[c++]=a[45];
d[c++]=b.runtime.make_attr_safe(ui.get_file().get_name(),false);d[c++]=a[46];b.runtime.foreach(this,r,function(p,h){for(var j=1;j;){d[c++]=a[47];var o=ui.get_app().get_path()==h.path?{selected:true}:{};if(!("value"in o)){d[c++]=a[48];d[c++]=b.runtime.make_attr_safe(h.path,false);d[c++]=a[49]}for(var q in o){d[c++]=" "+q;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+o[q]);d[c++]=b.runtime.bless('"')}d[c++]=a[50];d[c++]=h.name;d[c++]=a[51];j--}return j?b.runtime._break_token:b.runtime._continue_token});
d[c++]=a[52];b.runtime.ondomready(function(){$("#clone-filename").focus().select();$("#button-clone").click(function(){var p=$.trim($("#clone-filename").val()),h=$.trim($("#clone-file-app :selected").val());if($.inArray(p,ui.app_keys[h])==-1){ui.do_file_save_as(h,p);ui.do_hide_overlays()}else ui.MessagePanel.error("File exists!  Try a different file name.")})},this);d[c++]=a[53];return d};f=b.runtime.tfunc_factory("save_file_applist(applist)",f,b,undefined,false);f.source_microdata=null;s[g++]=a[54];
b.runtime.ondomready(function(){ui.get_store().XhrGet("list_user_apps",{include_filenames:true}).enqueue().onready(function(r){$("#applist").acre(f(r))})},this);s[g++]=a[55];return s};l=b.runtime.tfunc_factory("save_file_as()",l,b,undefined,false);i.save_file_as=l;l.source_microdata=null;m[n++]=a[56];l=function(){var s=b.runtime.new_markuplist(),g=0;s[g++]=a[57];var f=ui.get_app().get_untitled_file_name();s[g++]=a[58];var r=function(d){var c=b.runtime.new_markuplist(),p=0;c[p++]=a[59];var h=ui.get_app().get_supported_mime_types(d);
c[p++]=a[60];if(h.length>1&&d!="binary"){c[p++]=a[61];b.runtime.foreach(this,h,function(j,o){for(var q=1;q;){c[p++]=a[62];var t=o=="text/plain"?{selected:""}:{};if(!("value"in t)){c[p++]=a[63];c[p++]=b.runtime.make_attr_safe(o,false);c[p++]=a[64]}for(var u in t){c[p++]=" "+u;c[p++]=b.runtime.bless('="');c[p++]=b.runtime.htmlencode(""+t[u]);c[p++]=b.runtime.bless('"')}c[p++]=a[65];c[p++]=o;c[p++]=a[66];q--}return q?b.runtime._break_token:b.runtime._continue_token});c[p++]=a[67]}c[p++]=a[68];return c};
r=b.runtime.tfunc_factory("show_mime_types(handler)",r,b,undefined,false);r.source_microdata=null;s[g++]=a[69];s[g++]=b.runtime.make_attr_safe(f,false);s[g++]=a[70];b.runtime.foreach(this,ui.get_app().get_acre_handlers(),function(d,c){for(var p=1;p;){s[g++]=a[71];s[g++]=b.runtime.make_attr_safe(c.key,false);s[g++]=a[72];s[g++]=b.runtime.make_attr_safe(c.key,false);s[g++]=a[73];s[g++]=c.key;s[g++]=a[74];p--}return p?b.runtime._break_token:b.runtime._continue_token});s[g++]=a[75];b.runtime.ondomready(function(){$("#add-file-name").select().keydown(function(d){d.which==
13&&$("#button-add-file").click()});ui.watch_inputs("add-file",{inputs:{"add-file-handler":null},change:function(d){(d=d["add-file-handler"])?$("#add-file-mimetype-container").acre(r(d)):$("#add-file-mimetype-container").empty()},submit:function(){var d=$.trim($("#add-file-name").val());if(ui.get_store().validate_filename(d)){var c={};if($("#add-file-handler :selected").val())c.handler=$("#add-file-handler :selected").val();if($("#add-file-mimetype :selected").val())c.content_type=$("#add-file-mimetype :selected").val();
ui.do_file_create_new(d,c);ui.do_hide_overlays()}else ui.MessagePanel.error("Invalid filename.  Only alphanumeric characters, '-', '_' and '.' are allowed.")}})},this);s[g++]=a[76];return s};l=b.runtime.tfunc_factory("add_file()",l,b,undefined,false);i.add_file=l;l.source_microdata=null;m[n++]=a[77];l=function(s){var g=b.runtime.new_markuplist(),f=0;g[f++]=a[78];g[f++]=s;g[f++]=a[79];g[f++]=s;g[f++]=a[80];var r=b.runtime.uniqueid("onclick");mjt._eventcb[r]=function(){ui.do_file_delete(s)};g[f++]=
a[81];g[f++]=b.runtime.make_attr_safe(r,false);g[f++]=a[82];return g};l=b.runtime.tfunc_factory("delete_file(filename)",l,b,undefined,false);i.delete_file=l;l.source_microdata=null;m[n++]=a[83];l=function(s,g){var f=b.runtime.new_markuplist(),r=0;f[r++]=a[84];var d=function(z,y){var v=b.runtime.new_markuplist(),B=0;v[B++]=a[85];if(this.subst_id)v[B++]=b.runtime.bless(' id="'+this.subst_id+'"');v[B++]=a[86];var I=z[0]||{},G=false,K=false,J=false;if(I.revision)if(I.file)K=true;else J=true;else G=true;
I=ui.get_file().get_based_on();v[B++]=a[87];if(J&&I){v[B++]=a[88];v[B++]=ui.get_file().get_name();v[B++]=a[89];v[B++]=b.runtime.make_attr_safe(ui.get_store().get_url(),true);v[B++]=a[90];v[B++]=b.runtime.make_attr_safe(I.id,false);v[B++]=a[91];v[B++]=I.id;v[B++]=a[92]}v[B++]=a[93];if(G)v[B++]=a[94];v[B++]=a[95];if(K)v[B++]=a[96];v[B++]=a[97];if(J)v[B++]=a[98];v[B++]=a[99];if(K||J)v[B++]=a[100];v[B++]=a[101];if(G)v[B++]=a[102];v[B++]=a[103];if(K)v[B++]=a[104];v[B++]=a[105];if(J)v[B++]=a[106];v[B++]=
a[107];if(K||J)v[B++]=a[108];v[B++]=a[109];b.runtime.foreach(this,z,function(H,D){for(var L=1;L;){v[B++]=a[110];var N;if(G)N=D.as_of_time;if(K||J)N=D.timestamp;v[B++]=a[111];v[B++]=b.runtime.make_attr_safe(N,false);v[B++]=a[112];v[B++]=b.runtime.make_attr_safe(N,false);v[B++]=a[113];if(G){v[B++]=a[114];v[B++]=D.name;v[B++]=a[115]}v[B++]=a[116];if(K){v[B++]=a[117];v[B++]=mjt.freebase.mqlkey_unquote(D.file);v[B++]=a[118]}v[B++]=a[119];v[B++]=mjt.freebase.date_from_iso(D.as_of_time||D.timestamp).toLocaleString();
v[B++]=a[120];if(J){v[B++]=a[121];v[B++]=D.length;v[B++]=a[122]}v[B++]=a[123];if(K||J){v[B++]=a[124];v[B++]=D.attribution.name;v[B++]=a[125]}v[B++]=a[126];L--}return L?b.runtime._break_token:b.runtime._continue_token});v[B++]=a[127];b.runtime.ondomready(function(){function H(){$("input[name='diff-from'], input[name='diff-to']").removeAttr("disabled");var D=$("input[name='diff-to']").index($("input[name='diff-to']:checked")[0]),L=$("input[name='diff-from']").index($("input[name='diff-from']:checked")[0]);
$("input[name='diff-to']").slice(0,L+1).attr("disabled","disabled");$("input[name='diff-from']").slice(D).attr("disabled","disabled")}$("#dialog-diff_patch input, .show-revision, .revert-revision, .diff-button").unbind("click");H();$("input[name='diff-from'], input[name='diff-to']").click(function(){$(".button-patch").attr("disabled","disabled");var D={timestamp1:$("input[name='diff-to']:checked").val(),timestamp2:$("input[name='diff-from']:checked").val()};if(G||K){$("#diff-filelist-shim").acre(p(true));
$("#diff-view-shim").acre(j());D.appid1=y;D.appid2=y;ui.get_store().XhrGet("get_app_diff",D).enqueue().onready(function(L){$("#diff-filelist-shim").acre(p(L))})}if(J){D.fileid1=y;D.fileid2=y;ui.get_store().XhrGet("get_file_diff",D).enqueue().onready(function(L){$("#diff-view-shim").acre(j(L,"get_file_diff"));$("#button-file-revert, #button-file-revert-save").removeAttr("disabled").unbind("click");$("#button-file-revert").click(function(){ui.do_file_apply_change(L)});$("#button-file-revert-save").click(function(){ui.do_file_apply_change(L,
true)})})}H()})},this);v[B++]=a[128];return v};d=b.runtime.tfunc_factory("revision_list(history, id)",d,b,undefined,false);d.source_microdata=null;f[r++]=a[129];var c=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[130];y[v++]=p(z);y[v++]=a[131];return y};c=b.runtime.tfunc_factory("filelist_shim(patch)",c,b,undefined,false);c.source_microdata=null;f[r++]=a[132];var p=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[133];if(z&&z.files){y[v++]=a[134];ui.get_app().get_path();var B=
[];if($.isArray(z.files))B=z.files;else for(key in z.files)B.push(key);B.sort(function(K,J){return K.localeCompare(J)});y[v++]=a[135];var I=function(K,J){var H=b.runtime.new_markuplist(),D=0;H[D++]=a[136];if(J){H[D++]=a[137];if(s!=="app_diff"){H[D++]=a[138];var L=J==="update"?{checked:"checked"}:{};"type"in L||(H[D++]=a[139]);for(var N in L){H[D++]=" "+N;H[D++]=b.runtime.bless('="');H[D++]=b.runtime.htmlencode(""+L[N]);H[D++]=b.runtime.bless('"')}H[D++]=a[140]}H[D++]=a[141];L=s==="app_diff"?{"class":"diff-filelist-stub"}:
{};"href"in L||(H[D++]=a[142]);for(var M in L){H[D++]=" "+M;H[D++]=b.runtime.bless('="');H[D++]=b.runtime.htmlencode(""+L[M]);H[D++]=b.runtime.bless('"')}H[D++]=a[143];H[D++]=mjt.freebase.mqlkey_unquote(K);H[D++]=a[144]}else{H[D++]=a[145];H[D++]=mjt.freebase.mqlkey_unquote(K);H[D++]=a[146]}H[D++]=a[147];switch(J){case "add":H[D++]=a[148];break;case "delete":H[D++]=a[149];break;case "conflict":H[D++]=a[150];break;case "update":H[D++]=a[151];break}H[D++]=a[152];return H};I=b.runtime.tfunc_factory("diff_file(fn, status)",
I,b,undefined,false);I.source_microdata=null;y[v++]=a[153];var G=b.runtime.uniqueid("onclick");mjt._eventcb[G]=function(){$("#diff-filelist input").attr("checked","checked")};y[v++]=a[154];y[v++]=b.runtime.make_attr_safe(G,false);y[v++]=a[155];G=b.runtime.uniqueid("onclick");mjt._eventcb[G]=function(){$("#diff-filelist input").removeAttr("checked")};y[v++]=a[156];y[v++]=b.runtime.make_attr_safe(G,false);y[v++]=a[157];b.runtime.foreach(this,B,function(K,J){for(var H=1;H;){y[v++]=a[158];y[v++]=b.runtime.make_attr_safe(J,
false);y[v++]=a[159];y[v++]=mjt.freebase.mqlkey_unquote(J);y[v++]=a[160];H--}return H?b.runtime._break_token:b.runtime._continue_token});y[v++]=a[161];b.runtime.ondomready(function(){var K=$("#diff-filelist .file-list-item").length;$("#diff-filelist .file-list-item").each(function(){function J(M,O,P){$(H).acre(I(D,M)).click(function(){$("#diff-filelist .file-list-item").removeClass("selected-file");$(H).addClass("selected-file");$("#diff-view-shim").acre(O.apply(this,P))});K-=1;if(K===0){$(".button-patch").removeAttr("disabled");
$("#diff-filelist .file-list-item input").click(function(Q){Q.stopPropagation()})}}var H=$(this),D=$(H).attr("data-fn"),L,N={};switch(s){case "app_history":case "app_diff":L="get_file_diff";N={fileid1:z.files[D].file1?z.files[D].file1.fileid:undefined,fileid2:z.files[D].file2?z.files[D].file2.fileid:undefined,timestamp1:z.app1?z.app1.timestamp:undefined,timestamp2:z.app2?z.app2.timestamp:undefined};break;case "merge_changes":L="get_file_merge";N={fileid1:z.files[D].file1?z.files[D].file1.fileid:undefined,
fileid2:z.files[D].file2?z.files[D].file2.fileid:undefined};break}ui.get_store().XhrGet(L,N).enqueue().onready(function(M){z.files[D]=M;status=M.file1?M.file2?M.patch&&M.patch.conflict==true?"conflict":"update":"add":"delete";J(status,j,[z.files[D],L])}).onerror(function(M,O,P){J(false,o,[O,P])})})},this);y[v++]=a[162]}else if(z)y[v++]=a[163];else y[v++]=a[164];y[v++]=a[165];b.runtime.ondomready(function(){$(".patch-apply, .patch-apply-save").unbind("click");$(".patch-apply, .patch-apply-save").click(function(){var K=
[];$("#diff-filelist input:checked").each(function(){var J=$(this).closest(".file-list-item").attr("data-fn");K.push(J)});ui.do_app_apply_changes(z,K,$(this).hasClass("patch-apply-save"))})},this);y[v++]=a[166];return y};p=b.runtime.tfunc_factory("filelist(patch)",p,b,undefined,false);p.source_microdata=null;f[r++]=a[167];var h=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[168];y[v++]=j(z);y[v++]=a[169];return y};h=b.runtime.tfunc_factory("diff_view_shim(diff)",h,b,undefined,false);h.source_microdata=
null;f[r++]=a[170];var j=function(z,y){var v=b.runtime.new_markuplist(),B=0;v[B++]=a[171];if(z){v[B++]=a[172];b.runtime.ondomready(function(){ui.populate_diff($("#diff-view"),z,y)},this);v[B++]=a[173]}else v[B++]=a[174];v[B++]=a[175];return v};j=b.runtime.tfunc_factory("diff_view(data, method)",j,b,undefined,false);j.source_microdata=null;f[r++]=a[176];var o=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[177];y[v++]=z;y[v++]=a[178];return y};o=b.runtime.tfunc_factory("merge_error(msg, info)",
o,b,undefined,false);o.source_microdata=null;f[r++]=a[179];var q=function(){var z=b.runtime.new_markuplist(),y=0;z[y++]=a[180];var v=function(){var B=b.runtime.new_markuplist(),I=0;B[I++]=a[181];B[I++]=c();B[I++]=a[182];B[I++]=h();B[I++]=a[183];return B};v=b.runtime.tfunc_factory("history_diff()",v,b,undefined,false);v.source_microdata=null;z[y++]=a[184];if(w)z[y++]=a[185];z[y++]=a[186];if(w)z[y++]=a[187];z[y++]=a[188];b.runtime.ondomready(function(){function B(I){$("#revision-list-shim").empty().addClass("loader-square");
(I=="versions"?mjt.Succeed(ui.get_app().get_versions()):ui.get_app().t_get_history()).enqueue().onready(function(G){$("#revision-list-shim").removeClass("loader-square").acre(d(G.history||G,ui.get_app().get_path()));$("#history-diff").acre(v());$(".button-patch").attr("disabled","disabled")})}$('input[name="app-history"]').change(function(){B($(this).val())});B("versions")},this);z[y++]=a[189];return z};q=b.runtime.tfunc_factory("app_history(t)",q,b,undefined,false);q.source_microdata=null;f[r++]=
a[190];var t=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[191];y[v++]=c(z);y[v++]=a[192];y[v++]=h();y[v++]=a[193];return y};t=b.runtime.tfunc_factory("app_diff(diff)",t,b,undefined,false);t.source_microdata=null;f[r++]=a[194];var u=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[195];y[v++]=d(z.history,z.fileid);y[v++]=a[196];y[v++]=h();y[v++]=a[197];if(w)y[v++]=a[198];y[v++]=a[199];if(w)y[v++]=a[200];y[v++]=a[201];return y};u=b.runtime.tfunc_factory("file_history(t)",u,b,undefined,
false);u.source_microdata=null;f[r++]=a[202];var x=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[203];y[v++]=c(z);y[v++]=a[204];y[v++]=h();y[v++]=a[205];if(w)y[v++]=a[206];y[v++]=a[207];if(w)y[v++]=a[208];y[v++]=a[209];return y};x=b.runtime.tfunc_factory("merge_changes(patch)",x,b,undefined,false);x.source_microdata=null;f[r++]=a[210];var C=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[211];z.labels=["Saved Copy","Your Local Version"];y[v++]=a[212];y[v++]=j(z,"get_file_diff");
y[v++]=a[213];z=b.runtime.uniqueid("onclick");mjt._eventcb[z]=function(){ui.do_file_save(true)};y[v++]=a[214];y[v++]=b.runtime.make_attr_safe(z,false);y[v++]=a[215];return y};C=b.runtime.tfunc_factory("save_conflict(diff)",C,b,undefined,false);C.source_microdata=null;f[r++]=a[216];var w=ui.get_app().is_writable(),A,E,F;switch(s){case "app_history":A="App History";E=mjt.Succeed(ui.get_app().get_versions());F=q;break;case "app_diff":q=ui.get_app().get_versions()[0];A="View changes since version "+q.name;
E=ui.get_store().XhrGet("get_app_diff",{appid1:ui.get_app().get_path(),appid2:ui.get_app().get_path(),timestamp2:q.as_of_time});F=t;break;case "file_history":A="File History";E=ui.get_file().t_get_history();F=u;break;case "merge_changes":A="View changes from "+g.appid;E=ui.get_store().XhrGet("get_app_diff",{appid1:g.appid,appid2:ui.get_app().get_path()});F=x;break;case "save_conflict":A="File Save Conflict";E=mjt.Succeed(g);F=C;break}f[r++]=a[217];f[r++]=A;f[r++]=a[218];b.runtime.ondomready(function(){E.enqueue().onready(function(z){$("#diff-dialog").acre(F(z))})},
this);f[r++]=a[219];return f};l=b.runtime.tfunc_factory("diff_patch(mode, opts)",l,b,undefined,false);i.diff_patch=l;l.source_microdata=null;m[n++]=a[220];l=function(){var s=b.runtime.new_markuplist(),g=0;s[g++]=a[221];b.runtime.foreach(this,ui.shortcut.get_shortcuts(),function(f,r){for(var d=1;d;){s[g++]=a[222];s[g++]=mjt.bless(ui.shortcut.get_keys(r.op));s[g++]=a[223];s[g++]=r.op;s[g++]=a[224];d--}return d?b.runtime._break_token:b.runtime._continue_token});s[g++]=a[225];return s};l=b.runtime.tfunc_factory("keyboard_shortcuts()",
l,b,undefined,false);i.keyboard_shortcuts=l;l.source_microdata=null;m[n++]=a[226];l=function(){var s=b.runtime.new_markuplist(),g=0;s[g++]=a[227];s[g++]=ui.get_store().get_acre_version();s[g++]=a[228];return s};l=b.runtime.tfunc_factory("about_appeditor()",l,b,undefined,false);i.about_appeditor=l;l.source_microdata=null;m[n++]=a[229];l=function(s){var g=b.runtime.new_markuplist(),f=0;g[f++]=a[230];var r=b.runtime.uniqueid("onclick");mjt._eventcb[r]=function(){ui.do_hide_overlays()};g[f++]=a[231];
g[f++]=b.runtime.make_attr_safe(s,true);g[f++]=a[232];g[f++]=b.runtime.make_attr_safe(r,false);g[f++]=a[233];g[f++]=b.runtime.make_attr_safe(s,false);g[f++]=a[234];return g};l=b.runtime.tfunc_factory("documentation(url)",l,b,undefined,false);i.documentation=l;l.source_microdata=null;m[n++]=a[235];return m};e.source_microdata=null;return e}(),info:{file:"//20a.appeditor.www.tags.svn.freebase-site.googlecode.dev/dialogs.mjt",stringtable:["\n\n<!-- Dirty files dialog --\>",'\n  <h3 class="dialog-title">Abandon Changes?</h3>\n  <div class="dialog-content">\n    <div class="dialog-inset">\n      <p>You haven\'t saved all the changes you made to the app you currently have open. <b>Abandon these changes?</b></p>\n    </div>\n  </div>\n  <div class="button-bar">\n    <button class="button-main exit">No</button>',
'\n    <button class="exit" onclick="return mjt._eventcb.','.apply(this, [event])">\n      Yes, abandon changes and switch apps</button>\n  </div>',"\n\n\n<!-- New user dialog --\>",'\n  <div id="welcome-panel">\n    <div class="acre-logo">\n      <img alt="Acre: Open Code for Open Data" border="0" height="47" src="/static/20a.appeditor.www.tags.svn.freebase-site.googlecode.dev/logo-acre.png" width="211">\n    </div>\n    <div>','\n      <ul>\n        <li><em>See what you can build!</em><br>\n          <small>Check out <a class="exit" href="',
'/apps" target="_new">the App Directory</a> or <a class="exit" href="','/docs/acre" target="_new">the documentation</a>.</small>\n        </li>\n        <li><em>Ready to go?</em><br>\n          <small></small>','<button id="button-newapp" onclick="return mjt._eventcb.','.apply(this, [event])"><small>Create a New App</small></button> ','<button id="button-yourapps" onclick="return mjt._eventcb.','.apply(this, [event])">\n            <span class="button-menu">Choose from Your Apps</span></button>\n        </li>\n      </ul>',
'\n      <ul>  \n        <li><em>Create your own Acre app</em><br>\n          <small>Sign in or Sign Up for Freebase above to get started.</small>\n        </li>\n        <li><em>See what you can build!</em><br>\n          <small>Check out <a class="exit" href="','/apps" target="_new">the App Directory</a> or <a class="exit" href="','/docs/acre" target="_new">the documentation</a>.</small>\n        </li>\n      </ul>',"\n    </div>\n  </div>","\n\n\n<!-- App action dialogs --\>","",'\n  <h3 class="dialog-title">Create New App</h3>\n  <div class="dialog-content">\n    <fieldset>\n      <div class="dialog-inset">\n        <div class="dialog-inset-header">\n          <input',
' id="new-app-create"',' name="new-app"',' type="radio"',' value="create"','>\n          <label for="new-app-create">Create a new app</label>\n          <input',' id="new-app-clone"',' name="new-app"',' type="radio"',' value="clone"','>\n          <label for="new-app-clone">Clone an existing app</label>\n          <span',' id="new-app-clone-field"','>: \n            <input class="longfield" id="new-app-clone-id" type="text" value="','">\n          </span>\n        </div>\n        <div class="form-row">\n          <label for="new-app-dialog-name">Name your App: </label>\n          <input id="new-app-dialog-name" maxlength="50" type="text" value="',
'">\n        </div>\n        <div class="form-row wide">\n          <label for="new-app-dialog-key">Choose a URL: </label>      \n          <span class="url">http://<input class="shortfield" id="new-app-dialog-key" maxlength="20" minlength="5" size="15" type="text" value="','">.','</span>\n        </div>\n        <div class="form-tip">      \n          This URL points to the development version of your code.\n          Later you can choose a shorter Release URL to share with others.\n        </div>\n      </div>\n    </fieldset>\n\n    <div class="cc-callout">\n      <a class="cc-logo" href="http://creativecommons.org/licenses/BSD/"><img alt="CC-BSD" src="/static/20a.appeditor.www.tags.svn.freebase-site.googlecode.dev/cc-bsd.png"></a>\n      <div class="cc-about">\n        All Acre apps are published on Freebase under the\n        <a href="http://creativecommons.org/licenses/BSD/">BSD license</a>\n        so everyone can "view source", clone code, and learn from each other.\n      </div>\n    </div>\n  </div>\n\n  <div class="button-bar">\n    <button class="button-main exit" id="button-new-app">Create</button>\n    <button class="exit">Cancel</button>\n  </div>',
"","",'\n  <h3 class="dialog-title">Delete app \u201c','\u201d?</h3>\n  <div class="dialog-content">\n    <div class="dialog-inset">\n      <p>\n        Are you sure you want to <b>delete this entire app</b>?\n      </p>\n      <p>\n        This can\'t be undone!\n      </p>\n    </div>\n  </div>\n  <div class="button-bar">','\n    <button class="button-main exit" onclick="return mjt._eventcb.','.apply(this, [event])">Delete App</button>\n    <button class="exit">Cancel</button>\n  </div>',"  \n\n\n<!-- File action dialogs --\>",
'\n  <h3 class="dialog-title">Save File As</h3>\n  <div class="dialog-content" id="applist">\n    <span class="loader-square"></span>\n  </div>',"",'\n    <div class="dialog-inset">\n      <fieldset>\n        <div class="form-row">\n          <label for="clone-filename">New file name: </label>\n          <input id="clone-filename" type="text" value="','">\n        </div>\n        <div class="form-row">\n          <label for="clone-file-app">In app: </label>\n          <select id="clone-file-app">',
"\n            <option",' value="','"',">\n              ","\n            </option>",'\n          </select>\n        </div>\n      </fieldset>\n    </div>\n    <div class="button-bar">\n      <button class="button-main" id="button-clone">Save</button>\n      <button class="exit">Cancel</button>\n    </div>',"","","","","",'\n  <h3 class="dialog-title">Create a New...</h3>',"","",'\n    <div>\n      <div class="form-row">\n        <label for="add-file-mimetype">MIME type: </label>\n        <select id="add-file-mimetype">',
"\n          <option",' value="','"',">\n            ","</option>","\n        </select>\n      </div>\n    </div>","",'\n  \n  <div class="dialog-content">\n    <div class="dialog-inset">\n      <fieldset>\n        <div class="form-row">\n          <label for="add-file-name">New file name:</label>\n          <input id="add-file-name" type="text" value="','">\n        </div>\n        <div class="form-row">\n          <label for="add-file-handler">Handler: </label>\n          <select id="add-file-handler">\n            <option selected="" value="">(derived from extension)</option>',
'\n            <option class="handler-section" id="handler-','" value="','">\n              ',"\n            </option>",'\n          </select>\n        </div>\n        <div class="form-row" id="add-file-mimetype-container"></div>\n      </fieldset>\n    </div>\n  </div>\n  <div class="button-bar">\n    <button class="button-main" id="button-add-file">Create New File</button>\n    <button class="exit">Cancel</button>\n  </div>',"","",'\n  <h3 class="dialog-title">Delete file \u201c','\u201d?</h3>\n  <div class="dialog-content">\n  <div class="dialog-inset">\n    <p>\n      Are you sure you want to delete the file \u201c<b>',
'</b>\u201d?\n    </p>\n    <p>\n      This can\'t be undone!\n    </p>\n  </div>\n  </div>\n  <div class="button-bar">','\n    <button class="button-main exit" onclick="return mjt._eventcb.','.apply(this, [event])">Delete File</button>\n    <button class="exit">Cancel</button>\n  </div>',"  \n  \n\n<!-- Diff/Patch dialogs --\>","","<div",'>\n    <div class="revision-list">',"","\n      <p>\n        <b>",'</b> is based on:\n        <a class="external-link" href="',"/view",'" target="_blank">',"</a>\n      </p>",
'              \n      <table class="item-list">\n        <thead>\n          <tr>\n            <th>Compare</th>','\n            <th class="left">Version</th>',"",'\n            <th class="left">File</th>','\n            <th class="left">Date</th>',"\n            <th>Length</th>","",'\n            <th class="left">By</th>','\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td class="center">\n              <span>\n                <input checked="checked" name="diff-from" type="radio" value=""> |\n                <input checked="checked" name="diff-to" type="radio" value="">\n              </span>\n            </td>\n            <td><b><i>Current</i></b></td>',
"\n            <td></td>","","\n            <td></td>","","\n            <td></td>","","\n            <td></td>","\n          </tr>",'\n          <tr>\n            <td class="center">\n              <span>','\n                <input name="diff-from" type="radio" value="','"> |\n                <input name="diff-to" type="radio" value="','">\n              </span>\n            </td>',"\n            <td>","</td>","","\n            <td>","</td>",'\n            <td>\n              <span class="last_mod">\n                ',
"\n              </span>\n            </td>",'\n            <td class="center">',"</td>","","\n            <td>","</td>","\n          </tr>","\n        </tbody>\n      </table>\n    </div>","\n  </div>","\n      \n  <!-- Used when the filelist needs to be dynamically updated --\>",'<div id="diff-filelist-shim">\n    ',"\n  </div>","",'<div id="diff-filelist">',"","","","\n        <span>","\n          <input",' type="checkbox"',">","\n          <a",' href="#0"',">\n            ","</a>\n        </span>",
'\n        <span class="diff-filelist-stub">\n          <i>',"</i>\n        </span>","",'<span class="file-merge-status">+</span>','<span class="file-merge-status">-</span>','<span class="file-merge-status error-alert">!</span>','<span class="file-merge-status"></span>',"","\n      <p>\n        Select: ",'<a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">All</a> | ','\n        <a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">None</a>\n      </p>\n      <ul>','\n        <li class="file-list-item" data-fn="',
'">\n          <span class="diff-filelist-stub">',"</span>\n        </li>","\n      </ul>","",'\n    <span class="loader-square"></span>',"\n    <p>Pick revisions above to see changed files</p>","","\n  </div>","\n\n  <!-- Used when the diff view needs to be dynamically updated --\>",'<div id="diff-view-shim">\n    ',"\n  </div>","",'<div class="diff" id="diff-view">',"","","\n    <p>Click on a file or revision to see the changes.</p>","\n  </div>","",'<div id="diff-error-view">\n    <div class="message">',
"</div>\n  </div>","\n      \n  <!-- Main content for each mode --\>    ",'\n    <div class="dialog-content">\n      <fieldset id="apphistory-mode">\n        <div class="radiogroup">\n          <h5>\n            <input checked="checked" name="app-history" type="radio" value="versions">\n            Versions\n          </h5>\n        </div>\n        <div class="radiogroup">\n          <h5>\n            <input name="app-history" type="radio" value="all-changes">\n            Edits\n          </h5>\n        </div>\n      </fieldset>\n      <div class="diff-top">\n        <div id="revision-list-shim"></div>\n      </div>\n      <div class="diff-bottom-short" id="history-diff"></div>',
"\n        ",'\n        <div class="diff-area-files">',"</div>",'\n    </div>\n    <div class="button-bar">','\n      <button class="button-patch patch-apply button-main exit" disabled="disabled">Revert to Right</button>',"        ",'\n      <button class="button-patch patch-apply-save exit" disabled="disabled">Revert &amp; Save</button>','\n      <button class="exit">Done</button>\n    </div>',"","",'\n    <div class="dialog-content">\n      <div class="diff-bottom-tall">\n        ','\n        <div class="diff-area-files">',
'</div>\n      </div>\n    </div>\n    <div class="button-bar">\n      <button class="exit">Done</button>\n    </div>',"",'\n    <div class="dialog-content">\n      <div class="diff-top">\n        ','\n      </div>\n      <div class="diff-bottom-short">\n        <div class="diff-area-full diff-area-short">','</div>\n      </div>\n    </div>\n    <div class="button-bar">','\n      <button class="button-main exit" disabled="disabled" id="button-file-revert">Revert to Right</button>',"",'\n      <button class="exit" disabled="disabled" id="button-file-revert-save">Revert &amp; Save</button>',
'        <button class="exit">Done</button>\n    </div>',"",'\n    <div class="dialog-content">\n      <div class="diff-bottom-tall">\n        ','\n        <div class="diff-area-files">','</div>\n      </div>\n    </div>\n    <div class="button-bar">','\n      <button class="button-patch patch-apply button-main exit" disabled="disabled">Apply Selected Changes</button>',"",'\n      <button class="button-patch patch-apply-save exit" disabled="disabled">Apply &amp; Save</button>','\n      <button class="exit">Done</button>\n    </div>',
"","",'\n    <div class="dialog-content">\n      <div class="diff-top">\n        <p>\n          The saved version of this file has changed since it was loaded, likely because \n          it was edited by another user or by you in another browser or tab.  \n        </p>\n        <p>\n          Decide how to proceed or view the details of the conflict.\n        </p>\n      </div>\n      <div class="diff-bottom-short">\n        <div class="diff-area-full">','</div>\n      </div>\n    </div>\n    <div class="button-bar">',
'\n      <button class="button exit" onclick="return mjt._eventcb.','.apply(this, [event])">Save Anyway</button>\n      <button class="button-main exit">Cancel</button>\n    </div>',"\n   \n  <!-- Setup the dialog for all modes --\>",'\n  \n  <h3 class="dialog-title">','</h3>\n  <div id="diff-dialog">\n    <span class="loader-square"></span>\n  </div>',"","\n\n\n<!-- Help dialogs --\>",'\n  <h3 class="dialog-title">App Editor Keyboard Shortcuts</h3>\n  <div class="dialog-content">\n    <div class="dialog-inset">\n      <table>',
"\n        <tr>\n          <!-- mjt.bless is being used so HTML entities for system control characters \n              can be printed. These are all declared in ui.shortcut --\>\n          <th>","</th>\n          <td>","</td>\n        </tr>","\n      </table>\n    </div>\n  </div>","",'\n  <h3 class="dialog-title">About App Editor</h3>\n  <iframe class="dialog-content" id="dialog-aboutappeditor" src="/appeditor/license.html"></iframe>\n  <div class="button-bar">\n    <b>Version: </b>\n    <span>- ',
"</span>\n  </div>","","",'\n  <a class="doc-view-link" href="','" target="_blank" onclick="return mjt._eventcb.','.apply(this, [event])">Open in a new window</a>\n  <iframe class="dialog-content" src="','"></iframe>',""],debug_locs:[1,1,1,1,1,1,7,7,7,7,7,7,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,19,19,19,19,19,19,19,19,23,23,23,23,23,23,23,29,29,29,29,29,29,29,31,31,31,31,31,31,31,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,37,37,37,37,37,38,43,43,43,43,43,43,43,43,43,43,45,45,45,45,48,48,
48,48,48,48,48,48,52,52,52,52,52,52,52,53,53,54,55,56,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,66,66,66,66,66,66,66,66,66,66,66,66,66,67,67,67,72,72,72,72,72,72,72,76,76,76,76,76,76,76,76,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,129,129,129,129,129,130,130,130,130,
131,131,131,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,146,146,146,146,146,146,146,146,150,150,150,150,150,150,150,156,156,156,156,156,156,156,156,157,157,158,159,160,161,162,167,167,167,167,167,167,167,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,174,174,174,175,175,175,175,175,175,184,184,184,184,184,184,184,184,184,184,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,200,200,200,200,201,201,201,202,203,204,
205,206,207,208,209,210,210,210,210,210,210,211,211,211,211,212,212,213,214,217,217,217,217,217,218,218,219,220,221,221,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,227,227,227,227,227,227,227,227,230,230,230,230,230,231,231,231,231,231,238,238,238,238,238,238,238,238,238,244,244,244,244,244,244,244,244,244,244,244,244,244,244,245,245,245,246,246,246,246,246,246,258,258,258,258,258,258,258,258,258,258,258,258,258,259,260,261,262,263,264,265,266,267,268,269,
270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,296,296,296,296,296,297,297,297,297,298,298,298,302,302,302,302,302,302,310,310,310,310,310,310,310,310,310,310,310,310,310,310,313,313,313,313,313,313,313,313,318,318,318,318,318,318,318,320,320,320,320,320,320,322,322,322,323,324,325,326,327,328,329,330,331,331,332,332,332,332,333,333,333,333,333,333,333,334,334,334,339,339,339,339,339,339,339,339,339,340,340,340,340,340,342,342,342,342,342,
342,343,343,343,343,343,355,355,355,355,355,355,355,355,355,355,355,355,355,355,355,355,356,356,356,356,356,357,357,357,357,357,358,358,358,358,358,360,360,360,360,360,363,363,363,363,363,364,365,366,367,368,368,368,369,369,369,372,372,372,372,372,372,372,372,372,373,373,373,373,373,373,373,376,376,376,376,376,379,379,379,379,379,379,379,379,379,380,380,380,380,380,380,380,381,381,381,381,381,381,385,385,385,385,385,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,
406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,438,438,438,438,438,440,440,440,440,440,440,441,441,441,442,442,442,442,442,442,444,444,444,444,445,445,446,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,460,460,460,461,461,462,462,462,462,462,462,462,462,462,462,462,462,462,462,462,462,462,463,463,463,463,463,463,463,463,463,463,463,463,464,464,464,465,465,465,466,467,467,467,467,468,468,468,469,469,469,
470,470,470,471,471,471,472,472,472,473,473,473,474,474,474,474,474,477,477,477,477,477,477,477,477,478,478,478,478,478,478,478,481,481,481,481,481,481,481,481,481,482,482,482,483,483,483,483,483,483,485,485,485,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,548,548,548,548,548,549,549,549,549,
550,550,550,551,552,553,554,555,556,557,558,559,560,561,562,562,562,562,562,562,564,564,564,564,564,564,565,565,565,566,566,566,566,566,566,568,568,568,568,569,569,570,570,570,571,572,573,574,574,574,574,574,574,575,575,575,575,575,575,577,577,577,577,578,578,578,579,579,579,579,579,579,582,582,582,582,582,582,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,603,603,603,604,604,604,605,605,605,605,605,608,608,608,608,608,608,608,609,609,609,609,609,612,612,
612,612,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,632,632,632,632,633,633,633,633,636,636,636,636,636,637,637,637,643,643,643,643,643,643,643,643,643,643,645,645,645,645,648,648,648,648,648,651,651,651,651,651,655,655,655,655,655,655,655,655,656,656,656,656,656,658,658,658,658,658,658,660,660,660,660,663,663,663,663,663,664,664,664,668,668,668,668,668,668,668,668,669,669,669,669,669,672,672,672,672,672,672,672,674,674,674,674,675,675,676,677,689,689,689,689,
689,689,689,689,689,689,689,689,689,689,693,693,693,693,693,693,693,693,693,693,696,696,696,696,696,696,696,699,699,699,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,732,732,732,732,736,736,736,736,736,736,737,738,739,740,741,743,743,743,743,743,743,746,746,746,746,746,746,746,751,751,751,751,751,751,751,751,754,754,754,754,754,754,755,755,755,756,756,756,756,756,756,760,760,760,760,760,760,760,760,760,762,762,762,762,
767,767,767,767,767,767,767,769,769,769,769,769,769,769,771,771,771,771,772,772,772,772,772,772,772,772,772,773,773,773,774,774,774,774,774,774,775,775,775,775],output_mode:"html"}}})})(window.freebase.acre,window.freebase.h);
(function(){jQuery&&jQuery(window).trigger("acre.template.register",{pkgid:"//20a.appeditor.www.tags.svn.freebase-site.googlecode.dev/menus.mjt",source:{def:function(){var e=function(){var b=this.tpackage,i=this.exports,a=b._template_fragments,m=b.runtime.new_markuplist(),n=0;m[n++]=a[0];var l=function(d){var c=b.runtime.new_markuplist(),p=0;c[p++]=a[1];var h=ui.get_user(),j=ui.get_recents("apps"),o=Math.min(j.length,10);c[p++]=a[2];if(h){h=b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){ui.do_show_dialog("new_app")};
c[p++]=a[3];c[p++]=b.runtime.make_attr_safe(h,false);c[p++]=a[4]}c[p++]=a[5];h=b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){ui.do_acre_home_link("/apps")};c[p++]=a[6];c[p++]=b.runtime.make_attr_safe(h,false);c[p++]=a[7];if(ui.get_user())c[p++]=a[8];else{c[p++]=a[9];c[p++]=b.runtime.make_attr_safe($("#nav-signin").attr("href"),true);c[p++]=a[10]}c[p++]=a[11];if(o>0){c[p++]=a[12];for(h=0;h<o;h++){c[p++]=a[13];var q=j[h],t=q.path.match(/\.dev\.([a-z0-9\.\-]*)\.$/);t=t?t[1]:null;c[p++]=a[14];
c[p++]=b.runtime.make_attr_safe(q.path,false);c[p++]=a[15];c[p++]=b.runtime.make_attr_safe(ui.get_appeditor_url(q.path),true);c[p++]=a[16];c[p++]=b.runtime.make_attr_safe(q.path,false);c[p++]=a[17];c[p++]=q.name;c[p++]=a[18];if(t){c[p++]=a[19];c[p++]=t;c[p++]=a[20]}c[p++]=a[21]}c[p++]=a[22]}else c[p++]=a[23];c[p++]=a[24];b.runtime.ondomready(function(){ui.do_setup_submenu("your-apps-menu-item","yourapps");d&&$("#your-apps-menu-item").trigger("mouseenter")},this);c[p++]=a[25];return c};l=b.runtime.tfunc_factory("apps(auto_open)",
l,b,undefined,false);i.apps=l;l.source_microdata=null;m[n++]=a[26];l=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[27];var p=ui.get_store().get_user_apps();ui.get_store().t_refresh_user_apps();d[c++]=a[28];if(p.length===0)d[c++]=a[29];else{d[c++]=a[30];b.runtime.foreach(this,p,function(h,j){for(var o=1;o;){d[c++]=a[31];d[c++]=b.runtime.make_attr_safe(j.path,false);d[c++]=a[32];d[c++]=b.runtime.make_attr_safe(ui.get_appeditor_url(j.path),true);d[c++]=a[33];d[c++]=b.runtime.make_attr_safe(j.path,
false);d[c++]=a[34];d[c++]=j.name;d[c++]=a[35];o--}return o?b.runtime._break_token:b.runtime._continue_token});d[c++]=a[36]}d[c++]=a[37];b.runtime.ondomready(function(){var h=$("#menu-yourapps"),j=Math.min(h.height(),$(window).height()-h.offset().top-25);h.height(j).css("visibility","visible");$("#your-apps-loader").hide()},this);d[c++]=a[38];return d};l=b.runtime.tfunc_factory("yourapps()",l,b,undefined,false);i.yourapps=l;l.source_microdata=null;m[n++]=a[39];l=function(){var d=b.runtime.new_markuplist(),
c=0;d[c++]=a[40];var p=ui.get_app(),h=ui.get_file();ui.get_user();p=p?p.is_writable():false;d[c++]=a[41];if(p){d[c++]=a[42];d[c++]=b.runtime.make_attr_safe(ui.get_file().get_name(),false);d[c++]=a[43];if(p)d[c++]=a[44];d[c++]=a[45]}d[c++]=a[46];if(p){d[c++]=a[47];var j=function(){var w=b.runtime.new_markuplist(),A=0;w[A++]=a[48];if(this.subst_id)w[A++]=b.runtime.bless(' id="'+this.subst_id+'"');w[A++]=a[49];var E=ui.get_app().get_acre_handlers(),F=[];for(var z in E)$.inArray(h.get_mime_type(),ui.get_app().get_supported_mime_types(z))!=
-1&&F.push(E[z]);E=ui.get_app().get_supported_mime_types(h.get_acre_handler());w[A++]=a[50];z=F.length>1?{}:{disabled:"disabled"};"id"in z||(w[A++]=a[51]);for(var y in z){w[A++]=" "+y;w[A++]=b.runtime.bless('="');w[A++]=b.runtime.htmlencode(""+z[y]);w[A++]=b.runtime.bless('"')}w[A++]=a[52];b.runtime.foreach(this,F,function(B,I){for(var G=1;G;){w[A++]=a[53];var K=I.key===h.get_acre_handler()?{selected:""}:{};if(!("value"in K)){w[A++]=a[54];w[A++]=b.runtime.make_attr_safe(I.key,false);w[A++]=a[55]}for(var J in K){w[A++]=
" "+J;w[A++]=b.runtime.bless('="');w[A++]=b.runtime.htmlencode(""+K[J]);w[A++]=b.runtime.bless('"')}w[A++]=a[56];w[A++]=I.name;w[A++]=a[57];G--}return G?b.runtime._break_token:b.runtime._continue_token});w[A++]=a[58];F=!h.get_editor_supported_features("mimetype_change")||E.length<2?{}:{};"id"in F||(w[A++]=a[59]);for(var v in F){w[A++]=" "+v;w[A++]=b.runtime.bless('="');w[A++]=b.runtime.htmlencode(""+F[v]);w[A++]=b.runtime.bless('"')}w[A++]=a[60];b.runtime.foreach(this,E,function(B,I){for(var G=1;G;){w[A++]=
a[61];var K=I===h.get_mime_type()?{selected:""}:{};if(!("value"in K)){w[A++]=a[62];w[A++]=b.runtime.make_attr_safe(I,false);w[A++]=a[63]}for(var J in K){w[A++]=" "+J;w[A++]=b.runtime.bless('="');w[A++]=b.runtime.htmlencode(""+K[J]);w[A++]=b.runtime.bless('"')}w[A++]=a[64];w[A++]=I;w[A++]=a[65];G--}return G?b.runtime._break_token:b.runtime._continue_token});w[A++]=a[66];b.runtime.ondomready(function(){$("#file-handler").change(function(){ui.do_file_set_acre_handler($(":selected",this).val());$("#metadata-section").acre(j())});
$("#file-mimetype").change(function(){ui.do_file_set_mime_type($(":selected",this).val());$("#metadata-section").acre(j())})},this);w[A++]=a[67];return w};j=b.runtime.tfunc_factory("metadata_section()",j,b,undefined,false);j.source_microdata=null;d[c++]=a[68];d[c++]=j();d[c++]=a[69]}else{d[c++]=a[70];d[c++]=h.get_acre_handler();d[c++]=a[71];d[c++]=h.get_mime_type();d[c++]=a[72]}d[c++]=a[73];var o=b.runtime.uniqueid("onclick");mjt._eventcb[o]=function(){ui.do_file_check()};d[c++]=a[74];var q=ui.get_file_check_options().useful===
1?{}:{disabled:"disabled"};if(!("title"in q)){d[c++]=a[75];d[c++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Check Syntax")),false);d[c++]=a[76]}if(!("onclick"in q)){d[c++]=a[77];d[c++]=b.runtime.make_attr_safe(o,false);d[c++]=a[78]}for(var t in q){d[c++]=" "+t;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+q[t]);d[c++]=b.runtime.bless('"')}d[c++]=a[79];if(p){t=b.runtime.uniqueid("onclick");mjt._eventcb[t]=function(){ui.do_file_revert_to_saved()};d[c++]=a[80];o=!h.is_dirty()?
{disabled:"disabled"}:{};"class"in o||(d[c++]=a[81]);if(!("onclick"in o)){d[c++]=a[82];d[c++]=b.runtime.make_attr_safe(t,false);d[c++]=a[83]}for(var u in o){d[c++]=" "+u;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+o[u]);d[c++]=b.runtime.bless('"')}d[c++]=a[84]}d[c++]=a[85];u=b.runtime.uniqueid("onclick");mjt._eventcb[u]=function(){ui.do_show_dialog("diff_patch",["file_history",ui.get_file().get_name()])};d[c++]=a[86];d[c++]=b.runtime.make_attr_safe(u,false);d[c++]=a[87];u=b.runtime.uniqueid("onclick");
mjt._eventcb[u]=function(){ui.do_show_dialog("save_file_as")};d[c++]=a[88];t=ui.get_user()?{}:{disabled:"disabled"};if(!("onclick"in t)){d[c++]=a[89];d[c++]=b.runtime.make_attr_safe(u,false);d[c++]=a[90]}for(var x in t){d[c++]=" "+x;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+t[x]);d[c++]=b.runtime.bless('"')}d[c++]=a[91];x=b.runtime.uniqueid("onclick");mjt._eventcb[x]=function(){ui.do_show_dialog("delete_file",[ui.get_file().get_name()])};d[c++]=a[92];p=p?{}:{disabled:"disabled"};
if(!("onclick"in p)){d[c++]=a[93];d[c++]=b.runtime.make_attr_safe(x,false);d[c++]=a[94]}for(var C in p){d[c++]=" "+C;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+p[C]);d[c++]=b.runtime.bless('"')}d[c++]=a[95];b.runtime.ondomready(function(){ui.watch_inputs("name",{inputs:{"file-name":ui.get_file().get_name()},change:function(w){return w["file-name"]!==""?w:false},submit:function(w){ui.do_file_move(w["file-name"])}})},this);d[c++]=a[96];return d};l=b.runtime.tfunc_factory("fileactions()",
l,b,undefined,false);i.fileactions=l;l.source_microdata=null;m[n++]=a[97];l=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[98];var p=false;ui.get_store();var h=ui.get_app(),j=ui.get_file();ui.get_user()&&h.is_writable();d[c++]=a[99];if(j.get_editor_supported_features("hotswap")){d[c++]=a[100];p=true;d[c++]=a[101];b.runtime.foreach(this,EDITORS,function(E,F){for(var z=1;z;){if(F.supports.hotswap){d[c++]=a[102];var y=ui.get_editor_prefs("texteditor")===E?{checked:"checked"}:{};if(!("id"in
y)){d[c++]=a[103];d[c++]=b.runtime.make_attr_safe(E,false);d[c++]=a[104]}"name"in y||(d[c++]=a[105]);"type"in y||(d[c++]=a[106]);if(!("value"in y)){d[c++]=a[107];d[c++]=b.runtime.make_attr_safe(E,false);d[c++]=a[108]}for(var v in y){d[c++]=" "+v;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+y[v]);d[c++]=b.runtime.bless('"')}d[c++]=a[109];d[c++]=b.runtime.make_attr_safe(E,false);d[c++]=a[110];d[c++]=F.name;d[c++]=a[111]}z--}return z?b.runtime._break_token:b.runtime._continue_token});
d[c++]=a[112]}d[c++]=a[113];if(j.get_editor_supported_features("margin")){d[c++]=a[114];p=true;d[c++]=a[115];h=ui.get_editor_prefs("margin")?{checked:"checked"}:{};"id"in h||(d[c++]=a[116]);"name"in h||(d[c++]=a[117]);"type"in h||(d[c++]=a[118]);"value"in h||(d[c++]=a[119]);for(var o in h){d[c++]=" "+o;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+h[o]);d[c++]=b.runtime.bless('"')}d[c++]=a[120];o=ui.get_editor_prefs("margin")?{}:{checked:"checked"};"id"in o||(d[c++]=a[121]);"name"in
o||(d[c++]=a[122]);"type"in o||(d[c++]=a[123]);"value"in o||(d[c++]=a[124]);for(var q in o){d[c++]=" "+q;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+o[q]);d[c++]=b.runtime.bless('"')}d[c++]=a[125]}d[c++]=a[126];if(j.get_editor_supported_features("softwrap")){d[c++]=a[127];p=true;d[c++]=a[128];q=ui.get_editor_prefs("softwrap")?{checked:"checked"}:{};"id"in q||(d[c++]=a[129]);"name"in q||(d[c++]=a[130]);"type"in q||(d[c++]=a[131]);"value"in q||(d[c++]=a[132]);for(var t in q){d[c++]=
" "+t;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+q[t]);d[c++]=b.runtime.bless('"')}d[c++]=a[133];t=ui.get_editor_prefs("softwrap")?{}:{checked:"checked"};"id"in t||(d[c++]=a[134]);"name"in t||(d[c++]=a[135]);"type"in t||(d[c++]=a[136]);"value"in t||(d[c++]=a[137]);for(var u in t){d[c++]=" "+u;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+t[u]);d[c++]=b.runtime.bless('"')}d[c++]=a[138]}d[c++]=a[139];if(j.get_editor_supported_features("codeassist")){d[c++]=a[140];p=true;
d[c++]=a[141];u=ui.get_editor_prefs("dotTrigger")?{checked:"checked"}:{};"id"in u||(d[c++]=a[142]);"name"in u||(d[c++]=a[143]);"type"in u||(d[c++]=a[144]);"value"in u||(d[c++]=a[145]);for(var x in u){d[c++]=" "+x;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+u[x]);d[c++]=b.runtime.bless('"')}d[c++]=a[146];x=ui.get_editor_prefs("dotTrigger")?{}:{checked:"checked"};"id"in x||(d[c++]=a[147]);"name"in x||(d[c++]=a[148]);"type"in x||(d[c++]=a[149]);"value"in x||(d[c++]=a[150]);for(var C in x){d[c++]=
" "+C;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+x[C]);d[c++]=b.runtime.bless('"')}d[c++]=a[151]}d[c++]=a[152];if(j.get_editor_supported_features("emql")){d[c++]=a[153];p=true;d[c++]=a[154];j=ui.get_editor_prefs("emql")?{checked:"checked"}:{};"id"in j||(d[c++]=a[155]);"name"in j||(d[c++]=a[156]);"type"in j||(d[c++]=a[157]);"value"in j||(d[c++]=a[158]);for(var w in j){d[c++]=" "+w;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+j[w]);d[c++]=b.runtime.bless('"')}d[c++]=
a[159];w=ui.get_editor_prefs("emql")?{}:{checked:"checked"};"id"in w||(d[c++]=a[160]);"name"in w||(d[c++]=a[161]);"type"in w||(d[c++]=a[162]);"value"in w||(d[c++]=a[163]);for(var A in w){d[c++]=" "+A;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+w[A]);d[c++]=b.runtime.bless('"')}d[c++]=a[164]}d[c++]=a[165];p||(d[c++]=a[166]);d[c++]=a[167];b.runtime.ondomready(function(){$("#menu-editoroptions input[type='radio']").click(function(){var E=$(this).attr("name").split("edopt-")[1],F={};F[E]=
$(this).val();ui.set_editor_prefs(F);ui.do_refresh_file();ui.do_hide_overlays()})},this);d[c++]=a[168];return d};l=b.runtime.tfunc_factory("editoroptions()",l,b,undefined,false);i.editoroptions=l;l.source_microdata=null;m[n++]=a[169];l=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[170];var p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){return ui.do_show_dialog("keyboard_shortcuts")};d[c++]=a[171];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[172];p=b.runtime.uniqueid("onclick");
mjt._eventcb[p]=function(){return ui.do_show_dialog("documentation",[ui.get_store().get_freebase_url()+"/docs/iframe/acre_api"])};d[c++]=a[173];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[174];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){return ui.do_show_dialog("documentation",[ui.get_store().get_freebase_url()+"/docs/iframe/acre_templates"])};d[c++]=a[175];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[176];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){return ui.do_show_dialog("documentation",
[ui.get_store().get_freebase_url()+"/docs/iframe/js_reference"])};d[c++]=a[177];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[178];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){return ui.do_show_dialog("documentation",[ui.get_store().get_freebase_url()+"/docs/iframe/mql"])};d[c++]=a[179];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[180];d[c++]=b.runtime.make_attr_safe(ui.get_store().get_freebase_url(),true);d[c++]=a[181];d[c++]=b.runtime.make_attr_safe(ui.get_store().get_acre_host(),
false);d[c++]=a[182];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){return ui.do_show_dialog("about_appeditor")};d[c++]=a[183];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[184];b.runtime.ondomready(function(){$("#help-menu-content a").click(function(){ui.do_hide_overlays()})},this);d[c++]=a[185];return d};l=b.runtime.tfunc_factory("help()",l,b,undefined,false);i.help=l;l.source_microdata=null;m[n++]=a[186];l=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[187];var p=ui.get_app().is_writable();
d[c++]=a[188];var h=b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){ui.do_hide_overlays()};d[c++]=a[189];d[c++]=b.runtime.make_attr_safe(h,false);d[c++]=a[190];if(p)d[c++]=a[191];d[c++]=a[192];if(ui.get_app().is_remote()){d[c++]=a[202];if(ui.get_user()){p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){ui.do_show_dialog("new_app",[true])};d[c++]=a[203];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[204]}d[c++]=a[205]}else{d[c++]=a[193];if(ui.get_app().is_author())d[c++]=a[194];
d[c++]=a[195];if(ui.get_user()){h=b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){ui.do_show_dialog("new_app",[true])};d[c++]=a[196];d[c++]=b.runtime.make_attr_safe(h,false);d[c++]=a[197]}d[c++]=a[198];if(p){p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){ui.do_show_dialog("delete_app")};d[c++]=a[199];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[200]}d[c++]=a[201]}d[c++]=a[206];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){ui.do_hide_overlays()};d[c++]=a[207];
d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[208];b.runtime.ondomready(function(){$("#button-appsettings").addClass("button-open");$("#settings-tabs").tabs("#settings-tab-content > div",{api:true,initialIndex:0,onBeforeClick:function(j,o){var q=$(this.getPanes()[o]).attr("id");setTimeout(function(){$("#"+q).acre(fb.acre.apps.appeditor+"/menus.mjt",q)},0)}});$("#app-general-listing").click(function(){window.open(ui.get_app().get_edit_url());return false})},this);d[c++]=a[209];return d};l=b.runtime.tfunc_factory("appsettings()",
l,b,undefined,false);i.appsettings=l;l.source_microdata=null;m[n++]=a[210];l=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[211];if(this.subst_id)d[c++]=b.runtime.bless(' id="'+this.subst_id+'"');d[c++]=a[212];var p=ui.get_app().is_writable();d[c++]=a[213];if(p){d[c++]=a[214];var h=b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){ui.do_app_add_version($("#add-version-key").val())};d[c++]=a[215];d[c++]=b.runtime.make_attr_safe(h,false);d[c++]=a[216];if(ui.get_app().get_versions().length){h=
b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){ui.do_show_dialog("diff_patch",["app_diff"])};d[c++]=a[217];d[c++]=b.runtime.make_attr_safe(h,false);d[c++]=a[218]}d[c++]=a[219]}d[c++]=a[220];d[c++]=g();d[c++]=a[221];var j=ui.get_app();h=j.get_name();var o=j.get_base_url().replace("http://"+h,"").replace("."+j.get_store().get_acre_host(),"");d[c++]=a[222];if(p){d[c++]=a[223];d[c++]=b.runtime.make_attr_safe(h,false);d[c++]=a[224];d[c++]=o;d[c++]=a[225];d[c++]=j.get_acre_host();d[c++]=a[226]}else{d[c++]=
a[227];d[c++]=b.runtime.make_attr_safe(j.get_base_url(),true);d[c++]=a[228];d[c++]=j.get_base_url();d[c++]=a[229]}d[c++]=a[230];p&&b.runtime.ondomready(function(){ui.watch_inputs("devurl",{inputs:{devurl:j.get_name()},update_on_submit:true,submit:function(q){ui.do_app_move("//"+q.devurl+o)}})},this);d[c++]=a[231];d[c++]=s();d[c++]=a[232];return d};l=b.runtime.tfunc_factory("app_general()",l,b,undefined,false);i.app_general=l;l.source_microdata=null;m[n++]=a[233];var s=function(){var d=b.runtime.new_markuplist(),
c=0;d[c++]=a[234];for(var p=ui.get_app(),h=p.is_writable(),j=p.get_hosts(),o=p.get_released_version()||"current",q=/([^.]*)\.freebaseapps\.com$/,t=null,u=0;u<j.length;u++){var x=j[u];if(x.version==o)if(x=q.exec(x.host)){t=x[1];break}}d[c++]=a[235];if(h){d[c++]=a[236];d[c++]=b.runtime.make_attr_safe(t||"",false);d[c++]=a[237];d[c++]=p.get_acre_host();d[c++]=a[238];if(t)d[c++]=a[239];else d[c++]=a[240];d[c++]=a[241];if(t?j.length>1:j.length>0){d[c++]=a[242];b.runtime.foreach(this,j,function(C,w){for(var A=
1;A;){if(w.host!==t+".freebaseapps.com"){d[c++]=a[243];d[c++]=b.runtime.make_attr_safe(w.host,false);d[c++]=a[244];d[c++]=w.host;d[c++]=a[245];if(w.version!=o){d[c++]=a[246];d[c++]=w.version;d[c++]=a[247]}d[c++]=a[248]}A--}return A?b.runtime._break_token:b.runtime._continue_token});d[c++]=a[249]}d[c++]=a[250];b.runtime.ondomready(function(){ui.watch_inputs("puburl",{inputs:{puburl:$("#puburl").val()},text_delay:1E3,update_on_submit:true,change:function(C){$("#button-puburl").attr("disabled","disabled");
$("#puburl-status").removeClass().html("").addClass("puburl-wait");ui.get_store().XhrGet("check_host_availability",{host:C.puburl}).enqueue().onready(function(w){$("#button-puburl").removeAttr("disabled");$("#puburl-status").removeClass().addClass("puburl-success").html(w.message)}).onerror(function(w,A){$("#puburl-status").removeClass().addClass("puburl-fail").html(A)})},submit:function(C){$("#puburl-status").removeClass().empty();ui.do_app_set_host(C.puburl)}})},this);d[c++]=a[251]}else{d[c++]=
a[252];if(t){d[c++]=a[253];if(t){d[c++]=a[254];d[c++]=b.runtime.make_attr_safe(t+"."+ui.get_app().get_acre_host(),false);d[c++]=a[255];d[c++]=t;d[c++]=a[256];d[c++]=ui.get_app().get_acre_host();d[c++]=a[257]}d[c++]=a[258]}d[c++]=a[259]}d[c++]=a[260];return d};s=b.runtime.tfunc_factory("app_hosts_list()",s,b,undefined,false);i.app_hosts_list=s;s.source_microdata=null;m[n++]=a[261];var g=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[262];for(var p=ui.get_app(),h=p.get_path(),j=p.is_writable(),
o=p.get_released_version(),q=o?h.replace("//","//"+o+"."):h,t=p.get_versions(),u=/(\d+)/,x=1,C=0;C<t.length;C++){var w=u.exec(t[C].name);if(w&&w.length){w=parseInt(w[1],10);if(x<=w)x=w+1}}var A=true;d[c++]=a[263];if(o||j)d[c++]=a[264];d[c++]=a[265];if(j)d[c++]=a[266];d[c++]=a[267];if(j)d[c++]=a[268];d[c++]=a[269];if(o||j){d[c++]=a[270];if(j){d[c++]=a[271];u=q==h?{checked:"checked"}:{};"name"in u||(d[c++]=a[272]);"type"in u||(d[c++]=a[273]);"value"in u||(d[c++]=a[274]);for(var E in u){d[c++]=" "+E;
d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+u[E]);d[c++]=b.runtime.bless('"')}d[c++]=a[275]}else{d[c++]=a[276];if(q==h)d[c++]=a[277];d[c++]=a[278]}d[c++]=a[279]}d[c++]=a[280];d[c++]=b.runtime.make_attr_safe(h,false);d[c++]=a[281];d[c++]=b.runtime.make_attr_safe(ui.get_appeditor_url(h),true);d[c++]=a[282];if(j)d[c++]=a[283];d[c++]=a[284];d[c++]=b.runtime.make_attr_safe(p.get_base_url(),true);d[c++]=a[285];if(j)d[c++]=a[286];d[c++]=a[287];b.runtime.foreach(this,t,function(F,z){for(var y=
1;y;){d[c++]=a[288];var v=h.replace("//","//"+z.name+"."),B=p.get_base_url().replace("//","//"+z.name+"."),I=false;if(/\d+/.test(z.name)){if(A){I=true;A=false}}else I=true;d[c++]=a[289];if(o||j){d[c++]=a[290];if(j){d[c++]=a[291];var G=q!=v?{}:{checked:"checked"};"name"in G||(d[c++]=a[292]);"type"in G||(d[c++]=a[293]);if(!("value"in G)){d[c++]=a[294];d[c++]=b.runtime.make_attr_safe(z.name,false);d[c++]=a[295]}for(var K in G){d[c++]=" "+K;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+
G[K]);d[c++]=b.runtime.bless('"')}d[c++]=a[296]}else{d[c++]=a[297];if(q==v)d[c++]=a[298];d[c++]=a[299]}d[c++]=a[300]}d[c++]=a[301];d[c++]=b.runtime.make_attr_safe(v,false);d[c++]=a[302];d[c++]=b.runtime.make_attr_safe(ui.get_appeditor_url(v),true);d[c++]=a[303];d[c++]=z.name;d[c++]=a[304];if(z.as_of_time){d[c++]=a[305];d[c++]=ui.get_relative_timestamp(z.as_of_time);d[c++]=a[306];if(j&&I){d[c++]=a[307];I=b.runtime.uniqueid("onclick");mjt._eventcb[I]=function(){ui.do_app_add_version(z.name,"__now__")};
d[c++]=a[308];d[c++]=b.runtime.make_attr_safe(I,false);d[c++]=a[309]}d[c++]=a[310]}d[c++]=a[311];if(j){d[c++]=a[312];I=z.service_url=="http://www.sandbox-freebase.com"?{checked:"checked"}:{};"class"in I||(d[c++]=a[313]);if(!("key"in I)){d[c++]=a[314];d[c++]=b.runtime.make_attr_safe(z.name,false);d[c++]=a[315]}"type"in I||(d[c++]=a[316]);for(var J in I){d[c++]=" "+J;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+I[J]);d[c++]=b.runtime.bless('"')}d[c++]=a[317]}d[c++]=a[318];d[c++]=b.runtime.make_attr_safe(B,
true);d[c++]=a[319];if(j){d[c++]=a[320];if(q!=v){d[c++]=a[321];d[c++]=b.runtime.make_attr_safe(z.name,false);d[c++]=a[322]}d[c++]=a[323]}d[c++]=a[324];y--}return y?b.runtime._break_token:b.runtime._continue_token});d[c++]=a[325];j&&b.runtime.ondomready(function(){$("#add-version-key").val(x);$(".remove-version-button").click(function(){$(this).parents("tr").fadeOut("slow");ui.do_app_remove_version($(this).attr("key"));return false});$("input[name='version-release']").click(function(){var F=$(this).val();
ui.do_app_set_release(F);return false});$(".version-service-url").click(function(){service_url=$(this).attr("checked")?"http://www.sandbox-freebase.com":false;ui.do_app_add_version($(this).attr("key"),null,service_url)})},this);d[c++]=a[326];return d};g=b.runtime.tfunc_factory("app_versions_list()",g,b,undefined,false);i.app_versions_list=g;g.source_microdata=null;m[n++]=a[327];l=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[328];if(this.subst_id)d[c++]=b.runtime.bless(' id="'+this.subst_id+
'"');d[c++]=a[329];var p=ui.get_app();p.is_writable();var h=ui.id_to_path("/freebase/apps/seed");d[c++]=a[330];var j=b.runtime.uniqueid("onclick");mjt._eventcb[j]=function(){ui.do_show_dialog("diff_patch",["app_history"])};d[c++]=a[331];d[c++]=b.runtime.make_attr_safe(j,false);d[c++]=a[332];if(!p.get_parent()&&!p.get_children().length||p.get_parent()&&p.get_parent().path===h)d[c++]=a[333];d[c++]=a[334];if(p.get_parent()&&p.get_parent().path!==h){d[c++]=a[335];d[c++]=b.runtime.make_attr_safe(p.get_parent().path,
false);d[c++]=a[336];d[c++]=p.get_parent().path;d[c++]=a[337];d[c++]=b.runtime.make_attr_safe(p.get_parent().path,false);d[c++]=a[338]}d[c++]=a[339];if(p.get_children().length){d[c++]=a[340];b.runtime.foreach(this,p.get_children(),function(o,q){for(var t=1;t;){d[c++]=a[341];d[c++]=b.runtime.make_attr_safe(q.path,false);d[c++]=a[342];d[c++]=q.path;d[c++]=a[343];d[c++]=b.runtime.make_attr_safe(q.path,false);d[c++]=a[344];t--}return t?b.runtime._break_token:b.runtime._continue_token});d[c++]=a[345]}d[c++]=
a[346];b.runtime.ondomready(function(){$("#merge-app").suggest({type:"/freebase/apps/acre_app",filter:"(any type:/freebase/apps/acre_app)"}).bind("fb-select",function(o,q){var t=ui.id_to_path(q.id);$(this).val(t);$("#button-merge").removeAttr("disabled").val(t)});$(".button-get-changes").click(function(){ui.do_show_dialog("diff_patch",["merge_changes",{appid:$(this).val()}])})},this);d[c++]=a[347];return d};l=b.runtime.tfunc_factory("app_changes()",l,b,undefined,false);i.app_changes=l;l.source_microdata=
null;m[n++]=a[348];l=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[349];if(this.subst_id)d[c++]=b.runtime.bless(' id="'+this.subst_id+'"');d[c++]=a[350];if(ui.get_app().is_writable()){d[c++]=a[351];d[c++]=f(ui.get_app().get_authors());d[c++]=a[352];b.runtime.ondomready(function(){$("#add-author-input").suggest({type:"/type/user",filter:"(any type:/type/user)"}).bind("fb-select",function(p,h){$(this).val("");ui.do_app_add_author(h.name)}).focus()},this);d[c++]=a[353]}else{d[c++]=a[354];
d[c++]=f(ui.get_app().get_authors());d[c++]=a[355]}d[c++]=a[356];return d};l=b.runtime.tfunc_factory("app_authors()",l,b,undefined,false);i.app_authors=l;l.source_microdata=null;m[n++]=a[357];var f=function(d){var c=b.runtime.new_markuplist(),p=0;c[p++]=a[358];var h=function(){var j=0;for(var o in d)j++;return j==1}();c[p++]=a[359];b.runtime.foreach(this,d,function(j,o){for(var q=1;q;){c[p++]=a[360];c[p++]=b.runtime.make_attr_safe(o.get_view_url(),true);c[p++]=a[361];c[p++]=b.runtime.make_attr_safe(o.get_full_name()||
o.get_name(),false);c[p++]=a[362];c[p++]=b.runtime.make_attr_safe(o.get_image_url(),false);c[p++]=a[363];c[p++]=b.runtime.make_attr_safe(o.get_view_url(),true);c[p++]=a[364];c[p++]=b.runtime.make_attr_safe(o.get_full_name()||o.get_name(),false);c[p++]=a[365];c[p++]=o.get_name();c[p++]=a[366];if(!h&&ui.get_app().is_writable()&&o.is_admin()){c[p++]=a[367];c[p++]=b.runtime.make_attr_safe(o.get_name(),false);c[p++]=a[368]}c[p++]=a[369];q--}return q?b.runtime._break_token:b.runtime._continue_token});c[p++]=
a[370];b.runtime.ondomready(function(){$("#add-author-input").focus();$(".remove-user-button").click(function(){$(this).parents("tr").fadeOut("slow");ui.do_app_remove_author($(this).attr("user"));return false})},this);c[p++]=a[371];return c};f=b.runtime.tfunc_factory("app_authors_list(user_dict)",f,b,undefined,false);i.app_authors_list=f;f.source_microdata=null;m[n++]=a[372];l=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[373];if(this.subst_id)d[c++]=b.runtime.bless(' id="'+this.subst_id+
'"');d[c++]=a[374];var p=ui.get_app().get_write_user(),h=p&&p.get_name()==ui.get_user().get_name()?true:false,j=ui.get_app().is_oauth_enabled(),o={},q={};if(p){o.checked="checked";if(!h)o.disabled="disabled"}if(j)q.checked="checked";d[c++]=a[375];"id"in q||(d[c++]=a[376]);"type"in q||(d[c++]=a[377]);for(var t in q){d[c++]=" "+t;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+q[t]);d[c++]=b.runtime.bless('"')}d[c++]=a[378];"id"in o||(d[c++]=a[379]);"type"in o||(d[c++]=a[380]);for(var u in o){d[c++]=
" "+u;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+o[u]);d[c++]=b.runtime.bless('"')}d[c++]=a[381];d[c++]=p?p.get_name():ui.get_user().get_name();d[c++]=a[382];if(window.location.protocol=="https:"){d[c++]=a[383];(p=this.tasks&&this.tasks.apikeys)||(p=this.mktask("apikeys",ui.get_app().t_get_apikeys()));d[c++]=a[384];d[c++]=a[385];switch(p.state){case "ready":d[c++]=a[386];p=p.result.keys;d[c++]=a[387];d[c++]=r(p);d[c++]=a[388];break;case "wait":d[c++]=a[389];break;case "error":d[c++]=
a[390];break}d[c++]=a[391]}else{d[c++]=a[392];d[c++]=b.runtime.make_attr_safe(window.location.host+window.location.pathname+window.location.hash,false);d[c++]=a[393]}d[c++]=a[394];b.runtime.ondomready(function(){$("#permission-oauth").change(function(){ui.do_app_set_oauth(!!$(this).attr("checked"))});$("#permission-writeuser").change(function(){ui.do_app_set_writeuser(!!$(this).attr("checked"))})},this);d[c++]=a[395];return d};l=b.runtime.tfunc_factory("app_services()",l,b,true,false);i.app_services=
l;l.source_microdata=null;m[n++]=a[396];var r=function(d){var c=b.runtime.new_markuplist(),p=0;c[p++]=a[397];if(d.length){c[p++]=a[398];b.runtime.foreach(this,d,function(h,j){for(var o=1;o;){c[p++]=a[399];c[p++]=j.key_id;c[p++]=a[400];c[p++]=j.token;c[p++]=a[401];c[p++]=j.secret;c[p++]=a[402];if(j.key_id!=="freebase.com"){c[p++]=a[403];c[p++]=b.runtime.make_attr_safe(j.key_id,false);c[p++]=a[404]}c[p++]=a[405];o--}return o?b.runtime._break_token:b.runtime._continue_token});c[p++]=a[406]}else c[p++]=
a[407];c[p++]=a[408];b.runtime.ondomready(function(){ui.watch_inputs("apikey-add",{inputs:{"apikey-name":null,"apikey-token":null,"apikey-secret":null},submit:function(h){ui.do_app_add_apikey(h["apikey-name"],h["apikey-token"],h["apikey-secret"])}});$(".remove-key-button").click(function(){$(this).parents("tr").fadeOut("slow");ui.do_app_remove_apikey($(this).attr("key"));return false})},this);c[p++]=a[409];return c};r=b.runtime.tfunc_factory("app_apikeys_list(keys)",r,b,undefined,false);i.app_apikeys_list=
r;r.source_microdata=null;m[n++]=a[410];return m};e.source_microdata=null;return e}(),info:{file:"//20a.appeditor.www.tags.svn.freebase-site.googlecode.dev/menus.mjt",stringtable:["\n\n<!-- Your Apps Menu --\>","","",'\n  <div class="section selectable" onclick="return mjt._eventcb.','.apply(this, [event])">\n    New App...\n  </div>',"",'\n  <div class="section selectable" onclick="return mjt._eventcb.','.apply(this, [event])">      \n    App Directory...     \n  </div>','\n  <div class="section selectable" id="your-apps-menu-item">      \n    <div id="your-apps-opener"><img id="your-apps-loader" src="/static/20a.appeditor.www.tags.svn.freebase-site.googlecode.dev/loader-tinyorange.gif" style="display:none;"></div>\n    Your Apps \n  </div>',
'\n  <div class="section">\n    <h3>Your Apps</h3>\n    <a href="','" title="Sign in to your Freebase account">Sign in</a> to show your apps here.\n  </div>','\n\n  <div class="section last"> \n    <h3>Recent Apps</h3>',"\n    <ul>","\n      <li>",'\n        <a apppath="','" class="app-link" href="','" title="','">',"</a>","\n        <em>on ","</em>","\n      </li>","\n    </ul>","\n    <div>If you work on multiple apps, recently opened ones will appear here.</div>","\n  </div>","","","","",'\n    <p class="menu-message">Apps you create or clone will appear here.</p>',
"\n    <ul>",'\n      <li>\n        <a apppath="','" class="app-link" href="','" title="','">\n          ',"\n        </a>\n      </li>","\n    </ul>","","","\n\n\n<!-- File Menu --\>","","",'\n  <div class="section">\n    <h3>Name</h3>\n    <fieldset class="center">\n      <label for="file-name">File name </label>\n      <input class="form-textbox" id="file-name" type="text" value="','">','\n      <button class="exit" disabled="disabled" id="button-name">Rename</button>',"\n    </fieldset>\n  </div>",
"",'\n  <div class="section">\n    <h3>Type</h3>\n    <fieldset id="fieldset-metadata">',"<div",">",'\n        <div class="form-row">\n          <label for="file-handler">Acre type </label>\n          <select',' id="file-handler"','>\n            <option selected="" value="">(derived from extension)</option>',"\n            <option",' value="','"',">\n                ","\n            </option>",'\n          </select>\n        </div>\n        <div class="form-row">\n          <label for="file-mimetype">MIME type </label>\n          <select',
' id="file-mimetype"',">","\n            <option",' value="','"',">\n              ","\n            </option>","\n          </select>\n        </div>","\n      </div>",'\n      <div id="metadata-section">',"</div>\n    </fieldset>\n  </div>",'\n  <div class="section">\n    <h3>Type</h3>\n    <fieldset id="fieldset-metadata">\n      <div class="form-row">\n        <label for="file-handler">Acre type:</label>\n        <span class="form-static">','</span>\n      </div>            \n      <div class="form-row">            \n        <label for="file-mimetype">MIME type: </label>\n        <span class="form-static">',
"</span>\n      </div>              \n    </fieldset>\n  </div>",'\n  <div class="section">\n    <h3>Validate</h3>\n    <!-- mjt.bless is being used so HTML entities for system control characters \n        can be printed. These are all declared in ui.shortcut --\>',"\n    <button",' title="','"',' onclick="return mjt._eventcb.','.apply(this, [event])"','>\n      Check Syntax</button>\n  </div>\n  <div class="section">\n    <h3>History</h3>\n    <fieldset>',"\n      <button",' class="exit"',' onclick="return mjt._eventcb.',
'.apply(this, [event])"',">\n        Revert to Saved</button>"," ",'\n      <button onclick="return mjt._eventcb.','.apply(this, [event])">\n        Review Older Versions</button>\n    </fieldset>\n  </div>\n  <div class="section last">\n    <h3>Actions</h3>',"\n    <button",' onclick="return mjt._eventcb.','.apply(this, [event])"',">\n      Clone this File</button>","\n    <button",' onclick="return mjt._eventcb.','.apply(this, [event])"',">\n      Delete this File</button>\n  </div>","","\n\n\n<!-- Editor Menu --\>",
"","",'\n  <div class="section">',"\n    <h3>Text Editor</h3>\n    <fieldset>",'\n      <div class="line">\n        <input',' id="edopt-texteditor-','"',' name="edopt-texteditor"',' type="radio"',' value="','"','>\n        <label for="edopt-texteditor-','">',"</label><br>\n      </div>","\n    </fieldset>\n  </div>","",'\n  <div class="section">'," \n    <h3>Line Numbers</h3>\n    <fieldset>\n      <input",' id="edopt-margin-y"',' name="edopt-margin"',' type="radio"',' value="1"','> <label for="edopt-margin-y">yes</label>\n      <input',
' id="edopt-margin-n"',' name="edopt-margin"',' type="radio"',' value="0"','> <label for="edopt-margin-y">no</label>\n    </fieldset>\n  </div>',"",'\n  <div class="section">',"\n    <h3>Soft Wrap</h3>\n    <fieldset>\n      <input",' id="edopt-softwrap-y"',' name="edopt-softwrap"',' type="radio"',' value="1"','> <label for="edopt-softwrap-y">yes</label>\n      <input',' id="edopt-softwrap-n"',' name="edopt-softwrap"',' type="radio"',' value="0"','> <label for="edopt-softwrap-n">no</label>\n    </fieldset>\n  </div>',
"",'\n  <div class="section last">',"\n    <h3>Automatic Code Assist</h3>\n    <fieldset>\n      <input",' id="edopt-dotTrigger-y"',' name="edopt-dotTrigger"',' type="radio"',' value="1"','> <label for="edopt-dotTrigger-y">yes</label>\n      <input',' id="edopt-dotTrigger-n"',' name="edopt-dotTrigger"',' type="radio"',' value="0"','> <label for="edopt-dotTrigger-n">no</label>\n    </fieldset>\n  </div>',"",'\n  <div class="section last">',"\n    <h3>Enable MQL Extensions (experimental)</h3>\n    <fieldset>\n      <input",
' id="edopt-emql-y"',' name="edopt-emql"',' type="radio"',' value="1"','> <label for="edopt-emql-y">yes</label>\n      <input',' id="edopt-emql-n"',' name="edopt-emql"',' type="radio"',' value="0"','> <label for="edopt-emql-n">no</label>\n    </fieldset>\n  </div>',"",'\n  <div>\n    <p style="margin:10px">\n      No configuration options for this file type. \n    </p>\n  </div>',"","","\n\n\n<!-- Help Menu --\>",'\n  <div id="help-menu-content">\n  <div class="section">\n    <h3>Documentation</h3>\n    <ul>\n      <li>',
'<a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Keyboard Shortcuts</a></li>\n      <li>','<a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Acre API Reference</a></li>\n      <li>','<a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Acre Template Tag Reference</a></li>\n      <li>','<a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Javascript Reference</a></li>\n      <li>','<a href="#0" onclick="return mjt._eventcb.',
'.apply(this, [event])">\n        MQL Reference Guide</a></li>\n      <li><a href="','/docs/" target="_new">\n        Freebase Documentation Hub</a></li>\n    </ul>\n  </div>\n  <div class="section">\n    <h3>Code Search</h3>\n    <p>\n      Not sure how to use a particular method or template tag?  See how someone else did!\n    </p>\n    <form action="http://codesearch.','/" id="codesearch-form" target="_blank">\n      <fieldset>\n          <input id="code-search" name="q" type="text">\n          <button id="button-codesearch">Find Code</button>\n      </fieldset>\n    </form>\n  </div>\n  <div class="section last">',
'\n    <a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">About App Editor</a>\n  </div>\n  </div>',"","\n\n\n<!-- App  menu --\>","","",'\n  <div class="dialog-close" onclick="return mjt._eventcb.','.apply(this, [event])"></div>\n  <div class="clear" id="app-settings-section">\n    <div id="settings-tabs">\n      <ul id="settings-tabs-bar">\n        <li class="tab"><a class="settings-tab-link" href="#app_general">Versions</a></li>\n        <li class="tab"><a class="settings-tab-link" href="#app_changes">Changes</a></li>\n        <li class="tab"><a class="settings-tab-link" href="#app_authors">Authors</a></li>',
'\n        <li class="tab"><a class="settings-tab-link" href="#app_services">Web Services</a></li>','\n      </ul>\n      <div class="tabbed-content" id="settings-tab-content">\n        <div id="app_general"></div>\n        <div id="app_changes"></div>\n        <div id="app_authors"></div>\n        <div id="app_services"></div>\n      </div>\n    </div>\n  </div>\n  <div class="button-bar">','\n    <fieldset id="app-clonedelete">','\n      <button class="button-main" id="app-general-listing">\n        Edit Name &amp; Directory Listing</button>',
"",'\n      <button id="app-general-clone" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Clone this App</button>',"",'\n      <button id="app-general-delete" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Delete this App</button>',"\n    </fieldset>",'\n    <fieldset id="app-clonedelete">','\n      <button id="app-general-clone" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Clone this App</button>',"\n    </fieldset>","",'\n    <button onclick="return mjt._eventcb.',
'.apply(this, [event])">Done</button>\n  </div>',"","",'<div class="tab-body"',">",'\n        \n    <div class="tab-section">\n      <h3>Versions</h3>\n      <div class="sidebar">\n        <p>\n          App authors can create and release new versions of their app any time.\n        </p>\n        <p>\n          <em>Current</em> is always the latest version; all edits are made to Current.  Other versions are read only.\n        </p>\n        <p>\n          <em>Release</em> is the version the app author wants people to use.  Any version can be released, but it\'s good practice to create and release a version other than Current to prevent development from impacting users. \n        </p>\n      </div>',
'\n      <fieldset id="add-version">\n        <label for="add-version-key">Create a new version: </label>\n        <input id="add-version-key" maxlength="10" type="text">','\n        <button id="button-version" onclick="return mjt._eventcb.','.apply(this, [event])">\n          Add Version</button>','\n        <button onclick="return mjt._eventcb.','.apply(this, [event])">\n          View Changes</button>',"\n      </fieldset>",'\n      <div id="app-versions-add">','</div>\n    </div>\n\n    <div class="tab-section">',
"",'\n      <div class="app-url">\n        <p>\n          Your <strong>Dev URL</strong> points to <em>Current:</em>\n        </p>\n        <fieldset>\n            http://<input class="shortfield" id="devurl" maxlength="20" minlength="5" type="text" value="','">',".",'\n          <button disabled="disabled" id="button-devurl">Change URL</button>\n        </fieldset>\n      </div>','\n      <div class="app-url">\n        <p>URL to <em>Current</em> version:</p>\n        <p><a href="','" target="current">',
"</a></p>\n      </div>","",'\n    </div>\n    <div class="tab-section last">\n      <div class="app-url">\n        ',"\n      </div>\n    </div>\n  </div>","","","",'\n      <div>\n        <p>Your <strong>Release URL</strong> points to <em>Release:</em></p>\n        <fieldset>\n          http://<input id="puburl" maxlength="20" minlength="5" type="text" value="','">.',' \n          <button disabled="disabled" id="button-puburl">',"\n            <span>Change URL</span>","\n            <span>Choose URL</span>",
'\n          </button>\n          <span id="puburl-status"></span>\n        </fieldset>','\n        <div>\n          <h4 class="list-title">Other URLs:</h4>\n          <table class="edit-list">','\n            <tr>\n              <td><a href="http://','" target="_blank">',"</a></td>\n              <td>",'<span class="version-bad">',"</span>","</td>\n            </tr>","\n          </table>\n        </div>","","\n      </div>","\n      <div>","\n        <div>\n          <p>URL to <em>Release</em> version:</p>",
'\n          <p><a href="http://','" target="release">http://',".","</a>\n          </p>","\n        </div>","\n      </div>","","","",'\n\n      <div id="app-versions-list">\n        <table class="edit-list">\n          <thead>\n            <tr>','\n              <th class="center">release</th>','\n              <th class="left">version</th>\n              <th class="left">snapshot time</th>','\n              <th class="center">run on<br>sandbox</th>',"\n              <th></th>","\n              <th></th>",
'\n            </tr>\n          </thead>\n          <tbody>\n            <tr class="version-listitem">','\n              <td class="center">',"\n                <input",' name="version-release"',' type="radio"',' value="current"',">","\n                <span>","<em>\u2713</em>","</span>","\n              </td>",'\n              <td>\n                <a apppath="','" class="app-link" href="','">Current</a>\n              </td>\n              <td></td>',"\n              <td></td>",'\n              <td><a href="',
'" target="_blank">view</a></td>',"\n              <td></td>","\n            </tr>",'\n            <tr class="version-listitem">',"",'\n              <td class="center">',"\n                <input",' name="version-release"',' type="radio"',' value="','"',">","\n                <span>","<em>\u2713</em>","</span>","\n              </td>",'\n              <td>\n                <a apppath="','" class="app-link" href="','">',"</a>\n              </td>     \n              <td>","\n                <span>\n                  ",
"","\n                  <span>\n                    [",'<a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">set to now</a>]\n                  </span>',"\n                </span>","\n              </td>",'\n              <td class="center">\n                <input',' class="version-service-url"',' key="','"',' type="checkbox"',">\n              </td>",'\n              <td><a href="','" target="_blank">view</a></td>','\n              <td class="remove">','\n                <a class="remove-version-button" href="#0" key="',
'">x</a>',"\n              </td>","\n            </tr>","\n          </tbody>\n        </table>\n      </div>","","",'<div class="tab-body"',">",'\n    <div class="tab-section">\n      <div class="sidebar">\n        <p>\n          View the changes between versions or even individual edits.\n        </p>\n        <p>\n          If you\'re an author, you can also <em>revert</em> the changes.\n        </p>\n      </div>\n      <h3>App History</h3>','\n      <button id="button-app-history" onclick="return mjt._eventcb.',
'.apply(this, [event])">\n        Diff Versions &amp; Edits</button>\n    </div>\n    <div class="tab-section">\n      <div class="sidebar">\n        <p>\n          View the changes between this app and it\'s parents or children.\n        </p>\n        <p>\n          If you\'re an author, you can also <em>merge</em> the changes.\n        </p>\n        \n      </div>\n      <h3>View Changes from Clones</h3>\n      <div id="clone-list">',"\n        <p>\n          <i>\n            This app does not have either parent or children apps.  <br>\n            Choose any app to view changes from below.\n          </i>\n        </p>",
"",'\n        <table class="edit-list">\n          <thead>\n            <tr colspan="2"><th class="left">Parent:</th></tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td class="left">\n                <a apppath="','" class="app-link" href="#0">','</a>\n              </td>\n              <td class="right">\n                <button class="button-get-changes" value="','">View Changes</button>\n              </td>\n            </tr>\n          </tbody>\n        </table>',
"",'\n        <table class="edit-list">\n          <thead>\n            <tr colspan="2"><th class="left">Children:</th></tr>\n          </thead>\n          <tbody>','\n            <tr>\n              <td class="left">\n                <a apppath="','" class="app-link" href="#0">','</a>\n              </td>\n              <td class="right">\n                <button class="button-get-changes" value="','">View Changes</button>\n              </td>\n            </tr>',"\n          </tbody>\n        </table>",
'\n      </div>\n    </div>\n    <div class="tab-section last">\n      <div class="sidebar">\n        <p>\n          Select any app you\'d like to view changes from.\n        </p>\n      </div>\n      <h3>View Changes from any App</h3>\n      <fieldset id="add-patch">\n        <label for="merge-app">Choose app: </label>\n        <input id="merge-app" maxlength="60" type="text">\n        <button class="button-get-changes" disabled="disabled" id="button-merge">\n          View Changes</button>\n      </fieldset>\n    </div>',
"\n  </div>","",'<div class="tab-body"','>\n    <div class="tab-section last">','\n      <div>\n        <div class="sidebar">\n          <p>\n            You can add other Freebase users as <em>Authors</em>\n            to your app.  Choose authors carefully! They can edit code, release versions, \n            and delete files.\n          </p>\n        </div>\n        <h3>Add an Author</h3>\n        <fieldset class="form-indent">\n          <label for="add-author-input">Find a user to add</label>\n          <input id="add-author-input" type="text">\n        </fieldset>\n    \n        <div id="app-authors-list">\n          ',
"\n        </div>","\n      </div>",'\n      <div>\n        <h3>Authors</h3>\n        <div id="app-authors-list">\n          ',"\n        </div>\n      </div>","\n    </div>\n  </div>","","",'\n    \n      <h4 class="list-title">These authors can edit this app:</h4>\n  \n      <table class="edit-list">','\n        <tr class="user-listitem">\n          <td class="user-image-cell">\n            <div class="user-image">\n              <a href="','" target="user" title="View profile for ','">\n                <img alt="mugshot" src="',
'">\n              </a>\n            </div>\n          </td>\n          <td>\n            <a class="user-name" href="','" target="user" title="View profile for ','">','</a>\n          </td>\n          <td class="remove">','\n            <a class="remove-user-button" href="#0" user="','">x</a>',"\n          </td>\n        </tr>","\n      </table>","","",'<div class="tab-body"',">",'\n    <div class="tab-section">\n      <fieldset id="permissions-settings">\n        <h3>Writing to Freebase</h3>\n        <div class="radiogroup">\n          <h5>\n            <input',
' id="permission-oauth"',' type="checkbox"','>\n            Allow your users to write as themselves\n          </h5>\n          <p>\n            <small>Writes will be attributed to the user making them. Users will be asked to allow your app \n            to use their Freebase account. <strong>This is usually is the best choice</strong>.</small>\n          </p>\n        </div>\n        <div class="radiogroup">\n          <h5>\n            <input',' id="permission-writeuser"',' type="checkbox"',">\n            Allow <strong>",
'</strong> to write on behalf of any user\n          </h5>\n          <p>\n            <small>\n              Writes will all be attributed to this user. Be careful, however, as you may quickly exceed \n              Freebase\'s daily single-user write limit if you have a lot of users!<br>\n              <strong>\n                NOTE: If you\'ve also enabled your users to write, you will need to set the <em>http_sign</em>\n                option to <em>false</em> for any Freebase call you want written by this user\n              </strong>\n            </small>\n          </p>\n        </div>\n      </fieldset>\n    </div>\n    <div class="tab-section last">\n      <div class="sidebar">\n        <p>\n          <em>API keys</em> authorize information exchange with other web applications or services. Register your app with the <strong>service domain</strong> you want to use.  Each service handles this differently, so follow their instructions.  Once registered, enter the <strong>API key</strong> and <strong>secret</strong> (if required) provided by the service here.\n        </p>\n      </div>\n      <h3>Add an API Key</h3>',
"\n      <div>","","\n        <div>","<div>",'\n            <div id="app-apikeys-add">',"</div>\n          </div>",'<p><span class="loader-square hidden" id="version-loader"></span></p>',"<p>Error loading API keys.</p>","</div>\n      </div>",'\n      <div>\n        <p>\n          For your security, please <a href="https://','">switch to App Editor over SSL</a> to add or edit your API keys.\n        </p>\n      </div>',"\n    </div>","\n  </div>","",'\n      <fieldset>\n        <div class="form-row">\n          <label for="apikey-name">Service domain:</label>\n          <input id="apikey-name" type="text">\n        </div>\n        <div class="form-row">          \n          <label for="apikey-token">Key:</label>\n          <input id="apikey-token" type="text">\n        </div>\n        <div class="form-row">\n          <label for="apikey-secret">Secret:</label>\n          <input id="apikey-secret" type="text"><br>\n        </div>\n        <div class="form-row">\n          <button disabled="disabled" id="button-apikey-add">Add API Key</button>\n        </div>\n      </fieldset>',
'\n      <div id="api-key-list">\n      <h3>API Keys</h3>\n        <table class="edit-list">\n          <thead>\n            <tr class="key-listitem">\n              <th>Service Domain</th>\n              <th>Key</th>\n              <th>Secret</th>\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>','\n            <tr class="key-listitem">\n              <td>',"</td>\n              <td>","</td>\n              <td>",'</td>\n              <td class="remove">','\n                <a class="remove-key-button" href="#0" key="',
'">x</a>',"\n              </td>\n            </tr>","\n          </tbody>\n        </table>\n      </div>",'\n      <h4 class="list-title">You haven\'t added any API keys.</h4>',"","",""],debug_locs:[1,1,1,1,1,1,7,7,7,7,7,7,8,8,9,10,11,12,13,13,13,13,13,13,13,13,15,15,15,15,16,16,16,16,16,16,16,19,19,19,19,22,22,22,22,22,22,23,25,25,25,25,25,26,26,26,30,30,30,30,30,31,31,31,32,32,32,33,34,35,36,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,39,39,39,40,40,40,41,41,41,41,43,43,43,43,44,45,46,47,
48,49,50,50,50,50,50,50,51,51,51,51,52,52,53,54,55,56,57,57,57,57,57,58,59,59,59,59,59,60,60,60,60,60,60,60,60,61,61,61,63,63,63,63,63,63,63,64,64,64,65,65,65,66,67,68,69,70,71,72,73,73,73,73,73,73,76,76,76,76,76,76,76,77,77,78,79,80,81,82,83,83,87,87,87,87,87,87,87,88,88,88,88,88,90,90,90,90,91,91,94,94,94,94,94,94,94,94,94,95,95,96,97,98,99,100,101,102,103,104,105,108,108,108,108,108,108,108,108,108,108,108,108,108,108,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,
112,112,112,113,113,113,113,113,113,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,122,122,122,123,123,123,123,123,123,126,126,126,126,126,127,128,129,130,131,132,133,134,135,136,137,138,138,138,138,138,138,138,138,138,140,140,140,140,141,146,146,146,146,146,146,146,146,150,150,150,150,150,150,153,153,153,153,153,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,
159,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,167,167,167,168,168,168,168,168,168,168,175,175,175,175,175,175,175,175,175,175,175,175,175,175,175,175,175,175,175,175,175,175,175,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,181,181,181,181,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,195,195,195,195,195,198,198,198,198,198,198,198,199,199,200,201,202,203,204,205,206,207,208,208,209,209,209,212,
212,212,212,212,212,212,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,214,214,214,214,214,215,215,215,215,215,215,215,217,217,217,217,218,218,219,219,219,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,223,223,223,223,223,223,223,223,223,223,223,223,223,223,223,223,223,223,225,225,225,225,226,226,227,227,227,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,231,231,231,231,231,231,231,231,231,
231,231,231,231,231,231,231,231,231,233,233,233,233,234,234,235,235,235,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,239,239,239,239,239,239,239,239,239,239,239,239,239,239,239,239,239,239,241,241,241,241,242,242,243,243,243,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,247,247,247,247,247,247,247,247,247,247,247,247,247,247,247,247,247,247,249,249,249,249,250,250,254,254,254,254,254,254,254,255,255,255,256,257,258,259,260,261,262,
263,264,265,266,266,266,266,266,266,269,269,269,269,269,269,269,274,274,274,274,274,274,274,274,274,274,274,276,276,276,276,276,276,276,276,278,278,278,278,278,278,278,278,280,280,280,280,280,280,280,280,282,282,282,282,282,282,282,282,284,284,284,284,293,293,293,293,293,293,293,293,293,293,293,301,301,301,301,301,301,301,301,301,301,301,301,301,301,304,304,304,304,304,305,306,307,308,309,310,310,310,310,310,310,313,313,313,313,313,313,313,314,314,315,316,317,317,317,317,317,317,317,324,324,324,324,
324,324,324,324,324,324,324,335,335,335,335,335,335,335,335,335,335,335,335,336,336,336,337,337,337,337,338,338,338,338,338,338,338,338,339,339,339,340,340,340,340,340,340,340,340,341,341,341,342,342,342,343,344,344,344,344,344,344,344,344,344,345,345,345,346,346,346,347,347,347,347,347,347,347,349,349,349,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,367,367,367,367,367,368,368,368,368,368,368,369,369,370,371,386,386,386,386,386,386,386,386,386,386,386,386,386,386,386,
386,389,389,389,389,389,389,389,389,389,389,392,392,392,392,392,392,392,392,392,393,393,393,394,394,394,395,395,395,399,399,399,399,399,400,401,402,403,404,404,409,409,409,409,409,409,409,409,409,409,409,409,412,412,412,412,412,413,415,415,415,415,415,415,415,416,416,416,417,417,417,417,418,419,420,421,422,423,424,425,426,427,428,428,431,431,431,431,431,431,434,434,434,434,434,434,434,434,434,436,436,436,436,437,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,456,459,
459,459,459,459,459,459,459,461,461,461,461,461,461,462,462,462,462,466,466,466,466,466,469,469,469,469,469,469,469,469,470,470,470,470,470,470,471,471,471,471,471,471,471,472,472,472,472,472,472,472,474,474,474,474,475,475,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,502,502,502,503,503,503,505,505,505,505,505,505,505,505,505,505,505,506,506,506,507,507,507,508,508,508,509,509,509,509,509,509,511,511,511,511,512,512,513,514,515,516,
517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,537,537,537,537,537,537,537,537,537,537,540,540,540,540,540,540,540,542,542,542,542,542,542,547,547,547,547,547,547,548,548,548,548,548,548,548,548,548,548,548,548,548,548,548,548,548,548,548,548,548,549,549,549,549,549,549,549,549,550,550,550,552,552,552,552,552,552,555,555,555,555,555,555,555,556,556,556,557,557,557,557,557,559,559,559,559,559,560,560,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,574,576,576,576,576,576,576,
576,576,576,576,576,576,576,576,576,576,576,576,576,576,576,576,576,577,577,577,577,577,577,577,577,578,578,578,580,580,580,580,580,580,580,580,583,583,583,583,584,584,584,584,585,585,586,586,586,586,586,586,586,586,587,587,587,588,588,588,590,590,590,592,592,592,592,592,592,592,592,592,592,592,592,592,592,592,592,592,592,592,593,593,593,594,594,594,595,595,596,596,596,596,596,596,596,596,597,597,597,598,598,598,598,598,598,602,602,602,602,602,602,602,603,604,605,606,607,608,609,610,611,612,613,614,
615,616,617,618,619,620,621,622,622,623,623,623,623,623,623,625,625,625,625,625,625,626,626,627,628,629,630,641,641,641,641,641,641,641,641,641,641,641,641,641,641,641,641,641,656,656,656,656,656,656,656,656,656,656,656,656,656,656,656,656,661,661,661,661,661,661,661,661,662,662,669,669,669,669,669,669,669,669,669,669,669,669,672,672,672,672,672,676,676,676,676,676,676,677,677,682,682,682,682,682,682,682,682,682,684,684,684,684,684,684,684,687,687,687,687,687,689,689,689,689,689,689,689,691,691,691,
691,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,725,725,725,725,725,725,726,726,726,726,726,726,728,728,728,743,743,743,743,743,743,743,743,743,743,743,743,743,743,743,743,743,743,745,745,745,745,746,747,748,749,750,751,752,753,754,755,756,757,757,757,757,760,760,760,760,760,760,762,762,762,762,764,764,764,764,764,764,764,764,766,766,766,766,767,767,768,769,774,774,774,774,774,774,774,774,777,777,777,
777,777,777,777,777,778,778,778,783,783,783,783,783,783,783,783,783,783,783,786,786,786,786,786,786,786,786,786,788,788,788,788,788,788,788,790,790,790,790,791,792,793,794,795,796,797,798,799,799,799,799,799,799,800,800,800,800,800,800,801,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,823,823,823,823,823,823,823,823,823,823,823,823,823,823,823,823,823,823,823,833,833,833,833,833,833,833,833,833,833,833,833,833,833,833,833,833,833,833,833,833,833,833,834,834,834,856,856,856,856,
856,856,856,856,856,856,856,856,856,856,856,856,856,856,856,856,856,856,856,857,857,857,857,857,857,857,860,860,860,860,860,862,862,863,864,865,865,865,866,866,866,866,867,867,867,868,868,868,869,869,869,871,873,873,873,873,873,875,875,875,875,877,877,877,877,878,879,880,881,882,883,884,885,886,886,886,886,886,886,886,887,887,887,887,905,905,905,905,905,905,905,905,905,905,905,905,905,905,905,905,905,905,905,917,917,917,917,917,917,917,917,917,917,917,917,917,917,917,917,918,918,918,918,919,919,919,
920,920,920,922,922,922,922,922,922,922,922,924,924,924,924,924,924,924,927,927,927,927,927,928,928,928,928,929,929,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,948,948,948,948,948,949,949,949,949],output_mode:"html"}}})})(window.freebase.acre,window.freebase.h);
